import{_ as k}from"./BarChart-CKiFk9xA.js";import{_ as p}from"./LineChart-BDXlcfBY.js";import{x as B,h as o,o as s,w as v,q as d,j as g,F as f,v as C,n as w,an as $,r as j,A as y,a9 as L,a8 as M}from"./main-Dpl-JOF2.js";import{D as b}from"./datetime-PXpIdgFA.js";import{_ as P}from"./Card-BCzTSeNK.js";import"./tailwind.theme-XeumNAwU.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="b75144fe-ff28-4333-9b5d-d58310532a98",e._sentryDebugIdIdentifier="sentry-dbid-b75144fe-ff28-4333-9b5d-d58310532a98")}catch(r){}})();{var h=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};h._sentryModuleMetadata=h._sentryModuleMetadata||{},h._sentryModuleMetadata[new Error().stack]=Object.assign({},h._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const J={name:"SiteAnalyticsUptime",props:["data","loading"],computed:{uptimeTypes(){return[{key:"value",label:"Web"}]},subtitle(){if(!this.data)return"";let e=0,a=0;for(;a<this.data.length&&typeof this.data[a].value=="number";a++)e+=this.data[a].value;const r=(e/a*100).toFixed(2);return isNaN(r)?"":`Average: ${r}%`}},methods:{formatDate(e){return b.fromSQL(e).toLocaleString(b.DATETIME_FULL)}}},A={key:0,class:"flex h-full items-center justify-center"},U={class:"flex h-10 justify-between"},S=["title"];function R(e,a,r,c,u,t){const m=P;return s(),o(m,{title:"Uptime",subtitle:t.subtitle,loading:r.loading},{default:v(()=>[!r.data||r.data[0].date===void 0?(s(),d("div",A,a[0]||(a[0]=[g("div",{class:"text-base text-gray-600"},"No data",-1)]))):(s(!0),d(f,{key:1},C(t.uptimeTypes,i=>(s(),d("div",{class:"mt-8",key:i.key},[g("div",U,[(s(!0),d(f,null,C(r.data,n=>(s(),d("div",{key:n.date,class:w(["w-1.5 rounded",[n[i.key]===void 0?"bg-white":n[i.key]===1?"bg-green-500":n[i.key]===0?"bg-red-500":"bg-yellow-500"]]),title:n[i.key]?`${t.formatDate(n.date)} | Uptime: ${(n.value*100).toFixed(2)}%`:""},null,10,S))),128))])]))),128))]),_:1},8,["subtitle","loading"])}const N=B(J,[["render",R]]),E={name:"SiteAnalytics",props:["siteName"],components:{BarChart:k,LineChart:p,SiteAnalyticsUptime:N,AlertBanner:$},data(){return{duration:"24h",durationOptions:[{label:"1 hour",value:"1h"},{label:"6 hours",value:"6h"},{label:"24 hours",value:"24h"},{label:"7 days",value:"7d"},{label:"15 days",value:"15d"}]}},resources:{analytics(){let e=b.local().zoneName;return{url:"press.api.analytics.get",params:{name:this.siteName,timezone:e,duration:this.duration},auto:!0}}},computed:{requestChartColors(){return[this.$theme.colors.green[500],this.$theme.colors.red[500],this.$theme.colors.yellow[500],this.$theme.colors.pink[500],this.$theme.colors.purple[500],this.$theme.colors.blue[500],this.$theme.colors.teal[500],this.$theme.colors.cyan[500],this.$theme.colors.gray[500],this.$theme.colors.orange[500]]},usageCounterData(){var r,c;let e=(r=this.$resources.analytics.data)==null?void 0:r.usage_counter;if(!e)return;let a=(c=this.$resources.analytics.data)==null?void 0:c.plan_limit;return{datasets:[e.map(u=>[+new Date(u.date),u.value/1e6])],markLine:{data:[{name:"Daily Compute Limit",yAxis:a,label:{formatter:"{b}: {c} seconds",position:"middle"},lineStyle:{color:"#f5222d"}}],symbol:["none","none"]}}},requestCountData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.request_count;if(e)return{datasets:[e.map(r=>[+new Date(r.date),r.value])]}},requestCountByPathData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.request_count_by_path;if(e)return e},requestDurationByPathData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.request_duration_by_path;if(e)return e},averageRequestDurationByPathData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.average_request_duration_by_path;if(e)return e},backgroundJobCountByMethodData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.background_job_count_by_method;if(e)return e},backgroundJobDurationByMethodData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.background_job_duration_by_method;if(e)return e},averageBackgroundJobDurationByMethodData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.average_background_job_duration_by_method;if(e)return e},slowLogsByCountData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.slow_logs_by_count;if(e)return e},slowLogsByDurationData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.slow_logs_by_duration;if(e)return e},requestTimeData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.request_cpu_time;if(e)return{datasets:[e.map(r=>[+new Date(r.date),r.value/1e6])]}},jobCountData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.job_count;if(e)return{datasets:[e.map(r=>[+new Date(r.date),r.value])]}},jobTimeData(){var a;let e=(a=this.$resources.analytics.data)==null?void 0:a.job_cpu_time;if(e)return{datasets:[e.map(r=>[+new Date(r.date),r.value/1e6])]}}}},F={class:"space-y-4 p-5"},I={class:"grid grid-cols-1 gap-5 sm:grid-cols-2"};function V(e,a,r,c,u,t){var D,_;const m=L,i=M,n=p,q=j("SiteAnalyticsUptime"),l=k;return s(),d("div",F,[y(m,{message:e.$resources.analytics.error},null,8,["message"]),y(i,{class:"w-32",label:"Duration",type:"select",options:u.durationOptions,modelValue:u.duration,"onUpdate:modelValue":a[0]||(a[0]=T=>u.duration=T)},null,8,["options","modelValue"]),g("div",I,[(s(),o(n,{type:"time",title:"Usage Counter",key:t.usageCounterData,data:t.usageCounterData,unit:"seconds",chartTheme:[e.$theme.colors.purple[500]],loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),y(q,{data:(_=(D=e.$resources.analytics)==null?void 0:D.data)==null?void 0:_.uptime,loading:e.$resources.analytics.loading},null,8,["data","loading"]),(s(),o(n,{type:"time",title:"Requests",key:t.requestCountData,data:t.requestCountData,unit:"requests",chartTheme:[e.$theme.colors.green[500]],loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(n,{type:"time",title:"Requests CPU Usage",key:t.requestTimeData,data:t.requestTimeData,unit:"seconds",chartTheme:[e.$theme.colors.yellow[500]],loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(n,{type:"time",title:"Background Jobs",key:t.jobCountData,data:t.jobCountData,unit:"jobs",chartTheme:[e.$theme.colors.red[500]],loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(n,{type:"time",title:"Background Jobs CPU Usage",key:t.jobTimeData,data:t.jobTimeData,unit:"seconds",chartTheme:[e.$theme.colors.blue[500]],loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(l,{class:"sm:col-span-2",title:"Request Count by Path",key:t.requestCountByPathData,data:t.requestCountByPathData,unit:"requests",chartTheme:t.requestChartColors,loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(l,{class:"sm:col-span-2",title:"Request Duration by Path",key:t.requestDurationByPathData,data:t.requestDurationByPathData,unit:"seconds",chartTheme:t.requestChartColors,loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(l,{class:"sm:col-span-2",title:"Average Request Duration by Path",key:t.averageRequestDurationByPathData,data:t.averageRequestDurationByPathData,unit:"seconds",chartTheme:t.requestChartColors,loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(l,{class:"sm:col-span-2",title:"Background Job Count by Method",key:t.backgroundJobCountByMethodData,data:t.backgroundJobCountByMethodData,unit:"jobs",chartTheme:t.requestChartColors,loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(l,{class:"sm:col-span-2",title:"Background Job Duration by Method",key:t.backgroundJobDurationByMethodData,data:t.backgroundJobDurationByMethodData,unit:"seconds",chartTheme:t.requestChartColors,loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(l,{class:"sm:col-span-2",title:"Average Background Job Duration by Method",key:t.averageBackgroundJobDurationByMethodData,data:t.averageBackgroundJobDurationByMethodData,unit:"seconds",chartTheme:t.requestChartColors,loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(l,{class:"sm:col-span-2",title:"Slow Logs by Count",key:t.slowLogsByCountData,data:t.slowLogsByCountData,unit:"queries",chartTheme:t.requestChartColors,loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"])),(s(),o(l,{class:"sm:col-span-2",title:"Slow Logs by Duration",key:t.slowLogsByDurationData,data:t.slowLogsByDurationData,unit:"seconds",chartTheme:t.requestChartColors,loading:e.$resources.analytics.loading},null,8,["data","chartTheme","loading"]))])])}const X=B(E,[["render",V]]);export{X as default};
//# sourceMappingURL=SiteCharts-DVJqYVEC.js.map
