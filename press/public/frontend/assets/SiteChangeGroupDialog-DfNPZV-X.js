import{x as w,q as i,o as t,A as r,w as g,h as f,u as b,bp as v,a8 as V,a9 as _,aA as k,F as C,V as y}from"./main-Dpl-JOF2.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},o=new Error().stack;o&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[o]="a603c0cd-1d97-4bc0-8e3d-fdf04815789c",e._sentryDebugIdIdentifier="sentry-dbid-a603c0cd-1d97-4bc0-8e3d-fdf04815789c")}catch(u){}})();{var a=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};a._sentryModuleMetadata=a._sentryModuleMetadata||{},a._sentryModuleMetadata[new Error().stack]=Object.assign({},a._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const B={props:["site"],data(){return{show:!0,targetGroup:{label:"",value:""},newGroupTitle:"",skipFailingPatches:!1,showCloneBenchDialog:!1,selectedServer:null}},computed:{errorMessage(){return this.$resources.changeGroupOptions.error||this.$resources.changeGroup.error||this.$resources.cloneGroup.error}},resources:{changeGroup(){return{url:"press.api.site.change_group",onSuccess(){const e=this.$resources.changeGroupOptions.data.find(o=>o.name===this.targetGroup.value).title;y.success(`The site has been scheduled to move to the ${e} bench group successfully.`),this.$router.push({name:"Site Jobs",params:{name:this.site}}),this.targetGroup={label:"",value:""},this.show=!1}}},changeGroupOptions(){return{url:"press.api.site.change_group_options",params:{name:this.site},initialData:[],onSuccess(e){e.length>0&&(this.targetGroup.value=e[0].name)},auto:!0}},cloneGroup(){return{url:"press.api.site.clone_group",onSuccess(e){y.success("The current bench group has been cloned successfully. Redirecting to the new bench group..."),this.showCloneBenchDialog=!1,this.$router.push({name:"Deploy Candidate",params:{name:e.bench_name,id:e.candidate_name}})}}},serverOptions(){return{type:"list",doctype:"Server",fields:["name","title"],auto:!0,transform(e){return e.map(o=>({label:o.title,value:o.name}))}}}}},S={key:1,class:"space-y-4"},D={key:2,class:"text-md text-base text-gray-800"};function O(e,o,u,T,s,p){var h,m;const G=v,l=V,c=_,d=k;return t(),i(C,null,[r(d,{options:{title:"Move Site to another Bench Group",actions:[{label:"Change Bench Group",loading:e.$resources.changeGroup.loading,disabled:!((m=(h=e.$resources.changeGroupOptions)==null?void 0:h.data)!=null&&m.length),variant:"solid",onClick:()=>e.$resources.changeGroup.submit({skip_failing_patches:s.skipFailingPatches,group:s.targetGroup.value,name:u.site})},{label:"Clone current Bench Group",onClick:()=>{e.$emit("update:modelValue",!1),s.showCloneBenchDialog=!0}}]},modelValue:s.show,"onUpdate:modelValue":o[2]||(o[2]=n=>s.show=n)},{"body-content":g(()=>[e.$resources.changeGroupOptions.loading?(t(),f(G,{key:0,class:"mx-auto h-4 w-4"})):e.$resources.changeGroupOptions.data.length>0?(t(),i("div",S,[r(l,{variant:"outline",label:"Select Bench Group",type:"autocomplete",options:e.$resources.changeGroupOptions.data.map(n=>({label:n.title||n.name,description:n.name,value:n.name})),modelValue:s.targetGroup,"onUpdate:modelValue":o[0]||(o[0]=n=>s.targetGroup=n)},null,8,["options","modelValue"]),r(l,{label:"Skip failing patches if any",type:"checkbox",modelValue:s.skipFailingPatches,"onUpdate:modelValue":o[1]||(o[1]=n=>s.skipFailingPatches=n)},null,8,["modelValue"])])):p.errorMessage?b("",!0):(t(),i("p",D," There are no other bench groups that you own for this site to move to. You can clone this bench group to move the site. ")),r(c,{class:"mt-3",message:p.errorMessage},null,8,["message"])]),_:1},8,["options","modelValue"]),r(d,{options:{title:"Clone Bench Group",actions:[{label:"Clone Bench Group",variant:"solid",loading:e.$resources.cloneGroup.loading,onClick:()=>e.$resources.cloneGroup.submit({name:u.site,new_group_title:s.newGroupTitle,server:s.selectedServer})}]},modelValue:s.showCloneBenchDialog,"onUpdate:modelValue":o[5]||(o[5]=n=>s.showCloneBenchDialog=n)},{"body-content":g(()=>[r(l,{label:"New Bench Group Name",modelValue:s.newGroupTitle,"onUpdate:modelValue":o[3]||(o[3]=n=>s.newGroupTitle=n)},null,8,["modelValue"]),e.$resources.serverOptions.data.length>0?(t(),f(l,{key:0,class:"mt-4",label:"Select Server",type:"select",options:e.$resources.serverOptions.data,modelValue:s.selectedServer,"onUpdate:modelValue":o[4]||(o[4]=n=>s.selectedServer=n)},null,8,["options","modelValue"])):b("",!0),r(c,{message:e.$resources.cloneGroup.error},null,8,["message"])]),_:1},8,["options","modelValue"])],64)}const M=w(B,[["render",O]]);export{M as default};
//# sourceMappingURL=SiteChangeGroupDialog-DfNPZV-X.js.map
