{"version":3,"file":"SiteChangeGroupDialog-DfNPZV-X.js","sources":["../../../../dashboard/src2/components/site/SiteChangeGroupDialog.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\t:options=\"{\n\t\t\ttitle: 'Move Site to another Bench Group',\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Change Bench Group',\n\t\t\t\t\tloading: $resources.changeGroup.loading,\n\t\t\t\t\tdisabled: !$resources.changeGroupOptions?.data?.length,\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tonClick: () =>\n\t\t\t\t\t\t$resources.changeGroup.submit({\n\t\t\t\t\t\t\tskip_failing_patches: skipFailingPatches,\n\t\t\t\t\t\t\tgroup: targetGroup.value,\n\t\t\t\t\t\t\tname: site\n\t\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Clone current Bench Group',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t$emit('update:modelValue', false);\n\t\t\t\t\t\tshowCloneBenchDialog = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t}\"\n\t\tv-model=\"show\"\n\t>\n\t\t<template #body-content>\n\t\t\t<LoadingIndicator\n\t\t\t\tclass=\"mx-auto h-4 w-4\"\n\t\t\t\tv-if=\"$resources.changeGroupOptions.loading\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tv-else-if=\"$resources.changeGroupOptions.data.length > 0\"\n\t\t\t\tclass=\"space-y-4\"\n\t\t\t>\n\t\t\t\t<FormControl\n\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\tlabel=\"Select Bench Group\"\n\t\t\t\t\ttype=\"autocomplete\"\n\t\t\t\t\t:options=\"\n\t\t\t\t\t\t$resources.changeGroupOptions.data.map(group => ({\n\t\t\t\t\t\t\tlabel: group.title || group.name,\n\t\t\t\t\t\t\tdescription: group.name,\n\t\t\t\t\t\t\tvalue: group.name\n\t\t\t\t\t\t}))\n\t\t\t\t\t\"\n\t\t\t\t\tv-model=\"targetGroup\"\n\t\t\t\t/>\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Skip failing patches if any\"\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tv-model=\"skipFailingPatches\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<p v-else-if=\"!errorMessage\" class=\"text-md text-base text-gray-800\">\n\t\t\t\tThere are no other bench groups that you own for this site to move to.\n\t\t\t\tYou can clone this bench group to move the site.\n\t\t\t</p>\n\t\t\t<ErrorMessage class=\"mt-3\" :message=\"errorMessage\" />\n\t\t</template>\n\t</Dialog>\n\t<Dialog\n\t\t:options=\"{\n\t\t\ttitle: 'Clone Bench Group',\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Clone Bench Group',\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tloading: $resources.cloneGroup.loading,\n\t\t\t\t\tonClick: () =>\n\t\t\t\t\t\t$resources.cloneGroup.submit({\n\t\t\t\t\t\t\tname: site,\n\t\t\t\t\t\t\tnew_group_title: newGroupTitle,\n\t\t\t\t\t\t\tserver: selectedServer\n\t\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t]\n\t\t}\"\n\t\tv-model=\"showCloneBenchDialog\"\n\t>\n\t\t<template #body-content>\n\t\t\t<FormControl label=\"New Bench Group Name\" v-model=\"newGroupTitle\" />\n\t\t\t<FormControl\n\t\t\t\tv-if=\"$resources.serverOptions.data.length > 0\"\n\t\t\t\tclass=\"mt-4\"\n\t\t\t\tlabel=\"Select Server\"\n\t\t\t\ttype=\"select\"\n\t\t\t\t:options=\"$resources.serverOptions.data\"\n\t\t\t\tv-model=\"selectedServer\"\n\t\t\t/>\n\t\t\t<ErrorMessage :message=\"$resources.cloneGroup.error\" />\n\t\t</template>\n\t</Dialog>\n</template>\n\n<script>\nimport { toast } from 'vue-sonner';\n\nexport default {\n\tprops: ['site'],\n\tdata() {\n\t\treturn {\n\t\t\tshow: true,\n\t\t\ttargetGroup: {\n\t\t\t\tlabel: '',\n\t\t\t\tvalue: ''\n\t\t\t},\n\t\t\tnewGroupTitle: '',\n\t\t\tskipFailingPatches: false,\n\t\t\tshowCloneBenchDialog: false,\n\t\t\tselectedServer: null\n\t\t};\n\t},\n\tcomputed: {\n\t\terrorMessage() {\n\t\t\treturn (\n\t\t\t\tthis.$resources.changeGroupOptions.error ||\n\t\t\t\tthis.$resources.changeGroup.error ||\n\t\t\t\tthis.$resources.cloneGroup.error\n\t\t\t);\n\t\t}\n\t},\n\tresources: {\n\t\tchangeGroup() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.site.change_group',\n\t\t\t\tonSuccess() {\n\t\t\t\t\tconst destinationGroupTitle =\n\t\t\t\t\t\tthis.$resources.changeGroupOptions.data.find(\n\t\t\t\t\t\t\tgroup => group.name === this.targetGroup.value\n\t\t\t\t\t\t).title;\n\n\t\t\t\t\ttoast.success(\n\t\t\t\t\t\t`The site has been scheduled to move to the ${destinationGroupTitle} bench group successfully.`\n\t\t\t\t\t);\n\n\t\t\t\t\tthis.$router.push({\n\t\t\t\t\t\tname: 'Site Jobs',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tname: this.site\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.targetGroup = {\n\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\tvalue: ''\n\t\t\t\t\t};\n\t\t\t\t\tthis.show = false;\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tchangeGroupOptions() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.site.change_group_options',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.site\n\t\t\t\t},\n\t\t\t\tinitialData: [],\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tif (data.length > 0) this.targetGroup.value = data[0].name;\n\t\t\t\t},\n\t\t\t\tauto: true\n\t\t\t};\n\t\t},\n\t\tcloneGroup() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.site.clone_group',\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\ttoast.success(\n\t\t\t\t\t\t'The current bench group has been cloned successfully. Redirecting to the new bench group...'\n\t\t\t\t\t);\n\t\t\t\t\tthis.showCloneBenchDialog = false;\n\n\t\t\t\t\tthis.$router.push({\n\t\t\t\t\t\tname: 'Deploy Candidate',\n\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\tname: data.bench_name,\n\t\t\t\t\t\t\tid: data.candidate_name\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tserverOptions() {\n\t\t\treturn {\n\t\t\t\ttype: 'list',\n\t\t\t\tdoctype: 'Server',\n\t\t\t\tfields: ['name', 'title'],\n\t\t\t\tauto: true,\n\t\t\t\ttransform(data) {\n\t\t\t\t\treturn data.map(server => ({\n\t\t\t\t\t\tlabel: server.title,\n\t\t\t\t\t\tvalue: server.name\n\t\t\t\t\t}));\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","group","destinationGroupTitle","data","server","_openBlock","_createElementBlock","_Fragment","_b","_a","_ctx","$data","_cache","$event","_withCtx","_hoisted_1","_createCommentVNode","$options"],"mappings":"8wBAoGA,MAAAA,EAAA,CACC,MAAA,CAAA,MAAA,EACA,MAAA,CACC,MAAA,CACC,KAAA,gBAEC,MAAA,GACA,MAAA,IAED,cAAA,iDAGA,eAAA,OAGF,SAAA,CACC,cAAA,CACC,OACC,KAAA,WAAA,mBAAA,OACA,KAAA,WAAA,YAAA,OACA,KAAA,WAAA,WAAA,KAEF,4BAIC,MAAA,CACC,IAAA,kDAGE,KAAA,WAAA,mBAAA,KAAA,KACCC,GAAAA,EAAA,OAAA,KAAA,YAAA,KACD,EAAA,gBAGA,8CAAAC,CAAA,8BAGD,KAAA,QAAA,KAAA,CACC,KAAA,YACA,OAAA,eAEA,CACD,CAAA,EAEA,KAAA,YAAA,CACC,MAAA,GACA,MAAA,IAED,KAAA,KAAA,EACD,IAGF,oBAAA,CACC,MAAA,CACC,IAAA,sCACA,OAAA,iBAGA,YAAA,CAAA,EACA,UAAAC,EAAA,iDAGA,KAAA,kBAID,MAAA,CACC,IAAA,6BACA,UAAAA,EAAA,WAEE,+FAED,KAAA,qBAAA,GAEA,KAAA,QAAA,KAAA,yBAEC,OAAA,CACC,KAAAA,EAAA,WACA,GAAAA,EAAA,cACD,CACD,CAAA,CACD,IAGF,eAAA,CACC,MAAA,aAEC,QAAA,iCAEA,KAAA,GACA,UAAAA,EAAA,mBAEE,MAAAC,EAAA,MACA,MAAAA,EAAA,IACD,EAAA,CACD,EAEF,CACD,CACD,WArKI,MAAA,sBAqB4B,MAAA,yFAxDhC,OAAAC,EAAA,EAAAC,EAAAC,EAAA,KAAA,sIAEgL,SAAA,GAAAC,GAAAC,EAAAC,EAAA,WAAA,qBAAA,YAAAD,EAAA,OAAA,MAAAD,EAAA,+GAA6L,MAAAG,EAAA,YAAA,mIAF7W,WAAAA,EAAA,KAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,KAAAE,KA4Ba,eAAAC,EAAA,IAAA,yDAET,MAAA,qBAIWJ,EAAA,WAAA,mBAAA,KAAA,OAAA,GADZL,IAAAC,EAAA,MAAAS,EAAA,MAKE,QAAA,UACA,MAAA,qBACA,KAAA,uBACiBL,EAAA,WAAA,mBAAA,KAAA,IAAAT,IAAA,CAAiE,MAAAA,EAAA,OAAAA,EAAA,KAA+C,YAAAA,EAAA,KAA0B,MAAAA,EAAA,QAzChK,WAAAU,EAAA,YAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,YAAAE,0CAmDK,MAAA,8BACA,KAAA,WApDL,WAAAF,EAAA,mBAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,mBAAAE,6CAAAG,EAAA,GAAA,EAAA,kJA4DiB,MAAA,OAAc,QAAAC,EAAA,8TA5D/B,WAAAN,EAAA,qBAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,qBAAAE,KAkFa,eAAAC,EAAA,IAAA,MACG,MAAA,uBAnFhB,WAAAH,EAAA,cAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,cAAAE,2BAqFUH,EAAA,WAAA,cAAA,KAAA,OAAA,kBACN,MAAA,OACA,MAAA,gBACA,KAAA,SACC,QAAAA,EAAA,WAAA,cAAA,KAzFL,WAAAC,EAAA,eAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,eAAAE,sCAAAG,EAAA,GAAA,EAAA,OA4FkB,QAAAN,EAAA,WAAA,WAAA"}