{"version":3,"file":"AddMpesaCredentials-CMchp7nn.js","sources":["../../../../dashboard/src2/components/billing/mpesa/AddMpesaCredentials.vue"],"sourcesContent":["<template>\n\t<Dialog :options=\"{ title: 'Add M-Pesa Credentials', size: 'xl' }\">\n\t\t<template #body-content>\n\t\t\t<div class=\"grid grid-cols-2 gap-5\">\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Mpesa Setup ID\"\n\t\t\t\t\tv-model=\"mpesaSetupDetails.mpesa_setup_id\"\n\t\t\t\t\tname=\"mpesa_setup_id\"\n\t\t\t\t\tclass=\"mb-3\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"Test Mpesa\"\n\t\t\t\t/>\n\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Consumer Key\"\n\t\t\t\t\tv-model=\"mpesaSetupDetails.consumer_key\"\n\t\t\t\t\tname=\"consumer_key\"\n\t\t\t\t\tclass=\"mb-3\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"Enter Consumer Key\"\n\t\t\t\t/>\n\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Consumer Secret\"\n\t\t\t\t\tv-model=\"mpesaSetupDetails.consumer_secret\"\n\t\t\t\t\tname=\"consumer_secret\"\n\t\t\t\t\tclass=\"mb-3\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"Enter Consumer Secret\"\n\t\t\t\t/>\n\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Pass Key\"\n\t\t\t\t\tv-model=\"mpesaSetupDetails.pass_key\"\n\t\t\t\t\tname=\"pass_key\"\n\t\t\t\t\tclass=\"mb-3\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"Enter Pass Key\"\n\t\t\t\t/>\n\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Business Short Code\"\n\t\t\t\t\tv-model=\"mpesaSetupDetails.short_code\"\n\t\t\t\t\tname=\"short_code\"\n\t\t\t\t\tclass=\"mb-3\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"Enter Short Code\"\n\t\t\t\t/>\n\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Initiator Name\"\n\t\t\t\t\tv-model=\"mpesaSetupDetails.initiator_name\"\n\t\t\t\t\tname=\"initiator_name\"\n\t\t\t\t\tclass=\"mb-3\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"e.g John Doe\"\n\t\t\t\t/>\n\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Security Credential\"\n\t\t\t\t\tv-model=\"mpesaSetupDetails.security_credential\"\n\t\t\t\t\tname=\"security_credential\"\n\t\t\t\t\tclass=\"mb-3\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"Enter Security Credential\"\n\t\t\t\t/>\n\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Till Number\"\n\t\t\t\t\tv-model=\"mpesaSetupDetails.till_number\"\n\t\t\t\t\tname=\"till_number\"\n\t\t\t\t\tclass=\"mb-3\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"1234567\"\n\t\t\t\t/>\n\n\t\t\t\t<!-- <div class=\"flex items-center\">\n\t\t\t\t\t<input v-model=\"sandBox\" type=\"checkbox\" class=\"mr-2\" />\n\t\t\t\t\t<label class=\"text-sm font-medium text-gray-700\">Sandbox Mode</label>\n\t\t\t\t</div> -->\n\t\t\t\t<ErrorMessage class=\"mt-2\" :message=\"errorMessage\" />\n\t\t\t</div>\n\n\t\t\t<div class=\"mt-4 flex w-full bg-red-300 items-center justify-center\">\n\t\t\t\t<Button\n\t\t\t\t\t@click=\"saveMpesaCredentials\"\n\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\tclass=\"justify-center w-full\"\n\t\t\t\t>\n\t\t\t\t\tSave\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n\n<script>\nimport { toast } from 'vue-sonner';\nimport { DashboardError } from '../../../utils/error';\nimport { ErrorMessage } from 'frappe-ui';\nexport default {\n\tname: 'AddMpesaCredentials',\n\tdata() {\n\t\treturn {\n\t\t\tmpesaSetupDetails: {\n\t\t\t\tconsumer_key: '',\n\t\t\t\tmpesa_setup_id: '',\n\t\t\t\tconsumer_secret: '',\n\t\t\t\tpass_key: '',\n\t\t\t\tshort_code: '',\n\t\t\t\tinitiator_name: '',\n\t\t\t\tsecurity_credential: '',\n\t\t\t\ttill_number: '',\n\t\t\t\t// sandBox: false,\n\t\t\t},\n\t\t\terrorMessage: '',\n\t\t};\n\t},\n\tresources: {\n\t\tcreateMpesaSetup() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.regional_payments.mpesa.utils.update_mpesa_setup',\n\t\t\t\tmakeParams() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tmpesa_details: this.mpesaSetupDetails,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tvalidate() {\n\t\t\t\t\tlet fields = Object.values(this.mpesaSetupDetails);\n\t\t\t\t\tif (fields.includes('')) {\n\t\t\t\t\t\tthis.errorMessage = 'Please fill required values';\n\t\t\t\t\t\treturn 'Please fill required values';\n\t\t\t\t\t\t// throw new DashboardError('Please fill required values');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tif (data) {\n\t\t\t\t\t\ttoast.success('M-Pesa credentials saved', data);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error('Error saving M-Pesa credentials');\n\t\t\t\t\t}\n\t\t\t\t\tthis.$emit('closeDialog');\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tfetchMpesaSetup() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.regional_payments.mpesa.utils.fetch_mpesa_setup',\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tObject.assign(this.mpesaSetupDetails, {\n\t\t\t\t\t\tmpesa_setup_id: data.mpesa_setup_id,\n\t\t\t\t\t\tconsumer_key: data.consumer_key,\n\t\t\t\t\t\tconsumer_secret: data.consumer_secret,\n\t\t\t\t\t\tsecurity_credential: data.security_credential,\n\t\t\t\t\t\tpass_key: data.pass_key,\n\t\t\t\t\t\tshort_code: data.business_shortcode,\n\t\t\t\t\t\ttill_number: data.till_number,\n\t\t\t\t\t\tinitiator_name: data.initiator_name,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tauto: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tsaveMpesaCredentials() {\n\t\t\tthis.$resources.createMpesaSetup.submit();\n\t\t},\n\t},\n};\n</script>\n"],"names":["_sfc_main","data","toast","_hoisted_1","_hoisted_2","_withCtx","_createElementVNode","$data","$options","_cache","_createTextVNode"],"mappings":"swBAoGA,MAAAA,EAAA,4BAEC,MAAA,CACC,MAAA,CACC,kBAAA,CACC,aAAA,GACA,eAAA,GACA,gBAAA,6BAGA,eAAA,0BAEA,YAAA,IAGD,aAAA,gBAID,kBAAA,CACC,MAAA,CACC,IAAA,0EAEC,MAAA,CACC,cAAA,KAAA,qFAMA,YAAA,aAAA,8BACA,+BAIF,UAAAC,EAAA,CACCA,EACCC,EAAA,QAAA,2BAAAD,CAAA,EAEAC,EAAA,MAAA,iCAAA,+BAMJ,iBAAA,CACC,MAAA,CACC,IAAA,4DACA,UAAAD,EAAA,CACC,OAAA,OAAA,KAAA,kBAAA,CACC,eAAAA,EAAA,eACA,aAAAA,EAAA,aACA,gBAAAA,EAAA,gBACA,oBAAAA,EAAA,wCAEA,WAAAA,EAAA,6CAEA,eAAAA,EAAA,cACD,CAAA,GAED,KAAA,MAIH,QAAA,wBAEE,KAAA,WAAA,iBAAA,OAAA,GAGH,EAtKQE,EAAA,CAAA,MAAA,wBAAA,EAgFAC,EAAA,CAAA,MAAA,yDAAA,qHAjFK,eAAAC,EAAA,IAAA,CACVC,EAAA,MAAAH,EAAA,MAEE,MAAA,0IAEA,KAAA,iBACA,MAAA,OACA,KAAA,OACA,YAAA,0CAIA,MAAA,oIAEA,KAAA,eACA,MAAA,OACA,KAAA,OACA,YAAA,kDAIA,MAAA,6IAEA,KAAA,kBACA,MAAA,OACA,KAAA,OACA,YAAA,qDAIA,MAAA,wHAEA,KAAA,WACA,MAAA,OACA,KAAA,OACA,YAAA,8CAIA,MAAA,uIAEA,KAAA,aACA,MAAA,OACA,KAAA,OACA,YAAA,gDAIA,MAAA,0IAEA,KAAA,iBACA,MAAA,OACA,KAAA,OACA,YAAA,4CAIA,MAAA,yJAEA,KAAA,sBACA,MAAA,OACA,KAAA,OACA,YAAA,yDAIA,MAAA,iIAEA,KAAA,cACA,MAAA,OACA,KAAA,OACA,YAAA,uCAOa,MAAA,OAAc,QAAAI,EAAA,oCAG7BD,EAAA,MAAAF,EAAA,MAEG,QAAAI,EAAA,qBACD,QAAA,QACA,MAAA,0BAvFL,QAAAH,EAAA,IAAAI,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAAC,EAAA,QAAA"}