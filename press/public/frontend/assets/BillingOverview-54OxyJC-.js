import{a as V,_ as B}from"./AlertBillingInformation-C5f9OKMF.js";import{x as D,z as s,q as y,o as l,A as r,h,u as p,w as _,j as n,a8 as U,t as f,a9 as E,aA as T,F as x,D as a,r as $,X as L,Y as I}from"./main-Dpl-JOF2.js";import{_ as k}from"./Card-BCzTSeNK.js";import R from"./BillingInformationDialog-B5pmLI5R.js";import{P as N}from"./PlanIcon-xHfeoGnX.js";import{_ as M}from"./InvoiceUsageTable-BfGDi_RQ.js";import"./Alert-COV4XS8q.js";import"./StripeLogo-BRF2qIyd.js";import"./stripe.esm-D4yu_pm0.js";import"./StripeCard-BRr8QCrN.js";import"./AddressForm-Cz0XUJgF.js";import"./Form-CIPLpg2e.js";(function(){try{var o=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(o._sentryDebugIds=o._sentryDebugIds||{},o._sentryDebugIds[e]="fcea21f9-62e9-4b59-8113-54eb9146c62f",o._sentryDebugIdIdentifier="sentry-dbid-fcea21f9-62e9-4b59-8113-54eb9146c62f")}catch(g){}})();{var v=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};v._sentryModuleMetadata=v._sentryModuleMetadata||{},v._sentryModuleMetadata[new Error().stack]=Object.assign({},v._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const Y={name:"ChangePaymentModeDialog",props:["modelValue"],emits:["update:modelValue"],components:{BillingInformationDialog:s(()=>a(()=>import("./BillingInformationDialog-B5pmLI5R.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),PrepaidCreditsDialog:s(()=>a(()=>import("./AlertBillingInformation-C5f9OKMF.js").then(o=>o.P),__vite__mapDeps([8,1,2,9,4,7,0,3,5,6])))},data(){return{showBillingInformationDialog:!1,showPrepaidCreditsDialog:!1,paymentMode:this.$account.team.payment_mode}},watch:{show(o){o||(this.paymentMode=this.$account.team.payment_mode)}},resources:{changePaymentMode(){return{url:"press.api.billing.change_payment_mode",params:{mode:this.paymentMode},onSuccess(){this.$emit("update:modelValue",!1),this.$resources.changePaymentMode.reset()},validate(){if(this.paymentMode=="Card"&&!this.$account.team.default_payment_method&&(this.$emit("update:modelValue",!1),this.showBillingInformationDialog=!0),this.paymentMode=="Prepaid Credits"&&this.$account.balance===0&&(this.$emit("update:modelValue",!1),this.showPrepaidCreditsDialog=!0),this.paymentMode=="Paid By Partner"&&!this.$account.team.partner_email)return"Please add a partner first from Partner section"}}}},computed:{paymentModeDescription(){return{Card:"Your card will be charged for monthly subscription","Prepaid Credits":"You will be charged from your account balance for monthly subscription","Paid By Partner":"Your partner will be charged for monthly subscription"}[this.paymentMode]},paymentModeOptions(){return this.$account.team.erpnext_partner||!this.$account.team.partner_email?["Card","Prepaid Credits"]:["Card","Prepaid Credits","Paid By Partner"]}}},j={class:"mt-2 text-base text-gray-600 mb-5"};function F(o,e,g,b,t,i){const d=U,c=E,w=T,P=R,C=V;return l(),y(x,null,[r(w,{options:{title:"Change Payment Mode",actions:[{label:"Change",variant:"solid",loading:o.$resources.changePaymentMode.loading,onClick:()=>o.$resources.changePaymentMode.submit()}]},modelValue:g.modelValue,"onUpdate:modelValue":e[1]||(e[1]=m=>o.$emit("update:modelValue",m))},{"body-content":_(()=>[r(d,{label:"Select Payment Mode",type:"select",options:i.paymentModeOptions,modelValue:t.paymentMode,"onUpdate:modelValue":e[0]||(e[0]=m=>t.paymentMode=m)},null,8,["options","modelValue"]),n("p",j,f(i.paymentModeDescription),1),r(c,{class:"mt-2",message:o.$resources.changePaymentMode.error},null,8,["message"])]),_:1},8,["options","modelValue"]),t.showBillingInformationDialog?(l(),h(P,{key:0,modelValue:t.showBillingInformationDialog,"onUpdate:modelValue":e[2]||(e[2]=m=>t.showBillingInformationDialog=m)},null,8,["modelValue"])):p("",!0),t.showPrepaidCreditsDialog?(l(),h(C,{key:1,show:t.showPrepaidCreditsDialog,"onUpdate:show":e[3]||(e[3]=m=>t.showPrepaidCreditsDialog=m),minimumAmount:o.$account.team.currency=="INR"?800:10,onSuccess:e[4]||(e[4]=()=>{o.$resources.upcomingInvoice.reload(),t.showPrepaidCreditsDialog=!1})},null,8,["show","minimumAmount"])):p("",!0)],64)}const S=D(Y,[["render",F]]),z=Object.freeze(Object.defineProperty({__proto__:null,default:S},Symbol.toStringTag,{value:"Module"})),q={name:"UpcomingInvoiceSummary",props:["invoiceDoc"],components:{InvoiceUsageTable:M},computed:{subtitle(){if(!this.invoiceDoc)return"No upcoming invoice";let o=this.$date(this.invoiceDoc.period_start),e=this.$date(this.invoiceDoc.period_end);return`Current month's total forecast (${o.toFormat("d MMM")} - ${e.toFormat("d MMM yyyy")})`}}};function K(o,e,g,b,t,i){const d=M,c=k;return l(),h(c,{title:"Invoice Summary",subtitle:i.subtitle},{default:_(()=>[r(d,{invoiceDoc:g.invoiceDoc},null,8,["invoiceDoc"])]),_:1},8,["subtitle"])}const X=D(q,[["render",K]]),H={name:"BillingSummary",components:{InvoiceUsageTable:M,PlanIcon:N,UpcomingInvoiceSummary:X,PrepaidCreditsDialog:s(()=>a(()=>import("./AlertBillingInformation-C5f9OKMF.js").then(o=>o.P),__vite__mapDeps([8,1,2,9,4,7,0,3,5,6]))),ChangePaymentModeDialog:s(()=>a(()=>Promise.resolve().then(()=>z),void 0)),UpdateBillingDetails:s(()=>a(()=>import("./UpdateBillingDetails-DpNU6Kwd.js"),__vite__mapDeps([10,1,2,5,6])))},resources:{upcomingInvoice:{url:"press.api.billing.upcoming_invoice",auto:!0},unpaidAmountDue(){return{url:"press.api.billing.total_unpaid_amount",auto:!0}},billingDetails:"press.api.billing.details"},data(){return{showPrepaidCreditsDialog:!1,showChangeModeDialog:!1,showAddressDialog:!1}},mounted(){this.$socket.on("balance_updated",()=>this.$resources.upcomingInvoice.reload())},unmounted(){this.$socket.off("balance_updated")},computed:{cardBrand(){return{"master-card":s(()=>a(()=>import("./MasterCard-DnwQYAr9.js"),__vite__mapDeps([11,1,2]))),visa:s(()=>a(()=>import("./Visa-DlT9BIbR.js"),__vite__mapDeps([12,1,2]))),amex:s(()=>a(()=>import("./Amex-DeZE9HZ9.js"),__vite__mapDeps([13,1,2]))),jcb:s(()=>a(()=>import("./JCB-D_ER5-Zn.js"),__vite__mapDeps([14,1,2]))),generic:s(()=>a(()=>import("./Generic-B8KQIWkl.js"),__vite__mapDeps([15,1,2]))),"union-pay":s(()=>a(()=>import("./UnionPay-B_wR_MmY.js"),__vite__mapDeps([16,1,2])))}},minimumAmount(){const o=this.$resources.unpaidAmountDue.data,e=$account.team.currency=="INR"?800:10;return o&&o>e?o:e},upcomingInvoice(){var o;return(o=this.$resources.upcomingInvoice.data)==null?void 0:o.upcoming_invoice},availableCredits(){var o;return(o=this.$resources.upcomingInvoice.data)==null?void 0:o.available_credits},paymentDate(){return this.upcomingInvoice?this.$date(this.upcomingInvoice.period_end).toLocaleString({month:"short",day:"numeric",year:"numeric"}):""},paymentModeDescription(){let o=this.$account.team.payment_mode,e=this.$account.balance;return o==="Card"?!this.upcomingInvoice||e<=0?`Your card will be charged on ${this.paymentDate}.`:e>=this.upcomingInvoice.total?`Your account balance will be charged on ${this.paymentDate}.`:e>0?`Your account balance will be charged and then the remaining balance will be charged from your card on ${this.paymentDate}.`:`Your card will be charged on ${this.paymentDate}.`:o==="Prepaid Credits"?`You will be charged from your account balance on ${this.paymentDate}.`:""},loading(){return this.$resources.upcomingInvoice.loading}},methods:{dateShort(o){return this.$date(o).toLocaleString({month:"short",day:"numeric",year:"numeric"})}}},J={class:"space-y-5"},Q={key:0},W={class:"grid grid-cols-2 gap-4 mb-4"},Z={class:"border rounded-md p-4"},G={class:"text-2xl font-medium"},ee={class:"border rounded-md p-4"},oe={class:"flex justify-between text-base"},te={class:"text-2xl font-medium"},ne={class:"border rounded-md p-4"},ie={class:"flex justify-between text-base"},re={class:"text-2xl font-medium"},se={class:"border rounded-md p-4"},ae={class:"flex justify-between text-base"},le={class:"text-2xl font-medium"},de={key:1,class:"py-20 text-center"};function me(o,e,g,b,t,i){var A;const d=L,c=E,w=S,P=$("UpdateBillingDetails"),C=V,m=k,O=$("UpcomingInvoiceSummary");return l(),y("div",J,[r(m,{title:"Billing Summary"},{default:_(()=>[o.$resources.upcomingInvoice.loading?p("",!0):(l(),y("div",Q,[n("div",W,[n("div",Z,[e[8]||(e[8]=n("div",{class:"text-base mb-2"},"Current Billing Amount",-1)),n("div",G,f(i.upcomingInvoice?i.upcomingInvoice.formatted.total:"0.00"),1)]),n("div",ee,[n("div",oe,[e[10]||(e[10]=n("div",null,"Total Unpaid Amount",-1)),r(d,{onClick:e[0]||(e[0]=u=>o.$account.team.billing_address?t.showPrepaidCreditsDialog=!0:t.showAddressDialog=!0),theme:"gray",iconLeft:"credit-card"},{default:_(()=>e[9]||(e[9]=[I("Pay")])),_:1})]),n("div",te,f((o.$account.team.currency=="INR"?"â‚¹":"$")+" "+Math.ceil(o.$resources.unpaidAmountDue.data)),1)]),n("div",ne,[n("div",ie,[e[12]||(e[12]=n("div",null,"Account Balance",-1)),r(d,{onClick:e[1]||(e[1]=u=>o.$account.team.billing_address?t.showPrepaidCreditsDialog=!0:t.showAddressDialog=!0),theme:"gray",iconLeft:"plus"},{default:_(()=>e[11]||(e[11]=[I("Add")])),_:1})]),n("div",re,f(i.availableCredits),1)]),n("div",se,[n("div",ae,[e[14]||(e[14]=n("div",null,"Payment Mode",-1)),r(d,{onClick:e[2]||(e[2]=u=>t.showChangeModeDialog=!0),theme:"gray"},{default:_(()=>e[13]||(e[13]=[I("Change")])),_:1})]),n("div",le,f(o.$account.team.payment_mode||"Not set"),1)])]),e[15]||(e[15]=n("a",{href:"https://easytouch.cloud/payment-options",target:"_blank",class:"text-sm text-gray-700 underline"}," Alternative Payment Options ",-1)),r(c,{message:o.$resources.upcomingInvoice.error,class:"mt-3"},null,8,["message"])])),i.loading?(l(),y("div",de,[r(d,{loading:!0,loadingText:"Loading"})])):p("",!0),r(w,{modelValue:t.showChangeModeDialog,"onUpdate:modelValue":e[3]||(e[3]=u=>t.showChangeModeDialog=u)},null,8,["modelValue"]),t.showAddressDialog?(l(),h(P,{key:2,modelValue:t.showAddressDialog,"onUpdate:modelValue":e[4]||(e[4]=u=>t.showAddressDialog=u),onUpdated:e[5]||(e[5]=u=>{t.showAddressDialog=!1,t.showPrepaidCreditsDialog=!0,o.$resources.billingDetails.reload()})},null,8,["modelValue"])):p("",!0),t.showPrepaidCreditsDialog?(l(),h(C,{key:3,show:t.showPrepaidCreditsDialog,"onUpdate:show":e[6]||(e[6]=u=>t.showPrepaidCreditsDialog=u),minimumAmount:Math.ceil(i.minimumAmount),onSuccess:e[7]||(e[7]=()=>{o.$resources.upcomingInvoice.reload(),t.showPrepaidCreditsDialog=!1})},null,8,["show","minimumAmount"])):p("",!0)]),_:1}),(A=i.upcomingInvoice)!=null&&A.items.length?(l(),h(O,{key:0,"invoice-doc":i.upcomingInvoice},null,8,["invoice-doc"])):p("",!0)])}const ue=D(H,[["render",me]]),ce={name:"BillingOverview",pageMeta(){return{title:"Billing - Easytouch Cloud"}},props:["invoiceName"],components:{BillingSummary:ue,AlertBillingInformation:B}},pe={class:"space-y-5"};function ge(o,e,g,b,t,i){const d=B,c=$("BillingSummary");return l(),y("div",pe,[r(d),r(c)])}const Me=D(ce,[["render",ge]]);export{Me as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/BillingInformationDialog-B5pmLI5R.js","assets/main-Dpl-JOF2.js","assets/main-B0ZLDivw.css","assets/StripeCard-BRr8QCrN.js","assets/StripeLogo-BRF2qIyd.js","assets/AddressForm-Cz0XUJgF.js","assets/Form-CIPLpg2e.js","assets/stripe.esm-D4yu_pm0.js","assets/AlertBillingInformation-C5f9OKMF.js","assets/Alert-COV4XS8q.js","assets/UpdateBillingDetails-DpNU6Kwd.js","assets/MasterCard-DnwQYAr9.js","assets/Visa-DlT9BIbR.js","assets/Amex-DeZE9HZ9.js","assets/JCB-D_ER5-Zn.js","assets/Generic-B8KQIWkl.js","assets/UnionPay-B_wR_MmY.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=BillingOverview-54OxyJC-.js.map
