{"version":3,"file":"Server-2gDzeoDd.js","sources":["../../../../dashboard/src/views/server/EditServerTitleDialog.vue","../../../../dashboard/src/views/server/Server.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\t:options=\"{\n\t\t\ttitle: 'Edit Title',\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Update',\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tloading: $resources.editTitle.loading,\n\t\t\t\t\tonClick: () => $resources.editTitle.submit()\n\t\t\t\t}\n\t\t\t]\n\t\t}\"\n\t\tv-model=\"show\"\n\t>\n\t\t<template v-slot:body-content>\n\t\t\t<FormControl label=\"Title\" type=\"text\" v-model=\"serverTitle\" />\n\t\t\t<ErrorMessage class=\"mt-4\" :message=\"$resources.editTitle.error\" />\n\t\t</template>\n\t</Dialog>\n</template>\n<script>\nexport default {\n\tname: 'EditServerTitleDialog',\n\tprops: ['modelValue', 'server'],\n\temits: ['update:modelValue'],\n\tdata() {\n\t\treturn {\n\t\t\tserverTitle: this.server.title\n\t\t};\n\t},\n\tresources: {\n\t\teditTitle() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.server.rename',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.server?.name,\n\t\t\t\t\ttitle: this.serverTitle\n\t\t\t\t},\n\t\t\t\tvalidate() {\n\t\t\t\t\tif (this.serverTitle === this.server?.title) {\n\t\t\t\t\t\treturn 'No changes in server title';\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSuccess() {\n\t\t\t\t\tthis.show = false;\n\t\t\t\t\tthis.server.title = this.serverTitle;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tcomputed: {\n\t\tshow: {\n\t\t\tget() {\n\t\t\t\treturn this.modelValue;\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tthis.$emit('update:modelValue', value);\n\t\t\t}\n\t\t}\n\t}\n};\n</script>\n","<template>\n\t<div>\n\t\t<div v-if=\"server\">\n\t\t\t<div>\n\t\t\t\t<header\n\t\t\t\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5\"\n\t\t\t\t>\n\t\t\t\t\t<Breadcrumbs\n\t\t\t\t\t\t:items=\"[\n\t\t\t\t\t\t\t{ label: 'Servers', route: { name: 'Servers' } },\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: server?.title,\n\t\t\t\t\t\t\t\troute: {\n\t\t\t\t\t\t\t\t\tname: 'ServerOverview',\n\t\t\t\t\t\t\t\t\tparams: { serverName: server?.name }\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #actions>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tv-if=\"server?.status === 'Active'\"\n\t\t\t\t\t\t\t\t\ticon-left=\"plus\"\n\t\t\t\t\t\t\t\t\tlabel=\"New Bench\"\n\t\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\t\t$router.push({\n\t\t\t\t\t\t\t\t\t\t\tname: 'NewServerBench',\n\t\t\t\t\t\t\t\t\t\t\tparams: { server: server?.name }\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<Dropdown :options=\"serverActions\">\n\t\t\t\t\t\t\t\t\t<template v-slot=\"{ open }\">\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"mr-2\"\n\t\t\t\t\t\t\t\t\t\t\ticon=\"more-horizontal\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</Dropdown>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Breadcrumbs>\n\t\t\t\t</header>\n\n\t\t\t\t<EditServerTitleDialog v-model=\"showEditTitleDialog\" :server=\"server\" />\n\n\t\t\t\t<div\n\t\t\t\t\tclass=\"flex flex-col space-y-3 px-5 py-3 md:flex-row md:items-baseline md:justify-between md:space-y-0\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"mt-2 flex items-center\">\n\t\t\t\t\t\t<h1 class=\"text-2xl font-bold\">{{ server.title }}</h1>\n\t\t\t\t\t\t<Badge class=\"ml-4\" :label=\"server.status\" />\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"regionInfo\"\n\t\t\t\t\t\t\tclass=\"ml-2 hidden cursor-default flex-row items-center self-end rounded-md bg-yellow-50 px-3 py-1 text-xs font-medium text-yellow-700 md:flex\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\tv-if=\"regionInfo.image\"\n\t\t\t\t\t\t\t\tclass=\"mr-2 h-4\"\n\t\t\t\t\t\t\t\t:src=\"regionInfo.image\"\n\t\t\t\t\t\t\t\t:alt=\"`Flag of ${regionInfo.title}`\"\n\t\t\t\t\t\t\t\t:title=\"regionInfo.image\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<p>{{ regionInfo.title }}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"mb-10 flex flex-row justify-between md:hidden\">\n\t\t\t\t\t\t<div class=\"flex flex-row\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-if=\"regionInfo\"\n\t\t\t\t\t\t\t\tclass=\"flex cursor-default flex-row items-center rounded-md bg-yellow-50 px-3 py-1 text-xs font-medium text-yellow-700\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\tv-if=\"regionInfo.image\"\n\t\t\t\t\t\t\t\t\tclass=\"mr-2 h-4\"\n\t\t\t\t\t\t\t\t\t:src=\"regionInfo.image\"\n\t\t\t\t\t\t\t\t\t:alt=\"`Flag of ${regionInfo.title}`\"\n\t\t\t\t\t\t\t\t\t:title=\"regionInfo.image\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<p>{{ regionInfo.title }}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"p-5 pt-1\">\n\t\t\t<Tabs :tabs=\"tabs\">\n\t\t\t\t<router-view v-slot=\"{ Component, route }\">\n\t\t\t\t\t<component v-if=\"server\" :is=\"Component\" :server=\"server\"></component>\n\t\t\t\t</router-view>\n\t\t\t</Tabs>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport EditServerTitleDialog from './EditServerTitleDialog.vue';\nimport Tabs from '@/components/Tabs.vue';\nimport { notify } from '@/utils/toast';\n\nexport default {\n\tname: 'Server',\n\tpageMeta() {\n\t\treturn {\n\t\t\ttitle: `Server - ${this.serverName} - Easytouch Cloud`\n\t\t};\n\t},\n\tprops: ['serverName'],\n\tcomponents: {\n\t\tEditServerTitleDialog,\n\t\tTabs\n\t},\n\tdata() {\n\t\treturn {\n\t\t\trunningJob: false,\n\t\t\trunningPlay: false,\n\t\t\tshowEditTitleDialog: false,\n\t\t\terrorMessage: ''\n\t\t};\n\t},\n\tresources: {\n\t\tserver() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.server.get',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.serverName\n\t\t\t\t},\n\t\t\t\tauto: true,\n\t\t\t\tonSuccess() {\n\t\t\t\t\tthis.routeToGeneral();\n\t\t\t\t},\n\t\t\t\tonError: this.$routeTo404PageIfNotFound\n\t\t\t};\n\t\t},\n\t\treboot() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.server.reboot',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.serverName\n\t\t\t\t},\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tnotify({\n\t\t\t\t\t\ttitle: 'Server Reboot Scheduled Successfully',\n\t\t\t\t\t\tcolor: 'green',\n\t\t\t\t\t\ticon: 'check'\n\t\t\t\t\t});\n\t\t\t\t\tthis.$resources.server.reload();\n\t\t\t\t},\n\t\t\t\tonError() {\n\t\t\t\t\tnotify({\n\t\t\t\t\t\ttitle: 'An error occurred',\n\t\t\t\t\t\tcolor: 'red',\n\t\t\t\t\t\ticon: 'x'\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\trouteToGeneral() {\n\t\t\tif (this.$route.matched.length === 1) {\n\t\t\t\tlet path = this.$route.fullPath;\n\t\t\t\tthis.$router.replace(`${path}/overview`);\n\t\t\t}\n\t\t}\n\t},\n\tcomputed: {\n\t\tserver() {\n\t\t\treturn this.$resources.server.data;\n\t\t},\n\n\t\tregionInfo() {\n\t\t\tif (!this.$resources.server.loading && this.$resources.server.data) {\n\t\t\t\treturn this.$resources.server.data.region_info;\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\tserverActions() {\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Edit Title',\n\t\t\t\t\ticon: 'edit',\n\t\t\t\t\tonClick: () => (this.showEditTitleDialog = true)\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Visit Server',\n\t\t\t\t\ticon: 'external-link',\n\t\t\t\t\tcondition: () =>\n\t\t\t\t\t\t['Active', 'Updating'].includes(this.server.status) &&\n\t\t\t\t\t\tthis.$account.user.user_type === 'System User',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\twindow.open(`https://${this.server.name}`, '_blank');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'View in Desk',\n\t\t\t\t\ticon: 'external-link',\n\t\t\t\t\tcondition: () => this.$account.user.user_type == 'System User',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\twindow.open(\n\t\t\t\t\t\t\t`${window.location.protocol}//${window.location.host}/app/${this.server.type}/${this.server.name}`,\n\t\t\t\t\t\t\t'_blank'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Reboot',\n\t\t\t\t\ticon: 'tool',\n\t\t\t\t\tcondition: () =>\n\t\t\t\t\t\tthis.server.status === 'Active' &&\n\t\t\t\t\t\tthis.$account.hasPermission(\n\t\t\t\t\t\t\tthis.server.name,\n\t\t\t\t\t\t\t'press.api.server.reboot'\n\t\t\t\t\t\t),\n\t\t\t\t\tloading: this.$resources.reboot.loading,\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\treturn this.$resources.reboot.submit();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Impersonate Team',\n\t\t\t\t\ticon: 'tool',\n\t\t\t\t\tcondition: () => this.$account.user.user_type == 'System User',\n\t\t\t\t\tonClick: async () => {\n\t\t\t\t\t\tawait this.$account.switchTeam(this.server.team);\n\t\t\t\t\t\tnotify({\n\t\t\t\t\t\t\ttitle: 'Switched Team',\n\t\t\t\t\t\t\tmessage: `Switched to ${this.server.team}`,\n\t\t\t\t\t\t\ticon: 'check',\n\t\t\t\t\t\t\tcolor: 'green'\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t];\n\t\t},\n\n\t\ttabs() {\n\t\t\tlet tabRoute = subRoute => `/servers/${this.serverName}/${subRoute}`;\n\t\t\tlet tabs = [\n\t\t\t\t{ label: 'Installing', route: 'install' },\n\t\t\t\t{ label: 'Overview', route: 'overview' },\n\t\t\t\t{ label: 'Analytics', route: 'analytics' },\n\t\t\t\t{ label: 'Benches', route: 'benches' },\n\t\t\t\t{ label: 'Jobs', route: 'jobs', showRedDot: this.runningJob },\n\t\t\t\t{ label: 'Plays', route: 'plays', showRedDot: this.runningPlay },\n\t\t\t\t{ label: 'Settings', route: 'settings' }\n\t\t\t];\n\n\t\t\tlet tabsByStatus = {\n\t\t\t\tActive: [\n\t\t\t\t\t'Overview',\n\t\t\t\t\t'Analytics',\n\t\t\t\t\t'Benches',\n\t\t\t\t\t'Jobs',\n\t\t\t\t\t'Plays',\n\t\t\t\t\t'Settings'\n\t\t\t\t],\n\t\t\t\tPending: ['Installing'],\n\t\t\t\tInstalling: ['Installing', 'Plays']\n\t\t\t};\n\t\t\tif (this.server) {\n\t\t\t\tlet tabsToShow = tabsByStatus[this.server.status];\n\t\t\t\tif (tabsToShow?.length) {\n\t\t\t\t\ttabs = tabs.filter(tab => tabsToShow.includes(tab.label));\n\t\t\t\t}\n\t\t\t\treturn tabs.map(tab => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...tab,\n\t\t\t\t\t\troute: tabRoute(tab.route)\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn [];\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","_a","value","$options","_cache","$event","_withCtx","$data","_ctx","EditServerTitleDialog","Tabs","data","notify","path","__async","tabRoute","subRoute","tabs","tabsByStatus","tab","__spreadProps","__spreadValues","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_11","_hoisted_12","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_b","_createCommentVNode","_toDisplayString","_hoisted_6","_hoisted_10","Component","route"],"mappings":"iiDAsBA,MAAAA,EAAA,wFAIC,MAAA,CACC,MAAA,8DAMC,MAAA,+BAEC,OAAA,0CAEC,MAAA,KAAA,8BAGA,GAAA,KAAA,gBAAAC,EAAA,KAAA,SAAA,YAAAA,EAAA,OACC,MAAA,0CAID,KAAA,KAAA,GACA,KAAA,OAAA,MAAA,KAAA,WACD,EAEF,GAED,SAAA,aAGG,OAAA,KAAA,mBAGA,KAAA,MAAA,oBAAAC,CAAA,CACD,CACD,CACD,CACD,uNA7DA,WAAAC,EAAA,KAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,KAAAE,KAemB,eAAAC,EAAA,IAAA,MACH,MAAA,QAAc,KAAA,OAhB9B,WAAAC,EAAA,YAAA,sBAAAH,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAE,EAAA,YAAAF,gCAiBiB,MAAA,OAAc,QAAAG,EAAA,WAAA,UAAA,0FCuF/BR,EAAA,0BAGE,MAAA,yDAID,MAAA,CAAA,YAAA,cAEC,sBAAAS,EACAC,KAAAA,GAED,MAAA,CACC,MAAA,CACC,WAAA,GACA,YAAA,0BAEA,aAAA,gBAID,QAAA,CACC,MAAA,4BAEC,OAAA,CACC,KAAA,KAAA,YAED,KAAA,eAEC,KAAA,eAAA,GAED,QAAA,KAAA,4BAGF,QAAA,CACC,MAAA,+BAEC,OAAA,CACC,KAAA,KAAA,YAED,UAAAC,EAAA,CACCC,EAAA,CACC,MAAA,iEAGD,CAAA,EACA,KAAA,WAAA,OAAA,OAAA,GAED,SAAA,CACCA,EAAA,uCAGC,KAAA,GACD,CAAA,CACD,EAEF,GAED,QAAA,CACC,gBAAA,CACC,GAAA,KAAA,OAAA,QAAA,SAAA,EAAA,4BAEC,KAAA,QAAA,QAAA,GAAAC,CAAA,WAAA,CACD,CACD,GAED,SAAA,CACC,QAAA,CACC,OAAA,KAAA,WAAA,OAAA,mBAIA,MAAA,CAAA,KAAA,WAAA,OAAA,SAAA,KAAA,WAAA,OAAA,KACC,KAAA,WAAA,OAAA,KAAA,kBAKF,eAAA,CACC,MAAA,CACC,CACC,MAAA,yBAEA,QAAA,IAAA,KAAA,oBAAA,IAED,CACC,MAAA,eACA,KAAA,kFAGC,KAAA,SAAA,KAAA,YAAA,8EAGD,GAED,CACC,MAAA,eACA,KAAA,sMAKE,SAEF,GAED,CACC,MAAA,mCAGC,KAAA,OAAA,SAAA,sCAEC,KAAA,OAAA,gCAGF,QAAA,KAAA,WAAA,OAAA,oBAEC,KAAA,WAAA,OAAA,OAAA,GAGF,gGAIC,QAAA,IAAAC,EAAA,uEAECF,EAAA,CACC,MAAA,gBACA,QAAA,eAAA,KAAA,OAAA,IAAA,6BAGD,CAAA,CACD,EACD,IAIF,MAAA,CACC,IAAAG,EAAAC,GAAA,YAAA,KAAA,UAAA,IAAAA,CAAA,GACAC,EAAA,CACC,CAAA,MAAA,aAAA,MAAA,SAAA,EACA,CAAA,MAAA,WAAA,MAAA,UAAA,EACA,CAAA,MAAA,YAAA,MAAA,WAAA,EACA,CAAA,MAAA,UAAA,MAAA,SAAA,mHAGA,CAAA,MAAA,WAAA,MAAA,UAAA,GAGDC,EAAA,CACC,OAAA,wBAGC,UACA,OACA,QACA,mCAGD,WAAA,CAAA,aAAA,OAAA,GAED,GAAA,KAAA,OAAA,4FAKCD,EAAA,IAAAE,GACCC,EAAAC,EAAA,GACCF,GADD,mBAID,CACD,CACA,MAAA,CAAA,CACD,CACD,CACD,YAnRKG,GAAA,CAAA,MAAA,mFAAA,EA4CAC,GAAA,CAAA,MAAA,iGAAA,EAEKC,GAAA,CAAA,MAAA,wBAAA,EACAC,GAAA,CAAA,MAAA,oBAAA,YAKH,MAAA,2IAzDPC,GAAA,CAAA,MAAA,MAAA,OAAA,EAqEUC,GAAA,CAAA,MAAA,+CAAA,EACCC,GAAA,CAAA,MAAA,eAAA,YAGH,MAAA,mHAzERC,GAAA,CAAA,MAAA,MAAA,OAAA,EAyFOC,GAAA,CAAA,MAAA,UAAA,gJAvFLC,IAAAC,EAAA,MAAAC,EAAA,eAEEC,EAAA,SAAAZ,GAAA,uDAI6F,OAAArB,EAAAE,EAAA,SAAA,YAAAF,EAAA,mCAAgG,OAAA,CAAA,YAAAkC,EAAAhC,EAAA,SAAA,YAAAgC,EAAA,IAAA,OAWhL,QAAA7B,EAAA,IAAA,OAAA,uBAGFL,EAAAE,EAAA,SAAA,YAAAF,EAAA,UAAA,yBACN,YAAA,OACA,MAAA,0CACmB,OAAAO,EAAA,QAAA,KAAA,uBAA+E,OAAA,CAAA,QAAAP,EAAAE,EAAA,SAAA,YAAAF,EAAA,IAAA,SAzB3GmC,EAAA,GAAA,EAAA,6DAmCW,QAAA,QACA,MAAA,OACA,KAAA,wEArCX,WAAA7B,EAAA,oBAAA,sBAAAH,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAE,EAAA,oBAAAF,GA8C0D,OAAAF,EAAA,wCAEtD+B,EAAA,MAAAX,GAAA,CAGCW,EAAA,MAAAV,GAAA,CACCU,EAAA,KAAAT,GAAAY,EAAAlC,EAAA,OAAA,KAAA,EAAA,CAAA,OACO,MAAA,8DAEP4B,IAAAC,EAAA,MAAAM,GAAA,CAKQnC,EAAA,WAAA,0BACN,MAAA,8FA7DR,EAAA,KAAA,EAAAuB,EAAA,GAAAU,EAAA,GAAA,EAAA,yCAAAA,EAAA,GAAA,EAAA,IAqEKF,EAAA,MAAAP,GAAA,CACCO,EAAA,MAAAN,GAAA,eACCG,IAAAC,EAAA,MAAAO,GAAA,CAKQpC,EAAA,WAAA,0BACN,MAAA,8FA7ET,EAAA,KAAA,EAAA0B,EAAA,GAAAO,EAAA,GAAA,EAAA,yCAAAA,EAAA,GAAA,EAAA,aAAAA,EAAA,GAAA,EAAA,EAyFEF,EAAA,MAAAJ,GAAA,oBAzFF,QAAAxB,EAAA,IAAA,WAAA,QAAAA,EAAA,CAAA,CAAA,UAAAkC,EAAA,MAAAC,CAAA,IAAA,6BA4F+C,OAAAtC,EAAA,4BA5F/CiC,EAAA,GAAA,EAAA"}