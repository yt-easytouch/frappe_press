import{_ as f}from"./LineChart-BDXlcfBY.js";import{x as v,q as g,o as u,j as p,A as y,a8 as D,h as m,av as w}from"./main-Dpl-JOF2.js";import{D as c}from"./datetime-PXpIdgFA.js";import"./Card-BCzTSeNK.js";import"./tailwind.theme-XeumNAwU.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},s=new Error().stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="7b50f60a-e4f1-4fad-8f5c-d0ebd031cf3e",e._sentryDebugIdIdentifier="sentry-dbid-7b50f60a-e4f1-4fad-8f5c-d0ebd031cf3e")}catch(o){}})();{var h=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};h._sentryModuleMetadata=h._sentryModuleMetadata||{},h._sentryModuleMetadata[new Error().stack]=Object.assign({},h._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const b={name:"ServerAnalytics",props:["serverName"],components:{LineChart:f},data(){var e;return{duration:"1 Hour",chosenServer:(e=this.$route.query.server)!=null?e:this.serverName,durationOptions:["1 Hour","6 Hour","24 Hour","7 Days","15 Days"]}},watch:{chosenServer(){this.$router.push({query:{server:this.chosenServer}})}},resources:{loadavg(){let e=c.local().zoneName;return{url:"press.api.server.analytics",params:{name:this.chosenServer,timezone:e,query:"loadavg",duration:this.duration},auto:!0}},cpu(){let e=c.local().zoneName;return{url:"press.api.server.analytics",params:{name:this.chosenServer,timezone:e,query:"cpu",duration:this.duration},auto:!0}},memory(){let e=c.local().zoneName;return{url:"press.api.server.analytics",params:{name:this.chosenServer,timezone:e,query:"memory",duration:this.duration},auto:!0}},network(){let e=c.local().zoneName;return{url:"press.api.server.analytics",params:{name:this.chosenServer,timezone:e,query:"network",duration:this.duration},auto:!0}},iops(){let e=c.local().zoneName;return{url:"press.api.server.analytics",params:{name:this.chosenServer,timezone:e,query:"iops",duration:this.duration},auto:!0}},space(){let e=c.local().zoneName;return{url:"press.api.server.analytics",params:{name:this.chosenServer,timezone:e,query:"space",duration:this.duration},auto:!0}}},computed:{$server(){return w("Server",this.serverName)},serverOptions(){return[{label:"Application Server",value:this.$server.doc.name},{label:"Database Server",value:this.$server.doc.database_server},{label:"Replication Server",value:this.$server.doc.replication_server}].filter(e=>e.value)},loadAverageData(){let e=this.$resources.loadavg.data;if(e)return e.datasets.sort((s,o)=>Number(s.name.split(" ")[2])-Number(o.name.split(" ")[2])),this.transformMultiLineChartData(e)},cpuData(){let e=this.$resources.cpu.data;if(e)return this.transformMultiLineChartData(e,"cpu",!0)},memoryData(){let e=this.$resources.memory.data;if(e)return this.transformSingleLineChartData(e)},iopsData(){let e=this.$resources.iops.data;if(e)return this.transformSingleLineChartData(e)},spaceData(){let e=this.$resources.space.data;if(e)return this.transformSingleLineChartData(e,!0)},networkData(){let e=this.$resources.network.data;if(e)return this.transformSingleLineChartData(e)}},methods:{transformSingleLineChartData(e,s=!1){var n,r;if(!((n=e.datasets)!=null&&n.length))return;let o=[];const i=e.datasets?(r=e.datasets[0])==null?void 0:r.name:null;for(let a=0;a<e.datasets[0].values.length;a++)o.push([+new Date(e.labels[a]),e.datasets[0].values[a]]);return{datasets:[{dataset:o,name:i}],yMax:s?100:null}},transformMultiLineChartData(e,s=null,o=!1){var r;if(!((r=e.datasets)!=null&&r.length))return;let i=[];if(o)for(let a=0;a<e.datasets[0].values.length;a++)for(let t=0;t<e.datasets.length;t++)i[a]||(i[a]=0),i[a]+=e.datasets[t].values[a];return{datasets:e.datasets.map(({name:a,values:t})=>{let l=[];for(let d=0;d<t.length;d++)l.push([+new Date(e.labels[d]),o?t[d]/i[d]*100:t[d]]);return{name:a,dataset:l,stack:s}}),yMax:o?100:null}}}},$={class:"space-y-4"},k={class:"flex space-x-2"},S={class:"grid grid-cols-1 gap-5 sm:grid-cols-2"};function T(e,s,o,i,n,r){const a=D,t=f;return u(),g("div",$,[p("div",k,[y(a,{class:"w-40",label:"Server",type:"select",options:r.serverOptions,modelValue:n.chosenServer,"onUpdate:modelValue":s[0]||(s[0]=l=>n.chosenServer=l)},null,8,["options","modelValue"]),y(a,{class:"w-32",label:"Duration",type:"select",options:n.durationOptions.map(l=>({label:l,value:l})),modelValue:n.duration,"onUpdate:modelValue":s[1]||(s[1]=l=>n.duration=l)},null,8,["options","modelValue"])]),p("div",S,[(u(),m(t,{type:"time",title:"CPU",key:r.cpuData,data:r.cpuData,unit:"%",chartTheme:[e.$theme.colors.green[500],e.$theme.colors.red[500],e.$theme.colors.yellow[500],e.$theme.colors.pink[500],e.$theme.colors.purple[500],e.$theme.colors.blue[500],e.$theme.colors.teal[500],e.$theme.colors.cyan[500]],loading:e.$resources.cpu.loading,error:e.$resources.cpu.error},null,8,["data","chartTheme","loading","error"])),(u(),m(t,{type:"time",title:"Load Average",key:r.loadAverageData,data:r.loadAverageData,chartTheme:[e.$theme.colors.green[500],e.$theme.colors.yellow[400],e.$theme.colors.red[500]],loading:e.$resources.loadavg.loading,error:e.$resources.loadavg.error},null,8,["data","chartTheme","loading","error"])),(u(),m(t,{type:"time",title:"Memory",key:r.memoryData,data:r.memoryData,unit:"bytes",chartTheme:[e.$theme.colors.yellow[500]],loading:e.$resources.memory.loading,error:e.$resources.memory.error},null,8,["data","chartTheme","loading","error"])),(u(),m(t,{type:"time",title:"Disk Space",key:r.spaceData,data:r.spaceData,unit:"%",chartTheme:[e.$theme.colors.red[500]],loading:e.$resources.space.loading,error:e.$resources.space.error},null,8,["data","chartTheme","loading","error"])),(u(),m(t,{type:"time",title:"Network",key:r.networkData,data:r.networkData,unit:"bytes",chartTheme:[e.$theme.colors.blue[500]],loading:e.$resources.network.loading,error:e.$resources.network.error},null,8,["data","chartTheme","loading","error"])),(u(),m(t,{type:"time",title:"Disk I/O",key:r.iopsData,data:r.iopsData,unit:"I0ps",chartTheme:[e.$theme.colors.purple[500]],loading:e.$resources.iops.loading,error:e.$resources.iops.error},null,8,["data","chartTheme","loading","error"]))])])}const A=v(b,[["render",T]]);export{A as default};
//# sourceMappingURL=ServerAnalytics-Bx5M123k.js.map
