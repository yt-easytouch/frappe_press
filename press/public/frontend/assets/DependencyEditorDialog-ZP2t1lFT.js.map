{"version":3,"file":"DependencyEditorDialog-ZP2t1lFT.js","sources":["../../../../dashboard/src2/components/group/DependencyEditorDialog.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\t:options=\"{\n\t\t\ttitle: `Edit ${dependency.title}`,\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Update',\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tloading: groupDocResource?.updateDependency?.loading,\n\t\t\t\t\tonClick: updateDependency\n\t\t\t\t}\n\t\t\t]\n\t\t}\"\n\t\tv-model=\"showDialog\"\n\t>\n\t\t<template #body-content>\n\t\t\t<div class=\"space-y-4\">\n\t\t\t\t<!-- Custom dependency version -->\n\t\t\t\t<div v-if=\"useCustomVersion\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\ttype=\"data\"\n\t\t\t\t\t\t:label=\"`Custom ${dependency.title}`\"\n\t\t\t\t\t\tplaceholder=\"Please enter a custom version\"\n\t\t\t\t\t\tdescription=\"Please ensure entered version of this dependency exists before setting it\"\n\t\t\t\t\t\tv-model=\"customVersion\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Non custom version -->\n\t\t\t\t<FormControl\n\t\t\t\t\tv-else\n\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t:disabled=\"useCustomVersion\"\n\t\t\t\t\t:label=\"dependency.title\"\n\t\t\t\t\tplaceholder=\"Please select a version\"\n\t\t\t\t\t:options=\"dependencyOptions\"\n\t\t\t\t\tv-model=\"selectedDependencyVersion\"\n\t\t\t\t/>\n\n\t\t\t\t<!-- Use Custom Version Checkbox -->\n\t\t\t\t<div class=\"flex items-center gap-2\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tlabel=\"Use Custom Version\"\n\t\t\t\t\t\tv-model=\"useCustomVersion\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Tooltip text=\"View documentation\">\n\t\t\t\t\t\t<a\n\t\t\t\t\t\t\tclass=\"no-underline\"\n\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\thref=\"https://easytouch.cloud/docs/benches/editing-bench-dependency-version#setting-a-custom-version\"\n\t\t\t\t\t\t\t><FeatherIcon\n\t\t\t\t\t\t\t\tname=\"help-circle\"\n\t\t\t\t\t\t\t\tclass=\"h-3 w-3 text-gray-700\"\n\t\t\t\t\t\t\t></FeatherIcon\n\t\t\t\t\t\t></a>\n\t\t\t\t\t</Tooltip>\n\t\t\t\t</div>\n\n\t\t\t\t<ErrorMessage\n\t\t\t\t\t:message=\"groupDocResource?.updateDependency?.error || error\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n\n<script>\nimport { getCachedDocumentResource } from 'frappe-ui';\n\nexport default {\n\tname: 'DependencyEditorDialog',\n\tprops: {\n\t\tgroup: { required: true, type: Object },\n\t\tdependency: { required: true, type: Object }\n\t},\n\tdata() {\n\t\treturn {\n\t\t\terror: '',\n\t\t\tshowDialog: true,\n\t\t\tcustomVersion: '',\n\t\t\tuseCustomVersion: false,\n\t\t\tselectedDependencyVersion: null,\n\t\t\tgroupDocResource: getCachedDocumentResource(\n\t\t\t\t'Release Group',\n\t\t\t\tthis.group.name\n\t\t\t)\n\t\t};\n\t},\n\tmounted() {\n\t\tif (this.dependency.is_custom) {\n\t\t\tthis.useCustomVersion = true;\n\t\t\tthis.customVersion = this.dependency.version;\n\t\t} else {\n\t\t\tthis.selectedDependencyVersion = this.dependency.version;\n\t\t}\n\t},\n\tcomputed: {\n\t\tdependencyOptions() {\n\t\t\tconst versions = new Set(this.$resources.dependencyVersions.data ?? []);\n\t\t\tif (!this.dependency.is_custom) {\n\t\t\t\tversions.add(this.dependency.version);\n\t\t\t}\n\n\t\t\treturn Array.from(versions)\n\t\t\t\t.sort()\n\t\t\t\t.map(v => ({\n\t\t\t\t\tlabel: v,\n\t\t\t\t\tvalue: v\n\t\t\t\t}));\n\t\t},\n\t\tversion() {\n\t\t\tif (this.useCustomVersion) {\n\t\t\t\treturn this.customVersion;\n\t\t\t}\n\n\t\t\treturn this.selectedDependencyVersion;\n\t\t}\n\t},\n\tresources: {\n\t\tdependencyVersions() {\n\t\t\treturn {\n\t\t\t\ttype: 'list',\n\t\t\t\tdoctype: 'Bench Dependency Version',\n\t\t\t\tfields: ['version'],\n\t\t\t\tfilters: {\n\t\t\t\t\tparenttype: 'Bench Dependency',\n\t\t\t\t\tparent: this.dependency.dependency,\n\t\t\t\t\tsupported_frappe_version: this.group.version\n\t\t\t\t},\n\t\t\t\ttransform(data) {\n\t\t\t\t\treturn data.map(d => d.version);\n\t\t\t\t},\n\t\t\t\torderBy: 'version asc',\n\t\t\t\tpageLength: 1000,\n\t\t\t\tauto: true\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\tsetErrorIfCannotUpdate() {\n\t\t\tif (!this.version) {\n\t\t\t\tconst verb = this.useCustomVersion ? 'enter' : 'select';\n\t\t\t\tthis.error = `Please ${verb} a version`;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif (this.dependency.version === this.version) {\n\t\t\t\tconst verb = this.useCustomVersion ? 'Entered' : 'selected';\n\t\t\t\tthis.error = `${verb} version is same as the previous version`;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tthis.error = '';\n\t\t\treturn false;\n\t\t},\n\t\tupdateDependency() {\n\t\t\tif (this.setErrorIfCannotUpdate()) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.groupDocResource.updateDependency.submit(\n\t\t\t\t{\n\t\t\t\t\tdependency_name: this.dependency.name,\n\t\t\t\t\tversion: this.version,\n\t\t\t\t\tis_custom: this.useCustomVersion\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tonSuccess: () => {\n\t\t\t\t\t\tthis.$emit('success');\n\t\t\t\t\t\tthis.showDialog = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","getCachedDocumentResource","versions","_a","v","data","verb","_hoisted_1","_hoisted_3","$props","$data","_cache","$event","_withCtx","_createElementVNode","_openBlock","_createElementBlock","_hoisted_2","$options","_hoisted_4","_b"],"mappings":"8wBAsEA,MAAAA,EAAA,+BAEC,MAAA,CACC,MAAA,CAAA,SAAA,GAAA,KAAA,MAAA,EACA,WAAA,CAAA,SAAA,GAAA,KAAA,MAAA,GAED,MAAA,CACC,MAAA,CACC,MAAA,GACA,WAAA,GACA,cAAA,uBAEA,0BAAA,KACA,iBAAAC,EACC,gBACA,KAAA,MAAA,IACD,IAGF,SAAA,qDAGE,KAAA,cAAA,KAAA,WAAA,iEAKF,SAAA,CACC,mBAAA,OACC,MAAAC,EAAA,IAAA,KAAAC,EAAA,KAAA,WAAA,mBAAA,OAAA,KAAAA,EAAA,EAAA,EACA,OAAA,KAAA,WAAA,WACCD,EAAA,IAAA,KAAA,WAAA,OAAA,gBAIA,KAAA,EACA,IAAAE,IAAA,CACC,MAAAA,EACA,MAAAA,CACD,EAAA,GAEF,SAAA,iDAKC,KAAA,yBACD,cAGA,oBAAA,CACC,MAAA,aAEC,QAAA,2BACA,OAAA,CAAA,SAAA,EACA,QAAA,+BAEC,OAAA,KAAA,WAAA,WACA,yBAAA,KAAA,MAAA,SAED,UAAAC,EAAA,6BAGA,QAAA,cACA,WAAA,IACA,KAAA,GAEF,GAED,QAAA,0BAEE,GAAA,CAAA,KAAA,QAAA,gDAEC,YAAA,MAAA,UAAAC,CAAA,eAED,CAEA,GAAA,KAAA,WAAA,UAAA,KAAA,QAAA,uHAIA,0BAKD,kBAAA,CACC,KAAA,0BAIA,KAAA,iBAAA,iBAAA,OACC,CACC,gBAAA,KAAA,WAAA,KACA,QAAA,KAAA,QACA,UAAA,KAAA,kBAED,CACC,UAAA,IAAA,CACC,KAAA,MAAA,SAAA,EACA,KAAA,WAAA,EACD,CACD,EAEF,CACD,CACD,EAhKQC,EAAA,CAAA,MAAA,WAAA,YAwBCC,EAAA,CAAA,MAAA,yBAAA,KAQF,MAAA,eACA,OAAA,SACA,KAAA,qLAhDyB,MAAA,QAAAC,EAAA,WAAA,KAAA,oKAFhC,WAAAC,EAAA,WAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,WAAAE,KAea,eAAAC,EAAA,IAAA,SAAA,OACVC,EAAA,MAAAP,EAAA,qBAECQ,IAAAC,EAAA,MAAAC,EAAA,MAEE,KAAA,4CAEA,YAAA,gCACA,YAAA,4EAvBN,WAAAP,EAAA,cAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,cAAAE,sDA+BK,KAAA,SACC,SAAAF,EAAA,0CAED,YAAA,0BACC,QAAAQ,EAAA,kBAnCN,WAAAR,EAAA,0BAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,0BAAAE,yDAwCIE,EAAA,MAAAN,EAAA,MAEE,KAAA,WACA,MAAA,qBA3CN,WAAAE,EAAA,iBAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,iBAAAE,4DAAA,QAAAC,EAAA,IAAA,CA+CMC,EAAA,IAAAK,EAAA,MAKE,KAAA,cACA,MAAA,2CAOF,UAAAC,GAAAjB,EAAAO,EAAA,mBAAA,YAAAP,EAAA,mBAAA,YAAAiB,EAAA,QAAAV,EAAA"}