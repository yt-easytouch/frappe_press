{"version":3,"file":"SiteUpdate-D-Y3BjZb.js","sources":["../../../../dashboard/src2/pages/SiteUpdate.vue"],"sourcesContent":["<template>\n\t<div class=\"p-5\">\n\t\t<Button :route=\"{ name: 'Site Detail Updates' }\">\n\t\t\t<template #prefix>\n\t\t\t\t<i-lucide-arrow-left class=\"inline-block h-4 w-4\" />\n\t\t\t</template>\n\t\t\tAll Updates\n\t\t</Button>\n\n\t\t<div class=\"mt-3\">\n\t\t\t<div class=\"flex w-full items-center\">\n\t\t\t\t<h2 class=\"text-lg font-medium text-gray-900\">\n\t\t\t\t\tUpdate Site {{ siteUpdate.deploy_type }}\n\t\t\t\t</h2>\n\t\t\t\t<Badge class=\"ml-2\" :label=\"siteUpdate.status\" />\n\t\t\t\t<div class=\"ml-auto space-x-2\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\t@click=\"$resources.siteUpdate.reload()\"\n\t\t\t\t\t\t:loading=\"$resources.siteUpdate.loading\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t<i-lucide-refresh-ccw class=\"h-4 w-4\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Dropdown :options=\"dropdownOptions\">\n\t\t\t\t\t\t<template v-slot=\"{ open }\">\n\t\t\t\t\t\t\t<Button>\n\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t<i-lucide-more-horizontal class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Dropdown>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<div class=\"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">Creation</div>\n\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t{{ $format.date(siteUpdate.creation, 'lll') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">Creator</div>\n\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t{{ siteUpdate.owner }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">Duration</div>\n\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\tsiteUpdate.update_duration\n\t\t\t\t\t\t\t\t\t? this.format_seconds(siteUpdate.update_duration)\n\t\t\t\t\t\t\t\t\t: '-'\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">Start</div>\n\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t{{ $format.date(siteUpdate.update_start, 'lll') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">End</div>\n\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\tsiteUpdate.update_end\n\t\t\t\t\t\t\t\t\t? $format.date(siteUpdate.update_end, 'lll')\n\t\t\t\t\t\t\t\t\t: '-'\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<!-- Build Steps -->\n\t\t<div class=\"mt-8 space-y-4\">\n\t\t\t<JobStep v-for=\"step in steps\" :step=\"step\" :key=\"step.name\" />\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport JobStep from '../components/JobStep.vue';\nimport AlertAddressableError from '../components/AlertAddressableError.vue';\nimport AlertBanner from '../components/AlertBanner.vue';\n\nexport default {\n\tname: 'SiteUpdate',\n\tprops: ['id'],\n\tcomponents: {\n\t\tJobStep,\n\t\tAlertBanner,\n\t\tAlertAddressableError,\n\t},\n\tresources: {\n\t\tsiteUpdate() {\n\t\t\tif (!this.id) return;\n\t\t\treturn {\n\t\t\t\ttype: 'document',\n\t\t\t\tdoctype: 'Site Update',\n\t\t\t\tname: this.id,\n\t\t\t\tauto: true,\n\t\t\t\ttransform: (record) => {\n\t\t\t\t\trecord.steps = record.steps.map((step) => {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tname: step.name,\n\t\t\t\t\t\t\ttitle: `${step.stage} - ${step.title}`,\n\t\t\t\t\t\t\toutput: step.output || 'No Output',\n\t\t\t\t\t\t\tstatus: step.status,\n\t\t\t\t\t\t\tisOpen: false,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonSuccess: (data) => {\n\t\t\t\t\tif (data.status != 'Success') {\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis.$resources.siteUpdate.reload();\n\t\t\t\t\t\t}, 5000);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tcomputed: {\n\t\tsiteUpdate() {\n\t\t\treturn this.$resources.siteUpdate?.doc ?? {};\n\t\t},\n\t\tsteps() {\n\t\t\treturn this.$resources.siteUpdate?.doc?.steps || [];\n\t\t},\n\t\tdropdownOptions() {\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'View in Desk',\n\t\t\t\t\ticon: 'external-link',\n\t\t\t\t\tcondition: () => this.$team.doc?.is_desk_user,\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\twindow.open(\n\t\t\t\t\t\t\t`${window.location.protocol}//${window.location.host}/app/site-update/${this.id}`,\n\t\t\t\t\t\t\t'_blank',\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t].filter((option) => option.condition?.() ?? true);\n\t\t},\n\t},\n\tmethods: {\n\t\tformat_seconds(seconds) {\n\t\t\tif (seconds === null) {\n\t\t\t\treturn '-';\n\t\t\t}\n\t\t\tif (seconds < 60) {\n\t\t\t\treturn `${Math.ceil(seconds)}s`;\n\t\t\t}\n\t\t\tconst minutes = Math.floor(seconds / 60);\n\t\t\tconst remainingSeconds = Math.ceil(seconds % 60);\n\t\t\treturn `${minutes}m ${remainingSeconds}s`;\n\t\t},\n\t},\n};\n</script>\n"],"names":["_sfc_main","JobStep","AlertAddressableError","record","step","data","_b","_a","seconds","minutes","remainingSeconds","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_openBlock","_createElementBlock","_withCtx","_cache","_createTextVNode","_createElementVNode","_toDisplayString","$options","$event","_ctx","_Fragment","_renderList"],"mappings":"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"}