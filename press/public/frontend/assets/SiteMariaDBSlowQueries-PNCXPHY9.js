import{_ as b}from"./Card-BCzTSeNK.js";import{x as v,q as a,o as s,A as n,ae as x,w as _,u as o,h as Q,X as T,Y as $,j as k}from"./main-Dpl-JOF2.js";import{_ as f}from"./Report-BW6SUxnb.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6c7c41a7-265c-4113-be15-b18cc730f24b",e._sentryDebugIdIdentifier="sentry-dbid-6c7c41a7-265c-4113-be15-b18cc730f24b")}catch(i){}})();{var r=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};r._sentryModuleMetadata=r._sentryModuleMetadata||{},r._sentryModuleMetadata[new Error().stack]=Object.assign({},r._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const D={name:"SiteMariaDBSlowQueries",props:["site"],components:{Report:f},data(){return{filters:[{name:"pattern",label:"Search:",type:"text",value:this.pattern},{name:"start",label:"From:",type:"datetime-local",value:""},{name:"end",label:"To:",type:"datetime-local",value:""}],max_lines:20}},watch:{pattern(){this.reset()},startTime(){this.reset()},endTime(){this.reset()}},resources:{slowQueries(){var e;return{url:"press.api.analytics.mariadb_slow_queries",params:{site:(e=this.site)==null?void 0:e.name,start:this.startTime||this.today,end:this.endTime||this.today,pattern:this.pattern,max_lines:this.max_lines},auto:!0,pageLength:10,keepData:!0,initialData:[]}},getPlan(){var e;return{url:"press.api.site.current_plan",params:{name:(e=this.site)==null?void 0:e.name},auto:!0}}},methods:{reset(){this.$resources.slowQueries.reset()}},computed:{startTime(){return this.filters[1].value},endTime(){return this.filters[2].value},pattern(){return this.filters[0].value},formatSlowQueries(){let e=[];return this.$resources.slowQueries.data.forEach(t=>{let l=[{name:"Timestamp",value:this.formatDate(t.timestamp,"TIME_24_WITH_SHORT_OFFSET"),class:"w-2/12"},{name:"Query",value:t.query,class:"w-7/12"},{name:"Duration",value:t.duration,class:"w-1/12"},{name:"Examined",value:t.rows_examined,class:"w-1/12"},{name:"Sent",value:t.sent,class:"w-1/12"}];e.push(l)}),e}}},S={key:0,class:"flex items-center justify-center"},B={key:1},E={key:0,class:"px-2 py-2 text-base text-gray-600"},I={key:1,class:"py-2 text-base text-gray-600"},M={key:2,class:"flex justify-center"};function R(e,t,i,l,u,w){var m,c,p;const d=x,y=f,g=T,h=b;return(m=e.$resources.getPlan)!=null&&m.loading?(s(),a("div",S,[n(d)])):(p=(c=e.$resources.getPlan)==null?void 0:c.data)!=null&&p.monitor_access?(s(),a("div",B,[n(h,null,{default:_(()=>[n(y,{filters:u.filters,columns:[{label:"Timestamp",name:"timestamp",class:"w-2/12"},{label:"Query",name:"query",class:"w-7/12"},{label:"Duration",name:"duration",class:"w-1/12"},{label:"Rows Examined",name:"examined",class:"w-1/12"},{label:"Rows Sent",name:"sent",class:"w-1/12"}],data:w.formatSlowQueries,title:"MariaDB Slow Queries Report"},null,8,["filters","data"]),e.$resources.slowQueries.loading&&e.$resources.slowQueries.data.length==0?(s(),a("div",E,[n(d)])):o("",!0),!e.$resources.slowQueries.loading&&e.$resources.slowQueries.data.length==0?(s(),a("div",I," No data ")):o("",!0),e.$resources.slowQueries.data&&e.$resources.slowQueries.data.length?(s(),Q(g,{key:2,loading:e.$resources.slowQueries.loading,loadingText:"Loading...",onClick:t[0]||(t[0]=N=>u.max_lines+=20)},{default:_(()=>t[1]||(t[1]=[$(" Load more ")])),_:1},8,["loading"])):o("",!0)]),_:1})])):(s(),a("div",M,t[2]||(t[2]=[k("span",{class:"mt-16 text-base text-gray-700"}," Your plan doesn't support this feature. Please upgrade your plan. ",-1)])))}const C=v(D,[["render",R]]);export{C as default};
//# sourceMappingURL=SiteMariaDBSlowQueries-PNCXPHY9.js.map
