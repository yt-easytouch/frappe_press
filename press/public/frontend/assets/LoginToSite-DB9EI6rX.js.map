{"version":3,"file":"LoginToSite-DB9EI6rX.js","sources":["../../../../dashboard/src2/pages/saas/LoginToSite.vue"],"sourcesContent":["<template>\n\t<div\n\t\tclass=\"flex h-screen w-screen items-center justify-center\"\n\t\tv-if=\"$resources.saasProduct.loading || $resources.siteRequest.loading\"\n\t>\n\t\t<Spinner class=\"mr-2 w-4\" />\n\t\t<p class=\"text-gray-800\">Loading</p>\n\t</div>\n\t<div class=\"flex h-screen overflow-hidden sm:bg-gray-50\" v-else>\n\t\t<div class=\"w-full overflow-auto\">\n\t\t\t<LoginBox\n\t\t\t\tv-if=\"$resources?.siteRequest?.doc?.status === 'Site Created'\"\n\t\t\t\ttitle=\"Site created successfully\"\n\t\t\t\t:subtitle=\"`Your trial site is ready at\n\t\t\t\t\t${$resources?.siteRequest?.doc?.domain || $resources?.siteRequest?.doc?.site}`\"\n\t\t\t>\n\t\t\t\t<template v-slot:logo v-if=\"saasProduct\">\n\t\t\t\t\t<div class=\"mx-auto flex items-center space-x-2\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclass=\"inline-block h-7 w-7 rounded-sm\"\n\t\t\t\t\t\t\t:src=\"saasProduct?.logo\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"select-none text-xl font-semibold tracking-tight text-gray-900\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ saasProduct?.title }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"mb-4 mt-16 flex flex-col items-center justify-center space-y-4\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\tclass=\"w-2/5\"\n\t\t\t\t\t\t\ticon-right=\"external-link\"\n\t\t\t\t\t\t\t@click=\"loginToSite\"\n\t\t\t\t\t\t\t:loading=\"this.$resources?.siteRequest?.getLoginSid.loading\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tLog In\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<ErrorMessage\n\t\t\t\t\tclass=\"w-full text-center\"\n\t\t\t\t\t:message=\"this.$resources?.siteRequest?.getLoginSid.error\"\n\t\t\t\t/>\n\t\t\t\t<template v-slot:footer>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"mt-2 flex w-full items-center justify-center text-sm text-gray-600\"\n\t\t\t\t\t>\n\t\t\t\t\t\tPowered by Easytouch Cloud\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</LoginBox>\n\t\t\t<LoginBox\n\t\t\t\tv-else-if=\"this.$resources?.siteRequest?.doc?.status === 'Error'\"\n\t\t\t\ttitle=\"Site creation failed\"\n\t\t\t\t:subtitle=\"\n\t\t\t\t\tthis.$resources?.siteRequest?.doc?.domain ||\n\t\t\t\t\tthis.$resources?.siteRequest?.doc?.site\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\t<template v-slot:logo v-if=\"saasProduct\">\n\t\t\t\t\t<div class=\"mx-auto flex items-center space-x-2\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclass=\"inline-block h-7 w-7 rounded-sm\"\n\t\t\t\t\t\t\t:src=\"saasProduct?.logo\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"select-none text-xl font-semibold tracking-tight text-gray-900\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ saasProduct?.title }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-slot:default>\n\t\t\t\t\t<div class=\"flex h-40 flex-col items-center justify-center px-10\">\n\t\t\t\t\t\t<div class=\"text-center text-base leading-5 text-gray-800\">\n\t\t\t\t\t\t\t<p>It looks like something went wrong</p>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\tContact\n\t\t\t\t\t\t\t\t<a href=\"mailto:support@frappe.io\" class=\"underline\"\n\t\t\t\t\t\t\t\t\t>support@frappe.io</a\n\t\t\t\t\t\t\t\t><br />\n\t\t\t\t\t\t\t\tto resolve the issue\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-slot:footer>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"mt-2 flex w-full items-center justify-center text-sm text-gray-600\"\n\t\t\t\t\t>\n\t\t\t\t\t\tPowered by Easytouch Cloud\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</LoginBox>\n\t\t\t<LoginBox\n\t\t\t\tv-else\n\t\t\t\ttitle=\"Creating your site\"\n\t\t\t\t:subtitle=\"\n\t\t\t\t\tthis.$resources?.siteRequest?.doc?.domain ||\n\t\t\t\t\tthis.$resources?.siteRequest?.doc?.site\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\t<template v-slot:logo v-if=\"saasProduct\">\n\t\t\t\t\t<div class=\"mx-auto flex items-center space-x-2\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclass=\"inline-block h-7 w-7 rounded-sm\"\n\t\t\t\t\t\t\t:src=\"saasProduct?.logo\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"select-none text-xl font-semibold tracking-tight text-gray-900\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ saasProduct?.title }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-slot:default>\n\t\t\t\t\t<div class=\"flex h-40 items-center justify-center\">\n\t\t\t\t\t\t<Progress\n\t\t\t\t\t\t\tclass=\"px-10\"\n\t\t\t\t\t\t\tsize=\"md\"\n\t\t\t\t\t\t\t:value=\"progressCount\"\n\t\t\t\t\t\t\t:label=\"currentBuildStep\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-slot:footer>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"mt-2 flex w-full items-center justify-center text-sm text-gray-600\"\n\t\t\t\t\t>\n\t\t\t\t\t\tPowered by Easytouch Cloud\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</LoginBox>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport LoginBox from '../../components/auth/LoginBox.vue';\nimport { Progress } from 'frappe-ui';\n\nexport default {\n\tname: 'SignupLoginToSite',\n\tprops: ['productId'],\n\tcomponents: {\n\t\tLoginBox,\n\t\tProgress,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tproduct_trial_request: this.$route.query.product_trial_request,\n\t\t\tprogressCount: 0,\n\t\t\tcurrentBuildStep: 'Preparing for build',\n\t\t};\n\t},\n\tresources: {\n\t\tsaasProduct() {\n\t\t\treturn {\n\t\t\t\ttype: 'document',\n\t\t\t\tdoctype: 'Product Trial',\n\t\t\t\tname: this.productId,\n\t\t\t\tauto: true,\n\t\t\t};\n\t\t},\n\t\tsiteRequest() {\n\t\t\treturn {\n\t\t\t\ttype: 'document',\n\t\t\t\tdoctype: 'Product Trial Request',\n\t\t\t\tname: this.product_trial_request,\n\t\t\t\trealtime: true,\n\t\t\t\tauto: true,\n\t\t\t\tonSuccess(doc) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tdoc.status == 'Wait for Site' ||\n\t\t\t\t\t\tdoc.status == 'Prefilling Setup Wizard'\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.$resources.siteRequest.getProgress.reload();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\twhitelistedMethods: {\n\t\t\t\t\tgetProgress: {\n\t\t\t\t\t\tmethod: 'get_progress',\n\t\t\t\t\t\tmakeParams() {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tcurrent_progress:\n\t\t\t\t\t\t\t\t\tthis.$resources.siteRequest.getProgress.data?.progress || 0,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonSuccess: (data) => {\n\t\t\t\t\t\t\tconst currentStepMap = {\n\t\t\t\t\t\t\t\t'Wait for Site': 'Creating your site',\n\t\t\t\t\t\t\t\t'New Site': 'Creating your site',\n\t\t\t\t\t\t\t\t'Prefilling Setup Wizard': 'Setting up your site',\n\t\t\t\t\t\t\t\t'Update Site Configuration': 'Setting up your site',\n\t\t\t\t\t\t\t\t'Enable Scheduler': 'Setting up your site',\n\t\t\t\t\t\t\t\t'Bench Setup NGINX': 'Setting up your site',\n\t\t\t\t\t\t\t\t'Reload NGINX': 'Setting up your site',\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\tthis.currentBuildStep =\n\t\t\t\t\t\t\t\tcurrentStepMap[data.current_step] ||\n\t\t\t\t\t\t\t\tdata.current_step ||\n\t\t\t\t\t\t\t\tthis.currentBuildStep;\n\t\t\t\t\t\t\tthis.progressCount += 1;\n\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t!(\n\t\t\t\t\t\t\t\t\tthis.$resources.siteRequest.getProgress.error &&\n\t\t\t\t\t\t\t\t\tthis.progressCount <= 10\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tthis.progressCount = Math.round(data.progress * 10) / 10;\n\t\t\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\t\t\tthis.$resources.siteRequest.getProgress.reload();\n\t\t\t\t\t\t\t\t}, 2000);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\tgetLoginSid: {\n\t\t\t\t\t\tmethod: 'get_login_sid',\n\t\t\t\t\t\tonSuccess(loginURL) {\n\t\t\t\t\t\t\twindow.open(loginURL, '_blank');\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tcomputed: {\n\t\tsaasProduct() {\n\t\t\treturn this.$resources.saasProduct.doc;\n\t\t},\n\t},\n\tmethods: {\n\t\tloginToSite() {\n\t\t\tthis.$resources.siteRequest.getLoginSid.submit();\n\t\t},\n\t},\n};\n</script>\n"],"names":["_sfc_main","LoginBox","Progress","doc","data","currentStepMap","loginURL","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_c","_b","_a","_ctx","_f","_e","_d","_i","_h","_g","_createSlots","_withCtx","$options","_createTextVNode","_toDisplayString","_l","_k","_j","_o","_n","_m","_r","_q","_p","_u","_t","_s","_x","_w","_v","$data"],"mappings":"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"}