var k=(e,t,o)=>new Promise((y,r)=>{var l=a=>{try{_(o.next(a))}catch(c){r(c)}},g=a=>{try{_(o.throw(a))}catch(c){r(c)}},_=a=>a.done?y(a.value):Promise.resolve(a.value).then(l,g);_((o=o.apply(e,t)).next())});import{_ as I}from"./Card-BCzTSeNK.js";import{_ as w}from"./InvoiceUsageTable-BfGDi_RQ.js";import{x as S,h as m,u,o as i,w as p,A as b,X as $,Y as x,q as d,j as s,F as B,v as N,t as f,af as L,a5 as U,a8 as A}from"./main-Dpl-JOF2.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3bfd19c5-0195-4b3b-9ccd-2ce0be7ab016",e._sentryDebugIdIdentifier="sentry-dbid-3bfd19c5-0195-4b3b-9ccd-2ce0be7ab016")}catch(o){}})();{var v=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};v._sentryModuleMetadata=v._sentryModuleMetadata||{},v._sentryModuleMetadata[new Error().stack]=Object.assign({},v._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const V={name:"InvoiceUsageCard",props:["invoice"],components:{InvoiceUsageTable:w},data(){return{doc:null}},computed:{title(){let e=this.doc;if(!e)return"";if(!e.period_start||!e.period_end)return`Invoice Details for ${this.invoice}`;let t=this.$date(e.period_start),o=this.$date(e.period_end),y=t.toLocaleString({month:"long",day:"numeric"}),r=o.toLocaleString({month:"short",day:"numeric"});return`Invoice for ${y} - ${r} ${o.year}`}}};function E(e,t,o,y,r,l){const g=$,_=w,a=I;return o.invoice?(i(),m(a,{key:0,title:l.title},{"actions-left":p(()=>[b(g,{route:"/billing/invoices"},{default:p(()=>t[1]||(t[1]=[x(" ← Back ")])),_:1})]),default:p(()=>[b(_,{invoice:o.invoice,onDoc:t[0]||(t[0]=c=>r.doc=c)},null,8,["invoice"])]),_:1},8,["title"])):u("",!0)}const C=S(V,[["render",E]]),T={name:"AccountBillingPayments",props:["invoiceName"],components:{InvoiceUsageCard:C},data(){return{invoiceStatus:"",selectItems:[{label:"All Invoices",value:""},{label:"Unpaid Invoices",value:"Unpaid"},{label:"Paid Invoices",value:"Paid"}]}},created(){this.$route.query.invoiceStatus&&(this.invoiceStatus=this.$route.query.invoiceStatus)},resources:{pastInvoices:"press.api.billing.invoices_and_payments"},computed:{filteredInvoices(){return this.invoiceStatus===""?this.$resources.pastInvoices.data:this.$resources.pastInvoices.data.filter(e=>e.status===this.invoiceStatus)},subtitle(){return this.$resources.pastInvoices.loading||this.filteredInvoices.length>0?`History of your ${this.invoiceStatus} invoice payments`:`No ${this.invoiceStatus} invoices have been generated yet`}},methods:{refreshLink(e){return k(this,null,function*(){let t=yield this.$call("press.api.billing.refresh_invoice_link",{invoice:e});t&&window.open(t,"_blank")})},payNow(e){e.stripe_link_expired?this.refreshLink(e.name):window.open(e.stripe_invoice_url,"_blank")}}},j={key:0,class:"max-h-96 divide-y"},q={class:"mt-2 md:hidden"},F={class:"hidden md:inline"},M={key:1},H={key:2},K={class:"hidden md:inline"},O={key:0,class:"hidden md:inline"},X={key:1},Y={class:"hidden md:inline"},z={key:0},J={key:1},Q={class:"flex items-center justify-end space-x-2"};function R(e,t,o,y,r,l){const g=A,_=L,a=U,c=$,D=I,P=C;return o.invoiceName?(i(),m(P,{key:1,invoice:o.invoiceName},null,8,["invoice"])):(i(),m(D,{key:0,title:"Past Invoices",subtitle:l.subtitle},{actions:p(()=>{var h;return[(h=e.$resources.pastInvoices.data)!=null&&h.length?(i(),m(g,{key:0,type:"select",options:r.selectItems,modelValue:r.invoiceStatus,"onUpdate:modelValue":t[0]||(t[0]=n=>r.invoiceStatus=n)},null,8,["options","modelValue"])):u("",!0)]}),default:p(()=>{var h;return[(h=l.filteredInvoices)!=null&&h.length?(i(),d("div",j,[t[3]||(t[3]=s("div",{class:"grid grid-cols-3 items-center gap-x-8 py-4 text-base text-gray-600 md:grid-cols-7"},[s("span",null,"Date"),s("span",{class:"hidden md:inline"},"Description"),s("span",{class:"hidden md:inline"},"Amount"),s("span",{class:"hidden md:inline"},"Amount Due"),s("span",null,"Status"),s("span",{class:"hidden md:inline"},"Payment Date"),s("span",null,"Download")],-1)),(i(!0),d(B,null,N(l.filteredInvoices,n=>(i(),d("div",{key:n.name,class:"grid grid-cols-3 items-center gap-x-8 py-4 text-base text-gray-900 md:grid-cols-7"},[s("div",null,[s("div",null,f(e.$date(n.date).toLocaleString({month:"long",day:"numeric",year:"numeric"})),1),s("div",q,f(n.formatted_total),1)]),s("span",F,[n.type=="Subscription"?(i(),m(_,{key:0,to:"/billing/"+n.name+"/invoices"},{default:p(()=>[x(" Invoice for "+f(e.$date(n.period_end).toLocaleString({month:"long",year:"numeric"})),1)]),_:2},1032,["to"])):u("",!0),n.type==="Prepaid Credits"?(i(),d("span",M," Prepaid Credits ")):u("",!0),n.type==="Transferred Credits"?(i(),d("span",H," Transferred Credits ")):u("",!0)]),s("span",K,f(n.formatted_total),1),n.formatted_amount_due?(i(),d("span",O,f(n.formatted_amount_due),1)):(i(),d("span",X,"-")),s("span",null,[b(a,{label:n.status},null,8,["label"])]),s("span",Y,[n.status=="Paid"&&n.type!=="Prepaid Credits"&&n.payment_date?(i(),d("span",z,f(e.$date(n.payment_date).toLocaleString({month:"long",day:"numeric",year:"numeric"})),1)):(i(),d("span",J,"-"))]),s("div",Q,[n.invoice_pdf?(i(),m(c,{key:0,"icon-left":"download",class:"shrink-0",link:n.invoice_pdf},{default:p(()=>t[1]||(t[1]=[s("span",{class:"text-sm"},"Download Invoice",-1)])),_:2},1032,["link"])):u("",!0),n.status!="Paid"&&n.stripe_invoice_url?(i(),m(c,{key:1,"icon-left":"external-link",class:"shrink-0",onClick:W=>l.payNow(n)},{default:p(()=>t[2]||(t[2]=[s("span",{class:"text-sm"},"Pay Now",-1)])),_:2},1032,["onClick"])):u("",!0)])]))),128))])):u("",!0)]}),_:1},8,["subtitle"]))}const ne=S(T,[["render",R]]);export{ne as default};
//# sourceMappingURL=AccountBillingPayments-JhifCCBq.js.map
