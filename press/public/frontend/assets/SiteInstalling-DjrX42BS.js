var f=(e,t,i)=>new Promise((u,a)=>{var d=s=>{try{o(i.next(s))}catch(n){a(n)}},l=s=>{try{o(i.throw(s))}catch(n){a(n)}},o=s=>s.done?u(s.value):Promise.resolve(s.value).then(d,l);o((i=i.apply(e,t)).next())});import{_ as g,a as b}from"./SectionCard-DhC64oIK.js";import{x as w,h as y,u as S,o as c,w as p,A as _,q as m,F as k,v as x,j as h,B as I,n as B,t as J}from"./main-Dpl-JOF2.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="2bdb82af-f892-44bf-8477-239b7472d162",e._sentryDebugIdIdentifier="sentry-dbid-2bdb82af-f892-44bf-8477-239b7472d162")}catch(i){}})();{var r=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};r._sentryModuleMetadata=r._sentryModuleMetadata||{},r._sentryModuleMetadata[new Error().stack]=Object.assign({},r._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const $={name:"SiteActivity",props:["site"],data(){return{iconMap:{Running:"loader",Success:"check",Pending:"minus"},installingJob:null}},mounted(){this.setupSiteInstall(),this.fetchPendingJobs()},methods:{setupSiteInstall(){this.$socket.on("agent_job_update",e=>{e.site===this.site.name&&(e.name==="New Site"||e.name==="New Site from Backup")&&(this.installingJob=e,e.status==="Success"&&this.$route.path.startsWith(`/sites/${this.site.name}`)&&(this.installingJob=null,this.$router.replace(`/sites/${this.site.name}`),window.location.reload()))})},fetchPendingJobs(){return f(this,null,function*(){(yield this.$call("press.api.site.running_jobs",{name:this.site.name})).forEach(t=>{(t.name==="New Site"||t.name==="New Site from Backup")&&(this.installingJob=t)})})}}},N={class:"h-4 w-4 text-gray-800"},v={class:"ml-2"};function D(e,t,i,u,a,d){const l=I,o=g,s=b;return a.installingJob?(c(),y(s,{key:0,title:"Your site is being installed...",description:"Please wait while we set up your site for use"},{default:p(()=>[_(o,null,{default:p(()=>[(c(!0),m(k,null,x(a.installingJob.steps,n=>(c(),m("div",{class:"flex items-center px-6 py-2 text-base",key:n.name},[h("div",N,[_(l,{class:B(["h-4 w-4",{spin:n.status==="Running"}]),name:a.iconMap[n.status]},null,8,["class","name"])]),h("span",v,J(n.name),1)]))),128))]),_:1})]),_:1})):S("",!0)}const C=w($,[["render",D]]);export{C as default};
//# sourceMappingURL=SiteInstalling-DjrX42BS.js.map
