import{_ as q}from"./Card-BCzTSeNK.js";import{x as v,q as r,o as a,A as o,ae as T,w as _,u,h as D,X as L,Y as k,j as $}from"./main-Dpl-JOF2.js";import{_ as g}from"./Report-BW6SUxnb.js";import{D as f}from"./datetime-PXpIdgFA.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},s=new Error().stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="192ea1f6-171c-40bc-932a-9815c536711a",e._sentryDebugIdIdentifier="sentry-dbid-192ea1f6-171c-40bc-932a-9815c536711a")}catch(t){}})();{var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};n._sentryModuleMetadata=n._sentryModuleMetadata||{},n._sentryModuleMetadata[new Error().stack]=Object.assign({},n._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const P={name:"SiteRequestLogs",props:["site"],components:{Report:g},data(){return{date:null,sort:"CPU Time (Descending)",start:0,sortFilter:{name:"sort",options:["Time (Ascending)","Time (Descending)","CPU Time (Descending)"],type:"select",value:"CPU Time (Descending)"},dateFilter:{name:"date",type:"date",value:null}}},watch:{sort(e){this.reset()}},resources:{requestLogs(){var e;return{url:"press.api.analytics.request_logs",params:{name:(e=this.site)==null?void 0:e.name,timezone:f.local().zoneName,sort:this.sortFilter.value,date:this.dateFilter.value||this.today,start:this.start},auto:!!this.today,pageLength:10,keepData:!0,initialData:[]}},getPlan(){var e;return{url:"press.api.site.current_plan",params:{name:(e=this.site)==null?void 0:e.name},auto:!0}}},methods:{reset(){this.$resources.requestLogs.reset(),this.start=0}},computed:{today(){return f.local().toISODate()},formatData(){let e=this.$resources.requestLogs.data,s=[];return e.forEach(t=>{t.time=this.formatDate(t.timestamp,"TIME_24_WITH_SHORT_OFFSET"),t.method=t.request.method,t.path=t.request.path,t.status=t.request.status_code,t.cpu_time=this.$formatCPUTime(t.duration);let d=[{name:"Time",value:t.time,class:"w-2/12"},{name:"Method",value:t.method,class:"w-1/12"},{name:"Path",value:t.path,class:"w-5/12 break-all pr-2"},{name:"Status",value:t.status,class:"w-2/12"},{name:"CPU Time",value:t.cpu_time,class:"w-2/12"}];s.push(d)}),s}}},C={key:0,class:"flex items-center justify-center"},x={key:1},F={key:0,class:"px-2 py-2 text-base text-gray-600"},I={key:1,class:"py-2 text-base text-gray-600"},B={key:2,class:"flex justify-center"};function E(e,s,t,d,i,h){var c,m,p;const l=T,y=g,w=L,b=q;return(c=e.$resources.getPlan)!=null&&c.loading?(a(),r("div",C,[o(l)])):(p=(m=e.$resources.getPlan)==null?void 0:m.data)!=null&&p.monitor_access?(a(),r("div",x,[o(b,null,{default:_(()=>[o(y,{title:"Request Logs",columns:[{label:"Time",name:"time",class:"w-2/12"},{label:"Method",name:"method",class:"w-1/12"},{label:"Path",name:"path",class:"w-5/12"},{label:"Status Code",name:"status",class:"w-2/12"},{label:"CPU Time (seconds)",name:"cpu_time",class:"w-2/12"}],data:h.formatData,filters:[i.sortFilter,i.dateFilter]},null,8,["data","filters"]),e.$resources.requestLogs.loading&&e.$resources.requestLogs.data.length==0?(a(),r("div",F,[o(l)])):u("",!0),!e.$resources.requestLogs.loading&&e.$resources.requestLogs.data.length==0?(a(),r("div",I," No data ")):u("",!0),e.$resources.requestLogs.data&&e.$resources.requestLogs.data.length?(a(),D(w,{key:2,loading:e.$resources.requestLogs.loading,loadingText:"Loading...",onClick:s[0]||(s[0]=S=>i.start+=10)},{default:_(()=>s[1]||(s[1]=[k(" Load more ")])),_:1},8,["loading"])):u("",!0)]),_:1})])):(a(),r("div",B,s[2]||(s[2]=[$("span",{class:"mt-16 text-base text-gray-700"}," Your plan doesn't support this feature. Please upgrade your plan. ",-1)])))}const j=v(P,[["render",E]]);export{j as default};
//# sourceMappingURL=SiteRequestLogs-BHeGtHzu.js.map
