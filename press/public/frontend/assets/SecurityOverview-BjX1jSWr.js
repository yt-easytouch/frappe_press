import{_ as f}from"./Card-BCzTSeNK.js";import{_ as w}from"./ListItem-CkkFcC1t.js";import{x as v,r as $,h as d,o,w as n,j as y,q as _,F as x,v as k,A as a,a5 as S,Y as C,u as b}from"./main-Dpl-JOF2.js";import{C as L}from"./Card-ihLdqqkA.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},r=new Error().stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="7c56327d-7ad4-4e54-8dbf-faab2bcd1c73",e._sentryDebugIdIdentifier="sentry-dbid-7c56327d-7ad4-4e54-8dbf-faab2bcd1c73")}catch(i){}})();{var l=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};l._sentryModuleMetadata=l._sentryModuleMetadata||{},l._sentryModuleMetadata[new Error().stack]=Object.assign({},l._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const D={name:"SecurityUpdatesOverview",props:["server"],inject:["viewportWidth"],resources:{securityUpdates(){var e;return{type:"list",doctype:"Security Update",url:"press.api.security.fetch_security_updates",filters:{server:(e=this.server)==null?void 0:e.name},orderBy:"priority_level asc",pageLength:3,start:0,auto:!0}}},computed:{securityUpdates(){return this.$resources.securityUpdates}},methods:{getDescription(e){return`Version: ${e.version} | ${this.formatDate(e.datetime)}`},getColor(e){switch(e){case"High":return"red";case"Medium":return"orange";case"Low":return"green";default:return"gray"}},updateRoute(e){return`/security/${this.server.name}/security_update/${e}`}}},O={class:"divide-y"};function U(e,r,i,g,h,s){const c=S,p=w,u=$("router-link"),m=f;return o(),d(m,{class:"h-full max-h-96 min-h-full",title:"Security Updates",subtitle:"Pedning security updates"},{actions:n(()=>[a(u,{class:"text-base text-gray-700 hover:text-gray-800",to:`/security/${i.server.name}/security_update`},{default:n(()=>r[0]||(r[0]=[C(" View details → ")])),_:1},8,["to"])]),default:n(()=>[y("div",O,[(o(!0),_(x,null,k(s.securityUpdates.data,t=>(o(),d(u,{class:"block cursor-pointer rounded-md px-2.5",key:t.name,to:s.updateRoute(t.name)},{default:n(()=>[a(p,{title:`Package: ${t.package}`,description:s.getDescription(t)},{actions:n(()=>[a(c,{label:t.priority,theme:s.getColor(t.priority)},null,8,["label","theme"])]),_:2},1032,["title","description"])]),_:2},1032,["to"]))),128))])]),_:1})}const B=v(D,[["render",U]]),I={name:"FirewallOverview",props:["server"]};function V(e,r,i,g,h,s){const c=f;return o(),d(c,{class:"min-h-full h-full max-h-96",title:"Firewall"},{default:n(()=>r[0]||(r[0]=[y("div",{class:"divide-y"},null,-1)])),_:1})}const F=v(I,[["render",V]]),H={name:"SSHSessionsOverview",props:["server"],components:{Card:L},resources:{sshLogs(){var e;return{url:"press.api.security.fetch_ssh_session_logs",params:{server:(e=this.server)==null?void 0:e.name},auto:!0}}},computed:{sshLogs(){return this.$resources.sshLogs.data}},methods:{getTitle(e){return`SSH Session Id: ${e.session_id}`},getDescription(e){return`Created On: ${this.formatDate(e.created)} <br> Size: ${e.size} Kb`},updateRoute(e){return`/security/${this.server.name}/ssh_session_logs/${e}`},getLabel(e){return`User: ${e}`},getColor(e){return e==="root"?"red":"green"}}},j={class:"divide-y"};function E(e,r,i,g,h,s){const c=S,p=w,u=$("router-link"),m=f;return o(),d(m,{class:"h-full max-h-96 min-h-full",title:"SSH Activity Log"},{actions:n(()=>[a(u,{class:"text-base text-gray-700 hover:text-gray-800",to:`/security/${i.server.name}/ssh_session_logs`},{default:n(()=>r[0]||(r[0]=[C(" View details → ")])),_:1},8,["to"])]),default:n(()=>[y("div",j,[(o(!0),_(x,null,k(e.$resources.sshLogs.data,t=>(o(),d(u,{class:"block cursor-pointer rounded-md px-2.5",key:t.name,to:s.updateRoute(t.name)},{default:n(()=>[a(p,{title:s.getTitle(t),description:s.getDescription(t)},{actions:n(()=>[a(c,{label:s.getLabel(t.user),theme:s.getColor(t.user)},null,8,["label","theme"])]),_:2},1032,["title","description"])]),_:2},1032,["to"]))),128))])]),_:1})}const N=v(H,[["render",E]]),R={key:0,class:"space-y-5"},A={key:0,class:"grid grid-cols-1 gap-5 sm:grid-cols-2"},K={__name:"SecurityOverview",props:{server:Object},setup(e){return(r,i)=>e.server?(o(),_("div",R,[e.server?(o(),_("div",A,[a(B,{server:e.server},null,8,["server"]),a(N,{server:e.server},null,8,["server"]),a(F,{server:e.server},null,8,["server"])])):b("",!0)])):b("",!0)}};export{K as default};
//# sourceMappingURL=SecurityOverview-BjX1jSWr.js.map
