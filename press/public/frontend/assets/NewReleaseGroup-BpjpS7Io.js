import{x as N,ao as j,r as w,q as l,o,j as r,A as c,w as x,as as G,a9 as F,u as d,h as k,F as m,v as V,n as B,t as h,a5 as O,a8 as H,Y as L,X as M,a2 as C,ad as b}from"./main-Dpl-JOF2.js";import{_ as P}from"./Breadcrumbs-yx7M4N4X.js";import{S as z}from"./Summary-B8iBDrxJ.js";import{_ as U}from"./Header-BNMc-OFG.js";(function(){try{var n=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="bb76f3bb-c3af-41eb-8d34-11c589c46f95",n._sentryDebugIdIdentifier="sentry-dbid-bb76f3bb-c3af-41eb-8d34-11c589c46f95")}catch(i){}})();{var p=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};p._sentryModuleMetadata=p._sentryModuleMetadata||{},p._sentryModuleMetadata[new Error().stack]=Object.assign({},p._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const Y={name:"NewReleaseGroup",components:{Summary:z,Header:U,ObjectList:j},props:["server"],data(){return{benchTitle:"",benchVersion:"",benchRegion:"",agreedToRegionConsent:!1}},resources:{preInstalledApps(){return{url:"press.api.bench.get_default_apps",initialData:{},auto:!0}},options(){return{url:"press.api.bench.options",initialData:{versions:[],clusters:[]},auto:!0}},createBench(){return{url:"press.api.bench.new",validate(){if(!this.benchTitle)throw new b("Bench Group Title cannot be blank");if(!this.benchVersion)throw new b("Select a version to create bench");if(!this.agreedToRegionConsent)throw new b("Please agree to the above consent to create bench")},onSuccess(n){this.$router.push({name:"Release Group Detail Apps",params:{name:n}})}}}},methods:{getAppsToInstall(){let n=[this.options.versions.find(e=>e.name===this.benchVersion).apps.find(e=>e.name==="frappe")].map(e=>({name:e.name,source:e.source.name}));return n.push(...this.preInstalledApps[this.benchVersion].map(e=>({name:e.app,source:e.source}))),n}},computed:{options(){return this.$resources.options.data},preInstalledApps(){return this.$resources.preInstalledApps.data},preInstalledAppsList(){return{data:()=>this.preInstalledApps,columns:[{label:"Default Apps",fieldname:"app_title",type:"Component",component:({row:n})=>C("a",{class:"flex items-center text-sm",href:`${n.route}`,target:"_blank"},[C("span",{class:"ml-2"},n.app_title)])}]}},summaryOptions(){return[{label:"Framework Version",value:this.benchVersion},{label:"Preinstalled Apps",value:this.preInstalledApps[this.benchVersion].map(n=>n.title).join(", "),condition:()=>this.preInstalledApps[this.benchVersion].length},{label:"Region",value:this.benchRegion,condition:()=>!this.server},{label:"Server",value:this.server,condition:()=>this.server},{label:"Title",value:this.benchTitle}]}}},q={class:"sticky top-0 z-10 shrink-0"},K={key:0,class:"mx-auto mt-60 w-fit rounded border border-dashed px-12 py-8 text-center text-gray-600"},X={key:1,class:"mx-auto max-w-2xl px-5"},J={key:0,class:"space-y-12 pb-[50vh] pt-12"},Q={class:"mt-2"},W={class:"grid grid-cols-2 gap-3 sm:grid-cols-3"},Z=["onClick"],$={class:"font-medium"},ee={class:"ml-1 text-gray-600"},se={key:0,class:"flex flex-col"},ne={class:"mt-2 w-full space-y-2"},te={class:"grid grid-cols-2 gap-3"},re=["onClick"],oe={class:"flex w-full items-center justify-between"},ae={class:"flex w-full items-center space-x-2"},le=["src"],ie={class:"text-sm font-medium"},ce={key:1,class:"flex flex-col"},ue={class:"mt-2"},de={key:3,class:"flex flex-col space-y-4"};function pe(n,e,i,me,s,u){var f,y,v;const R=P,T=w("Header"),A=G,g=F,I=O,_=H,S=w("Summary"),D=M;return o(),l(m,null,[r("div",q,[c(T,null,{default:x(()=>[c(R,{items:i.server?[{label:"Servers",route:"/servers"},{label:i.server,route:`/servers/${i.server}`},{label:"New Bench Group",route:"/groups/new"}]:[{label:"Bench Groups",route:"/groups"},{label:"New Bench Group",route:"/groups/new"}]},null,8,["items"])]),_:1})]),!((f=n.$team.doc)!=null&&f.is_desk_user)&&!n.$session.hasBenchCreationAccess?(o(),l("div",K,[c(A,{class:"mx-auto mb-4 h-6 w-6 text-red-600"}),c(g,{message:"You aren't permitted to create new bench groups"})])):(o(),l("div",X,[u.options?(o(),l("div",J,[r("div",null,[e[3]||(e[3]=r("div",{class:"flex items-center justify-between"},[r("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Select Framework Version ")],-1)),r("div",Q,[r("div",W,[(o(!0),l(m,null,V(u.options.versions,t=>(o(),l("button",{key:t.name,class:B([s.benchVersion===t.name?"border-gray-900 ring-1 ring-gray-900 hover:bg-gray-100":"bg-white text-gray-900  hover:bg-gray-50","flex cursor-pointer items-center justify-between rounded border border-gray-400 p-3 text-sm focus:outline-none"]),onClick:a=>s.benchVersion=t.name},[r("span",$,h(t.name),1),r("span",ee,h(t.status),1)],10,Z))),128))])])]),(y=u.options)!=null&&y.clusters.length&&s.benchVersion&&!i.server?(o(),l("div",se,[e[4]||(e[4]=r("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Select Region ",-1)),r("div",ne,[r("div",te,[(o(!0),l(m,null,V((v=u.options)==null?void 0:v.clusters,t=>(o(),l("button",{key:t.name,onClick:a=>s.benchRegion=t.name,class:B([s.benchRegion===t.name?"border-gray-900 ring-1 ring-gray-900 hover:bg-gray-100":"border-gray-400 bg-white text-gray-900 ring-gray-200 hover:bg-gray-50","flex w-full items-center rounded border p-3 text-left text-base text-gray-900"])},[r("div",oe,[r("div",ae,[r("img",{src:t.image,class:"h-5 w-5"},null,8,le),r("span",ie,h(t.title),1)]),t.beta?(o(),k(I,{key:0,label:t.beta?"Beta":""},null,8,["label"])):d("",!0)])],10,re))),128))])])])):d("",!0),s.benchVersion&&(s.benchRegion||i.server)?(o(),l("div",ce,[e[5]||(e[5]=r("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Enter Bench Group Title ",-1)),r("div",ue,[c(_,{modelValue:s.benchTitle,"onUpdate:modelValue":e[0]||(e[0]=t=>s.benchTitle=t),type:"text"},null,8,["modelValue"])])])):d("",!0),s.benchVersion&&(s.benchRegion||i.server)&&s.benchTitle?(o(),k(S,{key:2,options:u.summaryOptions},null,8,["options"])):d("",!0),s.benchVersion&&(s.benchRegion||i.server)&&s.benchTitle?(o(),l("div",de,[c(_,{type:"checkbox",modelValue:s.agreedToRegionConsent,"onUpdate:modelValue":e[1]||(e[1]=t=>s.agreedToRegionConsent=t),label:"I agree that the laws of the region selected by me shall stand applicable to me and Easytouch."},null,8,["modelValue"]),c(g,{class:"my-2",message:n.$resources.createBench.error},null,8,["message"]),c(D,{variant:"solid",disabled:!s.agreedToRegionConsent,onClick:e[2]||(e[2]=t=>{n.$resources.createBench.submit({bench:{title:s.benchTitle,version:s.benchVersion,cluster:s.benchRegion,saas_app:null,apps:u.options.versions.find(a=>a.name===s.benchVersion).apps.filter(a=>a.source.auto_add_list===1||a.source.main_app===1).sort((a,E)=>a.name==="frappe"?-1:E.name==="frappe"?1:0).map(a=>({name:a.name,source:a.source.name})),server:i.server||null}})}),loading:n.$resources.createBench.loading},{default:x(()=>e[6]||(e[6]=[L(" Create Bench Group ")])),_:1},8,["disabled","loading"])])):d("",!0)])):d("",!0)]))],64)}const fe=N(Y,[["render",pe]]);export{fe as default};
//# sourceMappingURL=NewReleaseGroup-BpjpS7Io.js.map
