{"version":3,"mappings":"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gEAECG,GACCC,yBACAC,uGACAC,eACCxB,eACAyB,gBACAC,UAAYC,MAAK,KAChBC,0DAGEd,2DAECa,IACA,kDAGAA,IACAE,EAAAC,EAAA,2BAKDb,YACD,EAEF,CACD,CACD,EACD,CACD,GAECjB,sBACAkB,+CAECG,GACCC,sBACAC,uEACAC,eACCxB,gBACAyB,gBACAM,YACAL,UAAYC,MAAK,KAChBC,iDACCd,2CAECa,IACA,wCAGAA,IACAE,EAAAC,EAAA,4BAEDb,YACD,EACD,CACD,CACD,EACD,CACD,GAECjB,kMAQCqB,GACCC,uBACAC,kFACAC,eACCxB,gBACAyB,gBACAM,YACAL,UAAYC,MAAK,KAChBC,iDACCd,4CAECa,IACA,oFAGAA,IACAE,EAAAC,EAAA,6BAKDb,YACD,EACD,CACD,CACD,EACD,CACD,GAECjB,mCAECqB,GACCC,sBACAC,uEACAC,eACCxB,gBACAyB,gBACAM,YACAL,UAAYC,MAAK,KAChBC,iDACCd,wDAECa,IACA,mCAEDX,uCAED,EACD,CACD,CACD,EACD,CACD,GAEChB,uBACAkB,8IAMCC,mBAGC,GAEF,CACD,GApMD,IAuMDa,+BAEEC,qCACD,WAECC,WACAC,KACAC,QACD,EACD,CACD,CACD,sFA/ZOC,EAAAC,mGAzBJlF,EAAA,EAAAmF,EAAAC,EAAA,CACA,uCAEA,kKAPH,cAUI,QAAAtF,EAAA,KACAwC,EAAA+C,EAAA,CACA,kCAZJ,qIAiBchF,EAAA,OAAciC,EAAAgD,EAAA,mCAjB5B,sBAAAhD,EAAA2C,EAAA,mCAoBqC,sBAAAtF,EAAA,KAAAA,EAAA,GAAAC,GAAAF,EAAA,qBAAAE,6GAKvB","names":["_sfc_main","doc","getCachedDocumentResource","_a","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","$data","_cache","$event","_createSlots","_withCtx","$options","_openBlock","_createElementBlock","_hoisted_1","_hoisted_2","_createElementVNode","_createCommentVNode","_toDisplayString","_createTextVNode","_hoisted_11","_hoisted_12","name","components","DismissableBanner","data","showAppVersionDialog","sitesGroupedByBench","resources","benches","type","doctype","filters","group","skip_team_filter_for_system_user_and_support_agent","fields","orderBy","pageLength","auto","onSuccess","sites","computed","listOptions","list","groupHeader","bench","options","IconHash","icon","IconStar","_createVNode","Tooltip","emptyStateMessage","columns","filterControls","route","label","slots","prefix","params","appVersionOptions","fieldname","format","link","value","$releaseGroup","methods","site","collapsed","rows","loading","success","error","duration","condition","renderDialog","releaseGroup","confirmDialog","title","message","primaryAction","variant","onClick","hide","toast","getToastErrorMessage","e","theme","runBenchMethod","url","dt","dn","method","_component_Dialog","__unplugin_components_1","_createBlock","_component_DismissableBanner","_component_Button","_component_ObjectList"],"sources":["../../../../dashboard/src2/components/group/SSHCertificateDialog.vue","../../../../dashboard/src2/pages/ReleaseGroupBenchSites.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\t:options=\"{\n\t\t\ttitle: 'SSH Access',\n\t\t\tsize: 'xl',\n\t\t}\"\n\t\tv-model=\"show\"\n\t>\n\t\t<template #body-content v-if=\"$bench.doc\">\n\t\t\t<div v-if=\"certificate\" class=\"space-y-4\">\n\t\t\t\t<div class=\"space-y-2\" v-if=\"isWindows\">\n\t\t\t\t\t<h4 class=\"text-base font-semibold text-gray-700\">Step 1</h4>\n\t\t\t\t\t<div class=\"space-y-2\">\n\t\t\t\t\t\t<p class=\"text-base\">\n\t\t\t\t\t\t\tExecute the following shell command to set the encoding to UTF-8.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<ClickToCopyField\n\t\t\t\t\t\t\ttextContent=\"$PSDefaultParameterValues['*: Encoding'] = 'utf8'\"\n\t\t\t\t\t\t\t:breakLines=\"false\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"space-y-2\">\n\t\t\t\t\t<h4 class=\"text-base font-semibold text-gray-700\">\n\t\t\t\t\t\tStep {{ isWindows ? '2' : '1' }}\n\t\t\t\t\t</h4>\n\t\t\t\t\t<div class=\"space-y-2\">\n\t\t\t\t\t\t<p class=\"text-base\">\n\t\t\t\t\t\t\tExecute the following shell command to store the SSH certificate\n\t\t\t\t\t\t\tlocally.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<ClickToCopyField\n\t\t\t\t\t\t\t:textContent=\"certificateCommand\"\n\t\t\t\t\t\t\t:breakLines=\"false\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"space-y-2\">\n\t\t\t\t\t<h4 class=\"text-base font-semibold text-gray-700\">\n\t\t\t\t\t\tStep {{ isWindows ? '3' : '2' }}\n\t\t\t\t\t</h4>\n\t\t\t\t\t<div class=\"space-y-1\">\n\t\t\t\t\t\t<p class=\"text-base\">\n\t\t\t\t\t\t\tExecute the following shell command to SSH into your bench\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<ClickToCopyField :textContent=\"sshCommand\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"flex items-center gap-2 rounded bg-gray-100 p-3\">\n\t\t\t\t\t<FeatherIcon name=\"alert-triangle\" class=\"h-4 w-4\" />\n\t\t\t\t\t<div class=\"space-y-1 text-base\">\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tUse wisely and only for\n\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\thref=\"/docs/benches/debugging\"\n\t\t\t\t\t\t\t\tclass=\"underline\"\n\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t>debugging</a\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\tpurposes.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\tDo not install/uninstall apps as you would on a local machine. Use\n\t\t\t\t\t\t\tthe dashboard instead.\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"space-y-2 text-p-base text-gray-700\" v-else>\n\t\t\t\t<p v-if=\"!$bench.doc.user_ssh_key\">\n\t\t\t\t\tIt looks like you haven't added your SSH public key. Go to\n\t\t\t\t\t<router-link\n\t\t\t\t\t\t:to=\"{ name: 'SettingsDeveloper' }\"\n\t\t\t\t\t\tclass=\"underline\"\n\t\t\t\t\t\t@click=\"show = false\"\n\t\t\t\t\t>\n\t\t\t\t\t\tDeveloper Settings</router-link\n\t\t\t\t\t>\n\t\t\t\t\tto add your SSH public key.\n\t\t\t\t</p>\n\t\t\t\t<p v-else-if=\"!$bench.doc.is_ssh_proxy_setup\">\n\t\t\t\t\tSSH access is not enabled for this bench. Please contact support to\n\t\t\t\t\tenable access.\n\t\t\t\t</p>\n\t\t\t\t<p v-else>\n\t\t\t\t\tYou will need an SSH certificate to get SSH access to your bench. This\n\t\t\t\t\tcertificate will work only with your public-private key pair and will\n\t\t\t\t\tbe valid for 6 hours.\n\t\t\t\t</p>\n\t\t\t\t<p>\n\t\t\t\t\tPlease refer to the\n\t\t\t\t\t<a href=\"/docs/benches/ssh\" class=\"underline\" target=\"_blank\"\n\t\t\t\t\t\t>SSH Access documentation</a\n\t\t\t\t\t>\n\t\t\t\t\tfor more details.\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t</template>\n\t\t<template\n\t\t\t#actions\n\t\t\tv-if=\"\n\t\t\t\t!certificate &&\n\t\t\t\t$bench.doc?.is_ssh_proxy_setup &&\n\t\t\t\t$bench.doc?.user_ssh_key\n\t\t\t\"\n\t\t>\n\t\t\t<Button\n\t\t\t\t:loading=\"$releaseGroup.generateCertificate.loading\"\n\t\t\t\t@click=\"\n\t\t\t\t\tasync () => {\n\t\t\t\t\t\tawait $releaseGroup.generateCertificate.fetch();\n\t\t\t\t\t\tawait $releaseGroup.getCertificate.reload();\n\t\t\t\t\t}\n\t\t\t\t\"\n\t\t\t\tvariant=\"solid\"\n\t\t\t\tclass=\"w-full\"\n\t\t\t\t>Generate SSH Certificate</Button\n\t\t\t>\n\t\t</template>\n\t\t<ErrorMessage\n\t\t\tclass=\"mt-3\"\n\t\t\t:message=\"$releaseGroup.generateCertificate.error\"\n\t\t/>\n\t</Dialog>\n</template>\n\n<script>\nimport { getCachedDocumentResource } from 'frappe-ui';\n\nexport default {\n\tprops: ['bench', 'releaseGroup'],\n\tdata() {\n\t\treturn {\n\t\t\tshow: true,\n\t\t};\n\t},\n\tresources: {\n\t\tbench() {\n\t\t\treturn {\n\t\t\t\ttype: 'document',\n\t\t\t\tdoctype: 'Bench',\n\t\t\t\tname: this.bench,\n\t\t\t\tonSuccess(doc) {\n\t\t\t\t\tif (doc.is_ssh_proxy_setup && doc.user_ssh_key) {\n\t\t\t\t\t\tthis.$releaseGroup.getCertificate.reload();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tcomputed: {\n\t\t$bench() {\n\t\t\treturn this.$resources.bench;\n\t\t},\n\t\t$releaseGroup() {\n\t\t\treturn getCachedDocumentResource('Release Group', this.releaseGroup);\n\t\t},\n\t\tcertificate() {\n\t\t\treturn this.$releaseGroup.getCertificate.data;\n\t\t},\n\t\tsshCommand() {\n\t\t\tif (!this.$bench.doc) return;\n\t\t\treturn `ssh ${this.$bench.doc.name}@${this.$bench.doc.proxy_server} -p 2222`;\n\t\t},\n\t\tcertificateCommand() {\n\t\t\tif (this.certificate) {\n\t\t\t\treturn `echo '${this.certificate.ssh_certificate?.trim()}' > ~/.ssh/id_${\n\t\t\t\t\tthis.certificate.key_type\n\t\t\t\t}-cert.pub`;\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tisWindows() {\n\t\t\treturn navigator.userAgent.includes('Windows');\n\t\t},\n\t},\n};\n</script>\n","<template>\n\t<div>\n\t\t<DismissableBanner\n\t\t\tv-if=\"$releaseGroup.doc.eol_versions.includes($releaseGroup.doc.version)\"\n\t\t\tclass=\"col-span-1 lg:col-span-2\"\n\t\t\ttitle=\"Your sites are on an End of Life version. Upgrade to the latest version to get the latest features and security updates.\"\n\t\t\t:id=\"`${$releaseGroup.name}-eol`\"\n\t\t\ttype=\"gray\"\n\t\t>\n\t\t\t<Button\n\t\t\t\tclass=\"ml-auto\"\n\t\t\t\tvariant=\"outline\"\n\t\t\t\tlink=\"https://easytouch.cloud/docs/sites/version-upgrade\"\n\t\t\t>\n\t\t\t\tUpgrade Now\n\t\t\t</Button>\n\t\t</DismissableBanner>\n\t\t<ObjectList class=\"mt-3\" :options=\"listOptions\" />\n\t\t<Dialog\n\t\t\tv-model=\"showAppVersionDialog\"\n\t\t\t:options=\"{\n\t\t\t\ttitle: `Apps in ${$releaseGroup.getAppVersions.params?.args.bench}`,\n\t\t\t\tsize: '6xl',\n\t\t\t}\"\n\t\t>\n\t\t\t<template #body-content>\n\t\t\t\t<ObjectList :options=\"appVersionOptions\" />\n\t\t\t</template>\n\t\t</Dialog>\n\t</div>\n</template>\n<script lang=\"jsx\">\nimport Badge from '@/components/global/Badge.vue';\nimport { createResource, getCachedDocumentResource, Tooltip } from 'frappe-ui';\nimport { defineAsyncComponent, h } from 'vue';\nimport { toast } from 'vue-sonner';\nimport ActionButton from '../components/ActionButton.vue';\nimport SSHCertificateDialog from '../components/group/SSHCertificateDialog.vue';\nimport ObjectList from '../components/ObjectList.vue';\nimport {\n\tgetSitesTabColumns,\n\tsitesTabRoute,\n\tsiteTabFilterControls,\n} from '../objects/common';\nimport { confirmDialog, icon, renderDialog } from '../utils/components';\nimport { getToastErrorMessage } from '../utils/toast';\nimport DismissableBanner from '../components/DismissableBanner.vue';\n\nexport default {\n\tname: 'ReleaseGroupBenchSites',\n\tprops: ['releaseGroup'],\n\tcomponents: { ObjectList, DismissableBanner },\n\tdata() {\n\t\treturn {\n\t\t\tshowAppVersionDialog: false,\n\t\t\tsitesGroupedByBench: [],\n\t\t};\n\t},\n\tresources: {\n\t\tbenches() {\n\t\t\treturn {\n\t\t\t\ttype: 'list',\n\t\t\t\tdoctype: 'Bench',\n\t\t\t\tfilters: {\n\t\t\t\t\tgroup: this.$releaseGroup.name,\n\t\t\t\t\tskip_team_filter_for_system_user_and_support_agent: true,\n\t\t\t\t},\n\t\t\t\tfields: ['name', 'status'],\n\t\t\t\torderBy: 'creation desc',\n\t\t\t\tpageLength: 99999,\n\t\t\t\tauto: true,\n\t\t\t\tonSuccess() {\n\t\t\t\t\tthis.$resources.sites.fetch();\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tsites() {\n\t\t\treturn {\n\t\t\t\ttype: 'list',\n\t\t\t\tdoctype: 'Site',\n\t\t\t\tfilters: {\n\t\t\t\t\tgroup: this.$releaseGroup.name,\n\t\t\t\t\tskip_team_filter_for_system_user_and_support_agent: true,\n\t\t\t\t},\n\t\t\t\tfields: [\n\t\t\t\t\t'name',\n\t\t\t\t\t'status',\n\t\t\t\t\t'bench',\n\t\t\t\t\t'host_name',\n\t\t\t\t\t'plan.plan_title as plan_title',\n\t\t\t\t\t'plan.price_usd as price_usd',\n\t\t\t\t\t'plan.price_inr as price_inr',\n\t\t\t\t\t'cluster.image as cluster_image',\n\t\t\t\t\t'cluster.title as cluster_title',\n\t\t\t\t],\n\t\t\t\torderBy: 'creation desc, bench desc',\n\t\t\t\tpageLength: 99999,\n\t\t\t\ttransform(data) {\n\t\t\t\t\treturn this.groupSitesByBench(data);\n\t\t\t\t},\n\t\t\t\tauto: false,\n\t\t\t};\n\t\t},\n\t},\n\tcomputed: {\n\t\tlistOptions() {\n\t\t\treturn {\n\t\t\t\tlist: this.$resources.sites,\n\t\t\t\tgroupHeader: ({ group: bench }) => {\n\t\t\t\t\tif (!bench?.status) return;\n\n\t\t\t\t\tconst options = this.benchOptions(bench);\n\t\t\t\t\tconst IconHash = icon('hash', 'w-3 h-3');\n\t\t\t\t\tconst IconStar = icon('star', 'w-3 h-3');\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t\t\t<Tooltip text=\"View bench details\">\n\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\tclass=\"cursor-pointer text-base font-medium leading-6 text-gray-900\"\n\t\t\t\t\t\t\t\t\thref={`/dashboard/benches/${bench.name}`}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{bench.group}\n\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t{bench.status != 'Active' ? (\n\t\t\t\t\t\t\t\t<Badge class=\"ml-4\" label={bench.status} />\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t{bench.has_app_patch_applied && (\n\t\t\t\t\t\t\t\t<Tooltip text=\"Apps in this bench may have been patched\">\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\tclass=\"ml-2 rounded bg-gray-100 p-1 text-gray-700\"\n\t\t\t\t\t\t\t\t\t\thref=\"https://easytouch.cloud/docs/benches/app-patches\"\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<IconHash />\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{bench.has_updated_inplace && (\n\t\t\t\t\t\t\t\t<Tooltip text=\"This bench has been updated in place\">\n\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\tclass=\"ml-2 rounded bg-gray-100 p-1 text-gray-700\"\n\t\t\t\t\t\t\t\t\t\thref=\"https://easytouch.cloud/docs/in-place-updates\"\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<IconStar />\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t<ActionButton class=\"ml-auto\" options={options} />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\temptyStateMessage: this.$releaseGroup.doc.deploy_information.last_deploy\n\t\t\t\t\t? 'No sites found'\n\t\t\t\t\t: 'Create a deploy first to start creating sites',\n\t\t\t\tcolumns: getSitesTabColumns(false),\n\t\t\t\tfilterControls: siteTabFilterControls,\n\t\t\t\troute: sitesTabRoute,\n\t\t\t\tprimaryAction: () => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tlabel: 'New Site',\n\t\t\t\t\t\tslots: {\n\t\t\t\t\t\t\tprefix: icon('plus', 'w-4 h-4'),\n\t\t\t\t\t\t},\n\t\t\t\t\t\tdisabled: !this.$releaseGroup.doc?.deploy_information?.last_deploy,\n\t\t\t\t\t\troute: {\n\t\t\t\t\t\t\tname: 'Release Group New Site',\n\t\t\t\t\t\t\tparams: { bench: this.releaseGroup },\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tappVersionOptions() {\n\t\t\treturn {\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'App',\n\t\t\t\t\t\tfieldname: 'app',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Repo',\n\t\t\t\t\t\tfieldname: 'repository',\n\t\t\t\t\t\tformat(value, row) {\n\t\t\t\t\t\t\treturn `${row.repository_owner}/${row.repository}`;\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlink: (value, row) => {\n\t\t\t\t\t\t\treturn row.repository_url;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Branch',\n\t\t\t\t\t\tfieldname: 'branch',\n\t\t\t\t\t\ttype: 'Badge',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Commit',\n\t\t\t\t\t\tfieldname: 'hash',\n\t\t\t\t\t\ttype: 'Badge',\n\t\t\t\t\t\tformat(value, row) {\n\t\t\t\t\t\t\treturn value.slice(0, 7);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tlink: (value, row) => {\n\t\t\t\t\t\t\treturn `https://github.com/${row.repository_owner}/${row.repository}/commit/${value}`;\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Tag',\n\t\t\t\t\t\tfieldname: 'tag',\n\t\t\t\t\t\ttype: 'Badge',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tdata: () => this.$releaseGroup.getAppVersions.data,\n\t\t\t};\n\t\t},\n\t\t$releaseGroup() {\n\t\t\treturn getCachedDocumentResource('Release Group', this.releaseGroup);\n\t\t},\n\t},\n\tmethods: {\n\t\tgroupSitesByBench(data) {\n\t\t\tif (!this.$resources.benches.data) return [];\n\t\t\treturn this.$resources.benches.data.map((bench) => {\n\t\t\t\tlet sites = (data || []).filter((site) => site.bench === bench.name);\n\t\t\t\treturn {\n\t\t\t\t\t...bench,\n\t\t\t\t\tcollapsed: false,\n\t\t\t\t\tgroup: bench.name,\n\t\t\t\t\trows: sites,\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tbenchOptions(bench) {\n\t\t\tif (!bench) return [];\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'View in Desk',\n\t\t\t\t\tcondition: () => this.$team?.doc?.is_desk_user,\n\t\t\t\t\tonClick: () =>\n\t\t\t\t\t\twindow.open(\n\t\t\t\t\t\t\t`${window.location.protocol}//${window.location.host}/app/bench/${bench.name}`,\n\t\t\t\t\t\t\t'_blank',\n\t\t\t\t\t\t),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Show Apps',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\ttoast.promise(\n\t\t\t\t\t\t\tthis.$releaseGroup.getAppVersions\n\t\t\t\t\t\t\t\t.submit({ bench: bench.name })\n\t\t\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t\t\tthis.showAppVersionDialog = true;\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tloading: 'Fetching apps...',\n\t\t\t\t\t\t\t\tsuccess: 'Fetched apps with versions',\n\t\t\t\t\t\t\t\terror: 'Failed to fetch apps',\n\t\t\t\t\t\t\t\tduration: 1000,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'SSH Access',\n\t\t\t\t\tcondition: () => bench.status === 'Active',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\trenderDialog(\n\t\t\t\t\t\t\th(SSHCertificateDialog, {\n\t\t\t\t\t\t\t\tbench: bench.name,\n\t\t\t\t\t\t\t\treleaseGroup: this.$releaseGroup.name,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'View Logs',\n\t\t\t\t\tcondition: () => bench.status === 'Active',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tlet BenchLogsDialog = defineAsyncComponent(\n\t\t\t\t\t\t\t() => import('../components/group/BenchLogsDialog.vue'),\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\trenderDialog(\n\t\t\t\t\t\t\th(BenchLogsDialog, {\n\t\t\t\t\t\t\t\tbench: bench.name,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Update All Sites',\n\t\t\t\t\tcondition: () => bench.status === 'Active' && bench.rows.length > 0,\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tconfirmDialog({\n\t\t\t\t\t\t\ttitle: 'Update All Sites',\n\t\t\t\t\t\t\tmessage: `Are you sure you want to update all sites in the bench <b>${bench.name}</b> to the latest bench?`,\n\t\t\t\t\t\t\tprimaryAction: {\n\t\t\t\t\t\t\t\tlabel: 'Update',\n\t\t\t\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\t\t\t\tonClick: ({ hide }) => {\n\t\t\t\t\t\t\t\t\ttoast.promise(\n\t\t\t\t\t\t\t\t\t\tthis.runBenchMethod(bench.name, 'update_all_sites'),\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tloading: 'Scheduling updates for the sites...',\n\t\t\t\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\t\t\t\thide();\n\t\t\t\t\t\t\t\t\t\t\t\treturn 'Sites have been scheduled for update';\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\terror: (e) => {\n\t\t\t\t\t\t\t\t\t\t\t\thide();\n\t\t\t\t\t\t\t\t\t\t\t\treturn getToastErrorMessage(\n\t\t\t\t\t\t\t\t\t\t\t\t\te,\n\t\t\t\t\t\t\t\t\t\t\t\t\t'Failed to update sites',\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\tduration: 1000,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Restart Bench',\n\t\t\t\t\tcondition: () => bench.status === 'Active',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tconfirmDialog({\n\t\t\t\t\t\t\ttitle: 'Restart Bench',\n\t\t\t\t\t\t\tmessage: `Are you sure you want to restart the bench <b>${bench.name}</b>?`,\n\t\t\t\t\t\t\tprimaryAction: {\n\t\t\t\t\t\t\t\tlabel: 'Restart',\n\t\t\t\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\t\t\t\ttheme: 'red',\n\t\t\t\t\t\t\t\tonClick: ({ hide }) => {\n\t\t\t\t\t\t\t\t\ttoast.promise(this.runBenchMethod(bench.name, 'restart'), {\n\t\t\t\t\t\t\t\t\t\tloading: 'Restarting bench...',\n\t\t\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\t\t\thide();\n\t\t\t\t\t\t\t\t\t\t\treturn 'Bench will restart shortly';\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\terror: (e) => {\n\t\t\t\t\t\t\t\t\t\t\thide();\n\t\t\t\t\t\t\t\t\t\t\treturn getToastErrorMessage(e, 'Failed to restart bench');\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tduration: 1000,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Rebuild Assets',\n\t\t\t\t\tcondition: () =>\n\t\t\t\t\t\tbench.status === 'Active' &&\n\t\t\t\t\t\t!bench.on_public_server &&\n\t\t\t\t\t\t(Number(this.$releaseGroup.doc.version.split(' ')[1]) > 13 ||\n\t\t\t\t\t\t\tthis.$releaseGroup.doc.version === 'Nightly'),\n\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tconfirmDialog({\n\t\t\t\t\t\t\ttitle: 'Rebuild Assets',\n\t\t\t\t\t\t\tmessage: `Are you sure you want to rebuild assets for the bench <b>${bench.name}</b>?`,\n\t\t\t\t\t\t\tprimaryAction: {\n\t\t\t\t\t\t\t\tlabel: 'Rebuild',\n\t\t\t\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\t\t\t\ttheme: 'red',\n\t\t\t\t\t\t\t\tonClick: ({ hide }) => {\n\t\t\t\t\t\t\t\t\ttoast.promise(this.runBenchMethod(bench.name, 'rebuild'), {\n\t\t\t\t\t\t\t\t\t\tloading: 'Rebuilding assets...',\n\t\t\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\t\t\thide();\n\t\t\t\t\t\t\t\t\t\t\treturn 'Assets will be rebuilt in the background. This may take a few minutes.';\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\terror: (e) => {\n\t\t\t\t\t\t\t\t\t\t\thide();\n\t\t\t\t\t\t\t\t\t\t\treturn getToastErrorMessage(\n\t\t\t\t\t\t\t\t\t\t\t\te,\n\t\t\t\t\t\t\t\t\t\t\t\t'Failed to rebuild assets',\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\tduration: 1000,\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Archive Bench',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tconfirmDialog({\n\t\t\t\t\t\t\ttitle: 'Archive Bench',\n\t\t\t\t\t\t\tmessage: `Are you sure you want to archive the bench <b>${bench.name}</b>?`,\n\t\t\t\t\t\t\tprimaryAction: {\n\t\t\t\t\t\t\t\tlabel: 'Archive',\n\t\t\t\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\t\t\t\ttheme: 'red',\n\t\t\t\t\t\t\t\tonClick: ({ hide }) => {\n\t\t\t\t\t\t\t\t\ttoast.promise(this.runBenchMethod(bench.name, 'archive'), {\n\t\t\t\t\t\t\t\t\t\tloading: 'Scheduling bench for archival...',\n\t\t\t\t\t\t\t\t\t\tsuccess: () => {\n\t\t\t\t\t\t\t\t\t\t\thide();\n\t\t\t\t\t\t\t\t\t\t\treturn 'Bench is scheduled for archival';\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\terror: (e) =>\n\t\t\t\t\t\t\t\t\t\t\tgetToastErrorMessage(e, 'Failed to archive bench'),\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'View Processes',\n\t\t\t\t\tcondition: () => bench.status === 'Active',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tlet SupervisorProcessesDialog = defineAsyncComponent(\n\t\t\t\t\t\t\t() => import('../components/group/SupervisorProcessesDialog.vue'),\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\trenderDialog(\n\t\t\t\t\t\t\th(SupervisorProcessesDialog, {\n\t\t\t\t\t\t\t\tbench: bench.name,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\trunBenchMethod(name, methodName) {\n\t\t\tconst method = createResource({\n\t\t\t\turl: 'press.api.client.run_doc_method',\n\t\t\t});\n\t\t\treturn method.submit({\n\t\t\t\tdt: 'Bench',\n\t\t\t\tdn: name,\n\t\t\t\tmethod: methodName,\n\t\t\t});\n\t\t},\n\t},\n};\n</script>\n"],"file":"assets/ReleaseGroupBenchSites-CS-RhWIy.js"}