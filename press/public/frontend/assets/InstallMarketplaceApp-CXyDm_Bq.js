import{x as B,q as o,o as s,h as g,A as i,w as n,Y as p,X as I,j as u,u as _,t as h,a9 as D,F as w,v as S,aA as C}from"./main-Dpl-JOF2.js";import{_ as A}from"./ChangeAppPlanSelector-B7RAZX-J.js";import{_ as F}from"./Card-BCzTSeNK.js";import{n as b}from"./toast-Dk0nDfLL.js";import"./AppPlanCard-CuGgjNKV.js";import"./FeatureList-DXsHFT_A.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="98538005-f925-4883-a564-21978a1a686d",t._sentryDebugIdIdentifier="sentry-dbid-98538005-f925-4883-a564-21978a1a686d")}catch(m){}})();{var f=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};f._sentryModuleMetadata=f._sentryModuleMetadata||{},f._sentryModuleMetadata[new Error().stack]=Object.assign({},f._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const O={name:"InstallMarketplaceApp",props:["marketplaceApp"],data(){return{showPlanSelectionDialog:!1,selectedSite:null,selectedBench:null,selectedPlan:null}},components:{ChangeAppPlanSelector:A},resources:{optionsForQuickInstall(){return{url:"press.api.marketplace.options_for_quick_install",params:{marketplace_app:this.marketplaceApp},auto:!0}},addAppToBench(){return{url:"press.api.bench.add_app",onSuccess(){b({title:"App added successfully!",icon:"check",color:"green"}),this.$router.push(`/groups/${this.selectedBench}/apps`)}}},installAppOnSite(){return{url:"press.api.site.install_app",validate(){if(this.showPlanSelectionDialog&&!this.selectedPlan)return"Please select a plan to continue"},onSuccess(){b({title:"App installed successfully!",icon:"check",color:"green"}),this.selectedPlan=null,this.selectedSite=null,this.showPlanSelectionDialog=!1,this.$resources.optionsForQuickInstall.fetch()}}}},methods:{addAppToBench(t){this.selectedBench=t.name,this.$resources.addAppToBench.submit({name:t.name,source:t.source,app:this.options.app_name})},installAppOnSite(t){if(this.selectedSite=t,this.options.has_plans_available&&!this.showPlanSelectionDialog){this.showPlanSelectionDialog=!0;return}this.$resources.installAppOnSite.submit({name:t,app:this.options.app_name,plan:this.selectedPlan})}},computed:{options(){return this.$resources.optionsForQuickInstall.data&&!this.$resources.optionsForQuickInstall.loading?this.$resources.optionsForQuickInstall.data:null}}},N={class:"px-4 py-4 text-base sm:px-8"},Q={key:1},V={class:"mb-4 text-xl font-semibold"},$={key:0,class:"mt-2 grid grid-cols-1 gap-2 md:grid-cols-2"},T={key:0},E={class:"flex w-full flex-row justify-between rounded-md px-1 py-2 text-left text-base hover:bg-gray-50"},M={key:1},j={key:0,class:"space-y-3"},q={class:"flex w-full flex-row justify-between rounded-md px-1 py-2 text-left text-base hover:bg-gray-50"},L={key:1};function z(t,e,m,K,c,l){const r=I,y=D,k=F,v=A,x=C;return s(),o("div",N,[t.$resources.opionsForQuickInstall?(s(),g(r,{key:0,loading:!0},{default:n(()=>e[3]||(e[3]=[p("Loading")])),_:1})):(s(),o("div",Q,[u("h1",V," Install App: "+h(l.options?l.options.title:""),1),i(y,{message:t.$resources.optionsForQuickInstall.error},null,8,["message"]),l.options?(s(),o("div",$,[l.options.approved?(s(),g(k,{key:0,title:"Sites",subtitle:"Select a site to install"},{actions:n(()=>[i(r,{variant:"solid",route:"/sites/new"},{default:n(()=>e[6]||(e[6]=[p("New Site")])),_:1})]),default:n(()=>{var a;return[(a=l.options.sites)!=null&&a.length?(s(),o("ul",T,[(s(!0),o(w,null,S(l.options.sites,d=>(s(),o("li",E,[u("p",null,h(d),1),i(r,{onClick:P=>l.installAppOnSite(d),loading:t.$resources.installAppOnSite.loading},{default:n(()=>e[4]||(e[4]=[p("Install")])),_:2},1032,["onClick","loading"])]))),256))])):(s(),o("div",M,e[5]||(e[5]=[u("p",{class:"text-sm text-gray-700"},"No site available for install",-1)])))]}),_:1})):_("",!0),i(k,{title:"Private Benches",subtitle:"Select a bench to install"},{actions:n(()=>[i(r,{variant:"solid",route:"/groups/new"},{default:n(()=>e[9]||(e[9]=[p("New Bench")])),_:1})]),default:n(()=>{var a;return[(a=l.options.release_groups)!=null&&a.length?(s(),o("ul",j,[(s(!0),o(w,null,S(l.options.release_groups,d=>(s(),o("li",q,[u("p",null,h(d.title),1),i(r,{onClick:P=>l.addAppToBench(d),loading:t.$resources.addAppToBench.loading},{default:n(()=>e[7]||(e[7]=[p("Add")])),_:2},1032,["onClick","loading"])]))),256))])):(s(),o("div",L,e[8]||(e[8]=[u("p",{class:"text-sm text-gray-700"}," No benches available for install ",-1)])))]}),_:1})])):_("",!0)])),i(x,{modelValue:c.showPlanSelectionDialog,"onUpdate:modelValue":e[2]||(e[2]=a=>c.showPlanSelectionDialog=a),options:{title:"Select app plan",size:"xl"}},{"body-content":n(()=>[m.marketplaceApp?(s(),g(v,{key:0,app:m.marketplaceApp,class:"mb-9",onChange:e[0]||(e[0]=a=>c.selectedPlan=a.name)},null,8,["app"])):_("",!0),i(y,{message:t.$resources.installAppOnSite.error},null,8,["message"])]),actions:n(()=>[i(r,{variant:"solid",loading:t.$resources.installAppOnSite.loading,onClick:e[1]||(e[1]=a=>l.installAppOnSite(c.selectedSite))},{default:n(()=>e[10]||(e[10]=[p("Proceed")])),_:1},8,["loading"])]),_:1},8,["modelValue"])])}const W=B(O,[["render",z]]);export{W as default};
//# sourceMappingURL=InstallMarketplaceApp-CXyDm_Bq.js.map
