{"version":3,"file":"SiteRequestLogs-BHeGtHzu.js","sources":["../../../../dashboard/src/views/site/SiteRequestLogs.vue"],"sourcesContent":["<template>\n\t<div\n\t\tclass=\"flex items-center justify-center\"\n\t\tv-if=\"$resources.getPlan?.loading\"\n\t>\n\t\t<LoadingText />\n\t</div>\n\t<div v-else-if=\"$resources.getPlan?.data?.monitor_access\">\n\t\t<Card>\n\t\t\t<Report\n\t\t\t\ttitle=\"Request Logs\"\n\t\t\t\t:columns=\"[\n\t\t\t\t\t{ label: 'Time', name: 'time', class: 'w-2/12' },\n\t\t\t\t\t{ label: 'Method', name: 'method', class: 'w-1/12' },\n\t\t\t\t\t{ label: 'Path', name: 'path', class: 'w-5/12' },\n\t\t\t\t\t{ label: 'Status Code', name: 'status', class: 'w-2/12' },\n\t\t\t\t\t{ label: 'CPU Time (seconds)', name: 'cpu_time', class: 'w-2/12' }\n\t\t\t\t]\"\n\t\t\t\t:data=\"formatData\"\n\t\t\t\t:filters=\"[sortFilter, dateFilter]\"\n\t\t\t/>\n\n\t\t\t<div\n\t\t\t\tclass=\"px-2 py-2 text-base text-gray-600\"\n\t\t\t\tv-if=\"\n\t\t\t\t\t$resources.requestLogs.loading &&\n\t\t\t\t\t$resources.requestLogs.data.length == 0\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\t<LoadingText />\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"py-2 text-base text-gray-600\"\n\t\t\t\tv-if=\"\n\t\t\t\t\t!$resources.requestLogs.loading &&\n\t\t\t\t\t$resources.requestLogs.data.length == 0\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\tNo data\n\t\t\t</div>\n\t\t\t<Button\n\t\t\t\tv-if=\"$resources.requestLogs.data && $resources.requestLogs.data.length\"\n\t\t\t\t:loading=\"$resources.requestLogs.loading\"\n\t\t\t\tloadingText=\"Loading...\"\n\t\t\t\t@click=\"start += 10\"\n\t\t\t>\n\t\t\t\tLoad more\n\t\t\t</Button>\n\t\t</Card>\n\t</div>\n\t<div class=\"flex justify-center\" v-else>\n\t\t<span class=\"mt-16 text-base text-gray-700\">\n\t\t\tYour plan doesn't support this feature. Please upgrade your plan.\n\t\t</span>\n\t</div>\n</template>\n\n<script>\nimport { DateTime } from 'luxon';\nimport Report from '@/components/Report.vue';\n\nexport default {\n\tname: 'SiteRequestLogs',\n\tprops: ['site'],\n\tcomponents: {\n\t\tReport\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tdate: null,\n\t\t\tsort: 'CPU Time (Descending)',\n\t\t\tstart: 0,\n\t\t\tsortFilter: {\n\t\t\t\tname: 'sort',\n\t\t\t\toptions: [\n\t\t\t\t\t'Time (Ascending)',\n\t\t\t\t\t'Time (Descending)',\n\t\t\t\t\t'CPU Time (Descending)'\n\t\t\t\t],\n\t\t\t\ttype: 'select',\n\t\t\t\tvalue: 'CPU Time (Descending)'\n\t\t\t},\n\t\t\tdateFilter: {\n\t\t\t\tname: 'date',\n\t\t\t\ttype: 'date',\n\t\t\t\tvalue: null\n\t\t\t}\n\t\t};\n\t},\n\twatch: {\n\t\tsort(value) {\n\t\t\tthis.reset();\n\t\t}\n\t},\n\tresources: {\n\t\trequestLogs() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.analytics.request_logs',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.site?.name,\n\t\t\t\t\ttimezone: DateTime.local().zoneName,\n\t\t\t\t\tsort: this.sortFilter.value,\n\t\t\t\t\tdate: this.dateFilter.value || this.today,\n\t\t\t\t\tstart: this.start\n\t\t\t\t},\n\t\t\t\tauto: Boolean(this.today),\n\t\t\t\tpageLength: 10,\n\t\t\t\tkeepData: true,\n\t\t\t\tinitialData: []\n\t\t\t};\n\t\t},\n\t\tgetPlan() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.site.current_plan',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.site?.name\n\t\t\t\t},\n\t\t\t\tauto: true\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\treset() {\n\t\t\tthis.$resources.requestLogs.reset();\n\t\t\tthis.start = 0;\n\t\t}\n\t},\n\tcomputed: {\n\t\ttoday() {\n\t\t\treturn DateTime.local().toISODate();\n\t\t},\n\t\tformatData() {\n\t\t\tlet requestData = this.$resources.requestLogs.data;\n\t\t\tlet data = [];\n\t\t\trequestData.forEach(log => {\n\t\t\t\tlog.time = this.formatDate(log.timestamp, 'TIME_24_WITH_SHORT_OFFSET');\n\t\t\t\tlog.method = log.request.method;\n\t\t\t\tlog.path = log.request.path;\n\t\t\t\tlog.status = log.request.status_code;\n\t\t\t\tlog.cpu_time = this.$formatCPUTime(log.duration);\n\n\t\t\t\tlet row = [\n\t\t\t\t\t{ name: 'Time', value: log.time, class: 'w-2/12' },\n\t\t\t\t\t{ name: 'Method', value: log.method, class: 'w-1/12' },\n\t\t\t\t\t{ name: 'Path', value: log.path, class: 'w-5/12 break-all pr-2' },\n\t\t\t\t\t{ name: 'Status', value: log.status, class: 'w-2/12' },\n\t\t\t\t\t{ name: 'CPU Time', value: log.cpu_time, class: 'w-2/12' }\n\t\t\t\t];\n\t\t\t\tdata.push(row);\n\t\t\t});\n\t\t\treturn data;\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","_a","DateTime","log","row","data","_openBlock","_createElementBlock","_hoisted_1","_c","_b","_ctx","_hoisted_2","_withCtx","$options","_hoisted_3","_createCommentVNode","_cache","$event","$data","_createTextVNode","_hoisted_5","_createElementVNode"],"mappings":"m3BA+DA,MAAAA,EAAA,wBAEC,MAAA,CAAA,MAAA,wBAIA,MAAA,CACC,MAAA,CACC,KAAA,kCAEA,MAAA,0BAGC,QAAA,CACC,mBACA,oBACA,0GAQD,MAAA,IACD,IAGF,MAAA,qBAGC,kCAIC,MAAA,CACC,IAAA,mCACA,OAAA,CACC,MAAAC,EAAA,KAAA,OAAA,YAAAA,EAAA,KACA,SAAAC,EAAA,MAAA,EAAA,oCAEA,KAAA,KAAA,WAAA,OAAA,KAAA,MACA,MAAA,KAAA,oEAQH,SAAA,OACC,MAAA,CACC,IAAA,8BACA,OAAA,CACC,MAAAD,EAAA,KAAA,OAAA,YAAAA,EAAA,MAED,KAAA,GAEF,GAED,QAAA,CACC,OAAA,CACC,KAAA,WAAA,YAAA,MAAA,cAED,GAED,SAAA,CACC,OAAA,CACC,OAAAC,EAAA,MAAA,EAAA,UAAA,iFAMCC,EAAA,KAAA,KAAA,WAAAA,EAAA,UAAA,2BAAA,kDAGAA,EAAA,OAAAA,EAAA,QAAA,uDAGA,IAAAC,EAAA,CACC,CAAA,KAAA,OAAA,MAAAD,EAAA,KAAA,MAAA,QAAA,0MAMDE,EAAA,KAAAD,CAAA,CACD,CAAA,GAED,CACD,CACD,WAzJE,MAAA,uDAqBE,MAAA,8CAUA,MAAA,yCAmBE,MAAA,gIAnDLE,IAAAC,EAAA,MAAAC,EAAA,UAMgBC,GAAAC,EAAAC,EAAA,WAAA,UAAA,YAAAD,EAAA,OAAA,MAAAD,EAAA,gBAAhBH,IAAAC,EAAA,MAAAK,EAAA,WAPD,QAAAC,EAAA,IAAA,MAUI,MAAA,eACC,QAAA,iPAMA,EACA,KAAAC,EAAA,6GAMkDH,EAAA,WAAA,YAAA,KAAA,QAAA,GAFpDL,IAAAC,EAAA,MAAAQ,EAAA,SAtBHC,EAAA,GAAA,EAAA,qCAkCwDL,EAAA,WAAA,YAAA,KAAA,QAAA,+BAlCxDK,EAAA,GAAA,EAAA,sFA4CK,QAAAL,EAAA,WAAA,YAAA,QACD,YAAA,aACC,QAAAM,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAC,EAAA,OAAA,MA9CL,QAAAN,EAAA,IAAAI,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAAG,EAAA,aAAA,0BAAAJ,EAAA,GAAA,EAAA,cAoDCV,EAAA,EAAAC,EAAA,MAAAc,EAAAJ,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CACCK,EAAA,OAAA,CAAA,MAAA,+BAAA,EAAA,sEAAA,EAAA"}