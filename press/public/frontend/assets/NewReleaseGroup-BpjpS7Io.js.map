{"version":3,"file":"NewReleaseGroup-BpjpS7Io.js","sources":["../../../../dashboard/src2/pages/NewReleaseGroup.vue"],"sourcesContent":["<template>\n\t<div class=\"sticky top-0 z-10 shrink-0\">\n\t\t<Header>\n\t\t\t<Breadcrumbs\n\t\t\t\t:items=\"\n\t\t\t\t\tserver\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: 'Servers',\n\t\t\t\t\t\t\t\t\troute: '/servers'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: server,\n\t\t\t\t\t\t\t\t\troute: `/servers/${server}`\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: 'New Bench Group',\n\t\t\t\t\t\t\t\t\troute: '/groups/new'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t  ]\n\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t{ label: 'Bench Groups', route: '/groups' },\n\t\t\t\t\t\t\t\t{ label: 'New Bench Group', route: '/groups/new' }\n\t\t\t\t\t\t  ]\n\t\t\t\t\"\n\t\t\t/>\n\t\t</Header>\n\t</div>\n\n\t<div\n\t\tv-if=\"!$team.doc?.is_desk_user && !$session.hasBenchCreationAccess\"\n\t\tclass=\"mx-auto mt-60 w-fit rounded border border-dashed px-12 py-8 text-center text-gray-600\"\n\t>\n\t\t<i-lucide-alert-triangle class=\"mx-auto mb-4 h-6 w-6 text-red-600\" />\n\t\t<ErrorMessage message=\"You aren't permitted to create new bench groups\" />\n\t</div>\n\n\t<div v-else class=\"mx-auto max-w-2xl px-5\">\n\t\t<div v-if=\"options\" class=\"space-y-12 pb-[50vh] pt-12\">\n\t\t\t<div>\n\t\t\t\t<div class=\"flex items-center justify-between\">\n\t\t\t\t\t<h2 class=\"text-sm font-medium leading-6 text-gray-900\">\n\t\t\t\t\t\tSelect Framework Version\n\t\t\t\t\t</h2>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mt-2\">\n\t\t\t\t\t<div class=\"grid grid-cols-2 gap-3 sm:grid-cols-3\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tv-for=\"version in options.versions\"\n\t\t\t\t\t\t\t:key=\"version.name\"\n\t\t\t\t\t\t\t:class=\"[\n\t\t\t\t\t\t\t\tbenchVersion === version.name\n\t\t\t\t\t\t\t\t\t? 'border-gray-900 ring-1 ring-gray-900 hover:bg-gray-100'\n\t\t\t\t\t\t\t\t\t: 'bg-white text-gray-900  hover:bg-gray-50',\n\t\t\t\t\t\t\t\t'flex cursor-pointer items-center justify-between rounded border border-gray-400 p-3 text-sm focus:outline-none'\n\t\t\t\t\t\t\t]\"\n\t\t\t\t\t\t\t@click=\"benchVersion = version.name\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"font-medium\">{{ version.name }} </span>\n\t\t\t\t\t\t\t<span class=\"ml-1 text-gray-600\">\n\t\t\t\t\t\t\t\t{{ version.status }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"flex flex-col\"\n\t\t\t\tv-if=\"options?.clusters.length && benchVersion && !server\"\n\t\t\t>\n\t\t\t\t<h2 class=\"text-sm font-medium leading-6 text-gray-900\">\n\t\t\t\t\tSelect Region\n\t\t\t\t</h2>\n\t\t\t\t<div class=\"mt-2 w-full space-y-2\">\n\t\t\t\t\t<div class=\"grid grid-cols-2 gap-3\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tv-for=\"c in options?.clusters\"\n\t\t\t\t\t\t\t:key=\"c.name\"\n\t\t\t\t\t\t\t@click=\"benchRegion = c.name\"\n\t\t\t\t\t\t\t:class=\"[\n\t\t\t\t\t\t\t\tbenchRegion === c.name\n\t\t\t\t\t\t\t\t\t? 'border-gray-900 ring-1 ring-gray-900 hover:bg-gray-100'\n\t\t\t\t\t\t\t\t\t: 'border-gray-400 bg-white text-gray-900 ring-gray-200 hover:bg-gray-50',\n\t\t\t\t\t\t\t\t'flex w-full items-center rounded border p-3 text-left text-base text-gray-900'\n\t\t\t\t\t\t\t]\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"flex w-full items-center justify-between\">\n\t\t\t\t\t\t\t\t<div class=\"flex w-full items-center space-x-2\">\n\t\t\t\t\t\t\t\t\t<img :src=\"c.image\" class=\"h-5 w-5\" />\n\t\t\t\t\t\t\t\t\t<span class=\"text-sm font-medium\">\n\t\t\t\t\t\t\t\t\t\t{{ c.title }}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Badge v-if=\"c.beta\" :label=\"c.beta ? 'Beta' : ''\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"benchVersion && (benchRegion || server)\" class=\"flex flex-col\">\n\t\t\t\t<h2 class=\"text-sm font-medium leading-6 text-gray-900\">\n\t\t\t\t\tEnter Bench Group Title\n\t\t\t\t</h2>\n\t\t\t\t<div class=\"mt-2\">\n\t\t\t\t\t<FormControl v-model=\"benchTitle\" type=\"text\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Summary\n\t\t\t\tv-if=\"benchVersion && (benchRegion || server) && benchTitle\"\n\t\t\t\t:options=\"summaryOptions\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclass=\"flex flex-col space-y-4\"\n\t\t\t\tv-if=\"benchVersion && (benchRegion || server) && benchTitle\"\n\t\t\t>\n\t\t\t\t<FormControl\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tv-model=\"agreedToRegionConsent\"\n\t\t\t\t\t:label=\"`I agree that the laws of the region selected by me shall stand applicable to me and Easytouch.`\"\n\t\t\t\t/>\n\t\t\t\t<ErrorMessage class=\"my-2\" :message=\"$resources.createBench.error\" />\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t:disabled=\"!agreedToRegionConsent\"\n\t\t\t\t\t@click=\"\n\t\t\t\t\t\t$resources.createBench.submit({\n\t\t\t\t\t\t\tbench: {\n\t\t\t\t\t\t\t\ttitle: benchTitle,\n\t\t\t\t\t\t\t\tversion: benchVersion,\n\t\t\t\t\t\t\t\tcluster: benchRegion,\n\t\t\t\t\t\t\t\tsaas_app: null,\n\t\t\t\t\t\t\t\t// apps: getAppsToInstall(),\n\t\t\t\t\t\t\t\tapps: options.versions\n\t\t\t\t\t\t\t\t\t.find(v => v.name === benchVersion)\n\t\t\t\t\t\t\t\t\t.apps.filter(app => app.source.auto_add_list === 1 || app.source.main_app === 1)\n\t\t\t\t\t\t\t\t\t.sort((a, b) => a.name === 'frappe' ? -1 : (b.name === 'frappe' ? 1 : 0))\n\t\t\t\t\t\t\t\t\t.map(app => {\n\t\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\tname: app.name,\n\t\t\t\t\t\t\t\t\t\tsource: app.source.name\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\tserver: server || null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\"\n\t\t\t\t\t:loading=\"$resources.createBench.loading\"\n\t\t\t\t>\n\t\t\t\t\tCreate Bench Group\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport Summary from '../components/Summary.vue';\nimport Header from '../components/Header.vue';\nimport { DashboardError } from '../utils/error';\nimport { h } from 'vue';\nimport { Badge } from 'frappe-ui';\nimport ObjectList from '../components/ObjectList.vue';\n\nexport default {\n\tname: 'NewReleaseGroup',\n\tcomponents: {\n\t\tSummary,\n\t\tHeader,\n\t\tObjectList\n\t},\n\tprops: ['server'],\n\tdata() {\n\t\treturn {\n\t\t\tbenchTitle: '',\n\t\t\tbenchVersion: '',\n\t\t\tbenchRegion: '',\n\t\t\tagreedToRegionConsent: false\n\t\t};\n\t},\n\tresources: {\n\t\tpreInstalledApps() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.bench.get_default_apps',\n\t\t\t\tinitialData: {},\n\t\t\t\tauto: true\n\t\t\t};\n\t\t},\n\t\toptions() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.bench.options',\n\t\t\t\tinitialData: {\n\t\t\t\t\tversions: [],\n\t\t\t\t\tclusters: []\n\t\t\t\t},\n\t\t\t\tauto: true\n\t\t\t};\n\t\t},\n\t\tcreateBench() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.bench.new',\n\t\t\t\tvalidate() {\n\t\t\t\t\tif (!this.benchTitle) {\n\t\t\t\t\t\tthrow new DashboardError('Bench Group Title cannot be blank');\n\t\t\t\t\t}\n\t\t\t\t\tif (!this.benchVersion) {\n\t\t\t\t\t\tthrow new DashboardError('Select a version to create bench');\n\t\t\t\t\t}\n\t\t\t\t\tif (!this.agreedToRegionConsent) {\n\t\t\t\t\t\tthrow new DashboardError(\n\t\t\t\t\t\t\t'Please agree to the above consent to create bench'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSuccess(groupName) {\n\t\t\t\t\tthis.$router.push({\n\t\t\t\t\t\tname: 'Release Group Detail Apps',\n\t\t\t\t\t\tparams: { name: groupName }\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\tgetAppsToInstall() {\n\t\t\tlet apps = [\n\t\t\t\tthis.options.versions\n\t\t\t\t\t.find(v => v.name === this.benchVersion)\n\t\t\t\t\t.apps.find(app => app.name === 'frappe')\n\t\t\t].map(app => {\n\t\t\t\treturn {\n\t\t\t\t\tname: app.name,\n\t\t\t\t\tsource: app.source.name\n\t\t\t\t};\n\t\t\t});\n\n\t\t\t// add default apps\n\t\t\tapps.push(\n\t\t\t\t...this.preInstalledApps[this.benchVersion].map(app => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tname: app.app,\n\t\t\t\t\t\tsource: app.source\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t);\n\t\t\treturn apps;\n\t\t}\n\t},\n\tcomputed: {\n\t\toptions() {\n\t\t\treturn this.$resources.options.data;\n\t\t},\n\t\tpreInstalledApps() {\n\t\t\treturn this.$resources.preInstalledApps.data;\n\t\t},\n\t\tpreInstalledAppsList() {\n\t\t\treturn {\n\t\t\t\tdata: () => this.preInstalledApps,\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Default Apps',\n\t\t\t\t\t\tfieldname: 'app_title',\n\t\t\t\t\t\ttype: 'Component',\n\t\t\t\t\t\tcomponent: ({ row }) => {\n\t\t\t\t\t\t\treturn h(\n\t\t\t\t\t\t\t\t'a',\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tclass: 'flex items-center text-sm',\n\t\t\t\t\t\t\t\t\thref: `${row.route}`,\n\t\t\t\t\t\t\t\t\ttarget: '_blank'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t[h('span', { class: 'ml-2' }, row.app_title)]\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t},\n\t\tsummaryOptions() {\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Framework Version',\n\t\t\t\t\tvalue: this.benchVersion\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Preinstalled Apps',\n\t\t\t\t\tvalue: this.preInstalledApps[this.benchVersion]\n\t\t\t\t\t\t.map(app => app.title)\n\t\t\t\t\t\t.join(', '),\n\t\t\t\t\tcondition: () => this.preInstalledApps[this.benchVersion].length\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Region',\n\t\t\t\t\tvalue: this.benchRegion,\n\t\t\t\t\tcondition: () => !this.server\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Server',\n\t\t\t\t\tvalue: this.server,\n\t\t\t\t\tcondition: () => this.server\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Title',\n\t\t\t\t\tvalue: this.benchTitle\n\t\t\t\t}\n\t\t\t];\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","Summary","Header","ObjectList","groupName","apps","v","app","row","h","_hoisted_1","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","_hoisted_19","_openBlock","_createElementBlock","_Fragment","_createElementVNode","_withCtx","_a","_ctx","_hoisted_2","_hoisted_3","_hoisted_4","_renderList","$options","version","_normalizeClass","$event","$data","_toDisplayString","_b","$props","_hoisted_10","_cache","_c","c","_createCommentVNode","_hoisted_18","_hoisted_20","_createTextVNode"],"mappings":"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"}