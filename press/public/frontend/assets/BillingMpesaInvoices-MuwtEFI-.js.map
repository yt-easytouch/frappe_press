{"version":3,"file":"BillingMpesaInvoices-MuwtEFI-.js","sources":["../../../../dashboard/src2/pages/BillingMpesaInvoices.vue"],"sourcesContent":["<template>\n\t<div class=\"p-5\">\n\t\t<ObjectList :options=\"options\" />\n\t</div>\n</template>\n\n<script>\nimport { frappeRequest } from 'frappe-ui';\nimport ObjectList from '../components/ObjectList.vue';\nimport { icon } from '../utils/components';\n\nexport default {\n\tname: 'BillingMpesaInvoices',\n\tdata() {\n\t\treturn {\n\t\t\tinvoices: [],\n\t\t\tloading: false,\n\t\t\terrorMessage: null,\n\t\t};\n\t},\n\tcomponents: {\n\t\tObjectList,\n\t},\n\tmethods: {\n\t\tasync fetchInvoices() {\n\t\t\tthis.loading = true;\n\t\t\ttry {\n\t\t\t\tconst response = await frappeRequest({\n\t\t\t\t\turl: '/api/method/press.api.regional_payments.mpesa.utils.display_invoices_by_partner',\n\t\t\t\t\tmethod: 'GET',\n\t\t\t\t});\n\t\t\t\tthis.invoices = response;\n\t\t\t} catch (error) {\n\t\t\t\tthis.errorMessage = `Failed to load invoices. ${error}`;\n\t\t\t} finally {\n\t\t\t\tthis.loading = false;\n\t\t\t}\n\t\t},\n\t\tformatCurrency(value) {\n\t\t\treturn new Intl.NumberFormat('en-US', {\n\t\t\t\tstyle: 'currency',\n\t\t\t\tcurrency: 'Ksh',\n\t\t\t}).format(value);\n\t\t},\n\t},\n\tcomputed: {\n\t\toptions() {\n\t\t\treturn {\n\t\t\t\tdoctype: 'Mpesa Payment Record',\n\t\t\t\tfields: [\n\t\t\t\t\t'name',\n\t\t\t\t\t'posting_date',\n\t\t\t\t\t'amount',\n\t\t\t\t\t'local_invoice',\n\t\t\t\t\t'payment_partner',\n\t\t\t\t\t'amount_usd',\n\t\t\t\t\t'exchange_rate',\n\t\t\t\t],\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Invoice Name',\n\t\t\t\t\t\tfieldname: 'name',\n\t\t\t\t\t\twidth: 1,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Date',\n\t\t\t\t\t\tfieldname: 'posting_date',\n\t\t\t\t\t\twidth: 0.7,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Amount',\n\t\t\t\t\t\tfieldname: 'amount',\n\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\twidth: 0.6,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Amount (USD)',\n\t\t\t\t\t\tfieldname: 'amount_usd',\n\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\twidth: 0.6,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Exchange Rate',\n\t\t\t\t\t\tfieldname: 'exchange_rate',\n\t\t\t\t\t\talign: 'center',\n\t\t\t\t\t\twidth: 0.6,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Payment Partner',\n\t\t\t\t\t\tfieldname: 'payment_partner',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\ttype: 'Button',\n\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\tButton: ({ row }) => {\n\t\t\t\t\t\t\tif (row.local_invoice) {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tlabel: 'Download Invoice',\n\t\t\t\t\t\t\t\t\tslots: {\n\t\t\t\t\t\t\t\t\t\tprefix: icon('download'),\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\twindow.open(row.local_invoice);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\torderBy: 'posting_date desc',\n\t\t\t};\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.fetchInvoices();\n\t},\n};\n</script>\n"],"names":["_sfc_main","__async","response","frappeRequest","value","row","_hoisted_1","_openBlock","_createElementBlock"],"mappings":"u7BAWA,MAAAA,EAAA,6BAEC,MAAA,CACC,MAAA,wBAGC,aAAA,iCAMF,QAAA,CACC,eAAA,QAAAC,EAAA,sBACC,KAAA,QAAA,GACA,GAAA,CACC,MAAAC,EAAA,MAAAC,EAAA,CACC,IAAA,8FAED,CAAA,4EAID,QAAA,CACC,KAAA,QAAA,EACD,KAED,eAAAC,EAAA,CACC,OAAA,IAAA,KAAA,aAAA,QAAA,CACC,MAAA,WACA,SAAA,KACD,CAAA,EAAA,OAAAA,CAAA,IAGF,SAAA,CACC,SAAA,CACC,MAAA,gCAEC,OAAA,CACC,OACA,eACA,SACA,gBACA,+BAEA,iBAED,QAAA,CACC,CACC,MAAA,eACA,UAAA,OACA,MAAA,GAED,uCAGC,MAAA,IAED,CACC,MAAA,SACA,UAAA,SACA,MAAA,SACA,MAAA,IAED,CACC,MAAA,sCAEA,MAAA,SACA,MAAA,IAED,CACC,MAAA,0CAEA,MAAA,SACA,MAAA,IAED,sDAIA,CACC,MAAA,+BAGA,OAAA,CAAA,CAAA,IAAAC,KAAA,CACC,GAAAA,EAAA,cACC,MAAA,0BAEC,MAAA,oCAIC,OAAA,KAAAA,EAAA,aAAA,sCAWT,SAAA,CACC,KAAA,cAAA,EAEF,EApHMC,EAAA,CAAA,MAAA,KAAA,kDAAL,OAAAC,EAAA,EAAAC,EAAA,MAAAF,EAAA"}