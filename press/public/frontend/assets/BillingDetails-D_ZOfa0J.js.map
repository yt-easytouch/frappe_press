{"version":3,"file":"BillingDetails-D_ZOfa0J.js","sources":["../../../../dashboard/src2/components/billing/BillingDetails.vue"],"sourcesContent":["<template>\n\t<div class=\"flex flex-col gap-5\">\n\t\t<FormControl\n\t\t\tv-model=\"billingInformation.billing_name\"\n\t\t\ttype=\"text\"\n\t\t\tname=\"billing_name\"\n\t\t\tlabel=\"Billing Name\"\n\t\t\t:required=\"true\"\n\t\t/>\n\t\t<NewAddressForm\n\t\t\tref=\"addressFormRef\"\n\t\t\tv-model=\"billingInformation\"\n\t\t\t@success=\"() => emit('success')\"\n\t\t/>\n\t\t<ErrorMessage class=\"mt-2\" :message=\"errorMessage\" />\n\t</div>\n\t<div v-if=\"addressFormRef\" class=\"mt-6\">\n\t\t<Button\n\t\t\tclass=\"w-full\"\n\t\t\tvariant=\"solid\"\n\t\t\tlabel=\"Update billing details\"\n\t\t\t:loading=\"addressFormRef.updateBillingInformation.loading\"\n\t\t\t@click=\"updateBillingInformation\"\n\t\t/>\n\t</div>\n</template>\n<script setup>\nimport NewAddressForm from './NewAddressForm.vue';\nimport { FormControl, ErrorMessage, Button, createResource } from 'frappe-ui';\nimport { reactive, ref, inject } from 'vue';\n\nconst emit = defineEmits(['success']);\n\nconst team = inject('team');\n\nconst addressFormRef = ref(null);\n\nconst fullName = `${team.doc.user_info.first_name || ''} ${\n\tteam.doc.user_info.last_name || ''\n}`.trim();\n\nconst billingInformation = reactive({\n\tbilling_name: fullName || '',\n\taddress: '',\n\tcity: '',\n\tstate: '',\n\tpostal_code: '',\n\tcountry: '',\n\tgstin: '',\n});\n\ncreateResource({\n\turl: 'press.api.account.get_billing_information',\n\tauto: true,\n\tonSuccess: (data) => {\n\t\tif (!Object.keys(data).length) return;\n\n\t\tObject.assign(billingInformation, {\n\t\t\taddress: data.address_line1,\n\t\t\tcity: data.city,\n\t\t\tstate: data.state,\n\t\t\tpostal_code: data.pincode,\n\t\t\tcountry: data.country,\n\t\t\tgstin: data.gstin == 'Not Applicable' ? '' : data.gstin,\n\t\t\tbilling_name: data.billing_name,\n\t\t});\n\t},\n});\n\nconst errorMessage = ref('');\n\nfunction updateBillingInformation() {\n\tif (!billingInformation.billing_name) {\n\t\terrorMessage.value = 'Billing Name is required';\n\t\treturn;\n\t}\n\tconst billing_name = billingInformation.billing_name.trim();\n\tconst billingNameRegex = /^[a-zA-Z0-9\\-\\'\\,\\.\\s]+$/;\n\tconst billingNameValid = billingNameRegex.test(billing_name);\n\tif (!billingNameValid) {\n\t\terrorMessage.value = 'Billing Name contains invalid characters';\n\t\treturn;\n\t}\n\tbillingInformation.billing_name = billing_name;\n\taddressFormRef.value.updateBillingInformation.submit();\n}\n</script>\n"],"names":["emit","__emit","team","inject","addressFormRef","ref","fullName","billingInformation","reactive","createResource","data","errorMessage","updateBillingInformation","billing_name"],"mappings":"47BA+BA,MAAAA,EAAAC,EAEAC,EAAAC,EAAA,MAAA,EAEAC,EAAAC,EAAA,IAAA,EAEAC,EAAA,GAAAJ,EAAA,IAAA,UAAA,YAAA,EAAA,IACAA,EAAA,IAAA,UAAA,WAAA,EACA,GAAA,KAAA,EAEAK,EAAAC,EAAA,CACA,aAAAF,GAAA,GACA,QAAA,GACA,KAAA,GACA,MAAA,GACA,YAAA,GACA,QAAA,GACA,MAAA,EACA,CAAA,EAEAG,EAAA,CACA,IAAA,4CACA,KAAA,GACA,UAAAC,GAAA,CACA,OAAA,KAAAA,CAAA,EAAA,QAEA,OAAA,OAAAH,EAAA,CACA,QAAAG,EAAA,cACA,KAAAA,EAAA,KACA,MAAAA,EAAA,MACA,YAAAA,EAAA,QACA,QAAAA,EAAA,QACA,MAAAA,EAAA,OAAA,iBAAA,GAAAA,EAAA,MACA,aAAAA,EAAA,YACA,CAAA,CACA,CACA,CAAA,EAEA,MAAAC,EAAAN,EAAA,EAAA,EAEA,SAAAO,GAAA,CACA,GAAA,CAAAL,EAAA,aAAA,CACAI,EAAA,MAAA,2BACA,MACA,CACA,MAAAE,EAAAN,EAAA,aAAA,KAAA,EAGA,GAAA,CAFA,2BACA,KAAAM,CAAA,EACA,CACAF,EAAA,MAAA,2CACA,MACA,CACAJ,EAAA,aAAAM,EACAT,EAAA,MAAA,yBAAA,OAAA,CACA"}