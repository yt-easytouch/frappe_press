var I=Object.defineProperty;var _=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var x=(s,e,n)=>e in s?I(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n,v=(s,e)=>{for(var n in e||(e={}))L.call(e,n)&&x(s,n,e[n]);if(_)for(var n of _(e))U.call(e,n)&&x(s,n,e[n]);return s};import{x as C,c6 as w,q as c,o as d,j as l,A as r,w as g,Y as B,X as M,aK as E,n as P,t as T,a8 as j,F as O,v as N,h as q,C as z,V as u,aa as K}from"./main-Dpl-JOF2.js";import{_ as A}from"./FileUploader-C1pIUjCt.js";import"./datetime-PXpIdgFA.js";import"./dayjs.min-BK4AnHlu.js";(function(){try{var s=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[e]="cb85faa2-a664-4246-b6af-688587441016",s._sentryDebugIdIdentifier="sentry-dbid-cb85faa2-a664-4246-b6af-688587441016")}catch(n){}})();{var m=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};m._sentryModuleMetadata=m._sentryModuleMetadata||{},m._sentryModuleMetadata[new Error().stack]=Object.assign({},m._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const R={name:"MarketplaceAppOverview",props:["app"],components:{FileUploader:A,TextEditor:w},data(){return{editing:!1,editable:!0,marketplaceApp:{title:this.app.doc.title,website:"",support:"",documentation:"",terms_of_service:"",privacy_policy:"",description:"",long_description:""}}},resources:{updateListing(){return{url:"press.api.client.run_doc_method",makeParams(){return{dt:"Marketplace App",dn:this.app.doc.name,method:"update_listing",args:this.marketplaceApp}}}},listingData(){return{url:"press.api.client.run_doc_method",makeParams(){return{dt:"Marketplace App",dn:this.app.doc.name,method:"listing_details"}},auto:!0,onSuccess(s){this.marketplaceApp=v(v({},this.marketplaceApp),s.message)},onError(s){u.error(K(s,"Failed to fetch listing data"))}}},removeScreenshot(){return{url:"press.api.marketplace.remove_app_screenshot"}}},methods:{imageAddSuccess(s){this.$resources.listingData.reload(),u.success(s)},imageAddFailure(s){u.error(s)},updateListing(){u.promise(this.$resources.updateListing.submit(),{success:()=>(this.editing=!1,"Updated successfully"),loading:"Updating listing...",error:s=>{var e;return(e=s.messages)!=null&&e.length?s.messages.join(`
`):s.message||"Failed to update listing"}})},dropdownOptions(s){return[{label:"View",onClick:()=>window.open(s)},{label:"Delete",onClick:()=>{u.promise(this.$resources.removeScreenshot.submit({name:this.app.doc.name,file:s}),{loading:"Deleting screenshot...",success:()=>(this.$resources.listingData.reload(),"Screenshot deleted successfully"),error:e=>{var n;return(n=e.messages)!=null&&n.length?e.messages.join(`
`):e.message||"Failed to delete screenshot"}})}}]},validateLink(s){var f;const e=(f=this.marketplaceApp[s])!=null?f:"",n=/^(https?:\/\/)?([\w\-]+\.)+[\w\-]{2,}(\/[\w\-._~:\/?#[\]@!$&'()*+,;=]*)?$/;return e.trim()?n.test(e.trim())?!0:(this.$toast.error(`${s.replace("_"," ")} contains an invalid URL`),!1):(this.$toast.error(`${s.replace("_"," ")} link is empty`),!1)}},computed:{profileImageUrl(){return this.app.doc.image}}},W={class:"space-y-12 rounded-md border px-5 py-4"},X={class:"flex justify-between border-b pb-4"},Y={class:"grid grid-cols-1 gap-x-5 border-b py-6 md:grid-cols-2"},H={class:"border-r pr-6"},J={class:"group relative my-4 flex"},Q={class:"flex flex-col"},Z={class:"ml-4"},G=["onClick"],$={key:0},ee={key:1},te={class:"pb-8 sm:col-span-4"},se={class:"sm:col-span-4"},oe={class:"hidden md:block"},le={class:"flex w-full"},ne={class:"grid grid-cols-2 gap-x-4 gap-y-4 pt-4 lg:grid-cols-3 xl:grid-cols-4"},re=["src"],ie={class:"mt-6"},ae={class:"mt-4"};function pe(s,e,n,f,o,i){const y=M,V=E,k=A,a=j,h=z,F=w;return d(),c("div",W,[l("div",null,[l("div",X,[e[23]||(e[23]=l("div",null,[l("h2",{class:"text-lg font-medium text-gray-900"},"App Profile"),l("p",{class:"mt-1 text-sm leading-6 text-gray-600"}," This information will be displayed publicly on the marketplace. Make sure you enter correct information without any broken links and images. ")],-1)),r(y,{variant:o.editing?"solid":"subtle",onClick:i.updateListing},{default:g(()=>e[22]||(e[22]=[B("Save")])),_:1},8,["variant","onClick"])]),l("div",Y,[l("div",H,[e[25]||(e[25]=l("span",{class:"text-base font-medium"},"Profile",-1)),l("div",J,[l("div",Q,[r(V,{size:"3xl",shape:"square",label:n.app.doc.title,image:i.profileImageUrl},null,8,["label","image"])]),r(k,{onSuccess:e[0]||(e[0]=()=>i.imageAddSuccess("Profile photo updated")),onFailure:i.imageAddFailure,fileTypes:"image/*","upload-args":{doctype:"Marketplace App",docname:n.app.doc.name,method:"press.api.marketplace.update_app_image"}},{default:g(({openFileSelector:t,uploading:p,progress:b,error:S})=>[l("div",Z,[l("button",{onClick:D=>t(),class:P(["absolute inset-0 grid w-11.5 place-items-center rounded-lg bg-black text-xs font-medium text-white opacity-0 transition hover:opacity-50 focus:opacity-50 focus:outline-none",{"opacity-50":p}])},[p?(d(),c("span",$,T(b)+"%",1)):(d(),c("span",ee,"Edit"))],10,G)])]),_:1},8,["onFailure","upload-args"])]),l("div",te,[r(a,{class:"mt-4",label:"Title",type:"text",onInput:e[1]||(e[1]=t=>o.editing=!0),modelValue:o.marketplaceApp.title,"onUpdate:modelValue":e[2]||(e[2]=t=>o.marketplaceApp.title=t)},null,8,["modelValue"])]),l("div",se,[e[24]||(e[24]=l("span",{class:"text-base font-medium"},"Links",-1)),l("div",null,[r(a,{class:"mt-4",label:"Documentation",type:"text",onBlur:e[3]||(e[3]=t=>i.validateLink("documentation")),onInput:e[4]||(e[4]=t=>o.editing=!0),modelValue:o.marketplaceApp.documentation,"onUpdate:modelValue":e[5]||(e[5]=t=>o.marketplaceApp.documentation=t)},null,8,["modelValue"]),r(a,{class:"mt-4",label:"Website",type:"text",onBlur:e[6]||(e[6]=t=>i.validateLink("website")),onInput:e[7]||(e[7]=t=>o.editing=!0),modelValue:o.marketplaceApp.website,"onUpdate:modelValue":e[8]||(e[8]=t=>o.marketplaceApp.website=t)},null,8,["modelValue"]),r(a,{class:"mt-4",label:"Support",type:"text",onBlur:e[9]||(e[9]=t=>i.validateLink("support")),onInput:e[10]||(e[10]=t=>o.editing=!0),modelValue:o.marketplaceApp.support,"onUpdate:modelValue":e[11]||(e[11]=t=>o.marketplaceApp.support=t)},null,8,["modelValue"]),r(a,{class:"mt-4",label:"Terms of Service",type:"text",onBlur:e[12]||(e[12]=t=>i.validateLink("terms_of_service")),onInput:e[13]||(e[13]=t=>o.editing=!0),modelValue:o.marketplaceApp.terms_of_service,"onUpdate:modelValue":e[14]||(e[14]=t=>o.marketplaceApp.terms_of_service=t)},null,8,["modelValue"]),r(a,{class:"mt-4",label:"Privacy Policy",type:"text",onBlur:e[15]||(e[15]=t=>i.validateLink("privacy_policy")),onInput:e[16]||(e[16]=t=>o.editing=!0),modelValue:o.marketplaceApp.privacy_policy,"onUpdate:modelValue":e[17]||(e[17]=t=>o.marketplaceApp.privacy_policy=t)},null,8,["modelValue"])])])]),l("div",oe,[l("div",le,[e[26]||(e[26]=l("span",{class:"text-base font-medium"},"Screenshots and Videos",-1)),r(k,{class:"ml-auto",onSuccess:e[18]||(e[18]=()=>i.imageAddSuccess("Added screenshot")),onFailure:i.imageAddFailure,fileTypes:"image/*","upload-args":{doctype:"Marketplace App",docname:n.app.name,method:"press.api.marketplace.add_app_screenshot"}},{default:g(({openFileSelector:t,uploading:p,progress:b,error:S})=>[r(y,{loading:p,onClick:D=>t(),"icon-left":"plus",label:"Add"},null,8,["loading","onClick"])]),_:1},8,["onFailure","upload-args"])]),l("div",ne,[(d(!0),c(O,null,N(o.marketplaceApp.screenshots,(t,p)=>(d(),q(h,{class:"w-fit",options:i.dropdownOptions(t),right:""},{default:g(({open:b})=>[l("img",{class:"mx-1 h-24 w-36 cursor-pointer overflow-x-auto rounded-md object-cover",src:t},null,8,re)]),_:2},1032,["options"]))),256))])])]),l("div",ie,[e[28]||(e[28]=l("span",{class:"text-base font-medium"},"Description",-1)),r(a,{class:"mt-4",label:"Summary",type:"textarea",onInput:e[19]||(e[19]=t=>o.editing=!0),modelValue:o.marketplaceApp.description,"onUpdate:modelValue":e[20]||(e[20]=t=>o.marketplaceApp.description=t)},null,8,["modelValue"]),l("div",ae,[e[27]||(e[27]=l("span",{class:"text-xs text-gray-600"},"Description",-1)),r(F,{class:"mt-1 block w-full rounded border border-gray-100 bg-gray-100 px-2 py-1.5 text-base text-gray-800 placeholder-gray-500 transition-colors hover:border-gray-200 hover:bg-gray-200 focus:border-gray-500 focus:bg-white focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400",ref:"textEditor","editor-class":"rounded-b-lg max-w-[unset] prose-sm pb-[10vh]",content:o.marketplaceApp.long_description,onChange:e[21]||(e[21]=t=>o.marketplaceApp.long_description=t),editable:o.editable,bubbleMenu:!0},null,8,["content","editable"])])])])])}const fe=C(R,[["render",pe]]);export{fe as default};
//# sourceMappingURL=MarketplaceAppListing-BURoDkCp.js.map
