{"version":3,"file":"SiteDeadlockReport-B8RplR6d.js","sources":["../../../../dashboard/src/views/site/SiteDeadlockReport.vue"],"sourcesContent":["<template>\n\t<div\n\t\tclass=\"flex items-center justify-center\"\n\t\tv-if=\"$resources.getPlan?.loading\"\n\t>\n\t\t<LoadingText />\n\t</div>\n\t<div v-else-if=\"$resources.getPlan?.data?.monitor_access\">\n\t\t<Card>\n\t\t\t<Report\n\t\t\t\t:filters=\"filters\"\n\t\t\t\t:columns=\"[\n\t\t\t\t\t{ label: 'Timestamp', name: 'timestamp', class: 'w-2/12' },\n\t\t\t\t\t{ label: 'Query', name: 'query', class: 'w-10/12' }\n\t\t\t\t]\"\n\t\t\t\t:data=\"formatDeadlockData\"\n\t\t\t\ttitle=\"MariaDB Deadlock Report\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclass=\"px-2 py-2 text-base text-gray-600\"\n\t\t\t\tv-if=\"\n\t\t\t\t\t$resources.deadlockReport.loading &&\n\t\t\t\t\t$resources.deadlockReport.data.length == 0\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\t<LoadingText />\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"content-center py-2 text-base\"\n\t\t\t\tv-if=\"\n\t\t\t\t\t!$resources.deadlockReport.loading &&\n\t\t\t\t\t$resources.deadlockReport.data.length == 0\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\tNo data\n\t\t\t</div>\n\t\t\t<Button\n\t\t\t\tv-if=\"\n\t\t\t\t\t$resources.deadlockReport.data &&\n\t\t\t\t\t$resources.deadlockReport.data.length\n\t\t\t\t\"\n\t\t\t\t:loading=\"$resources.deadlockReport.loading\"\n\t\t\t\tloadingText=\"Loading...\"\n\t\t\t\t@click=\"max_lines += 10\"\n\t\t\t>\n\t\t\t\tLoad more\n\t\t\t</Button>\n\t\t</Card>\n\t</div>\n\t<div class=\"flex justify-center\" v-else>\n\t\t<span class=\"mt-16 text-base text-gray-700\">\n\t\t\tYour plan doesn't support this feature. Please upgrade your plan.\n\t\t</span>\n\t</div>\n</template>\n<script>\nimport Report from '@/components/Report.vue';\nimport { DateTime } from 'luxon';\n\nexport default {\n\tname: 'SiteDeadlockReport',\n\tprops: ['site'],\n\tcomponents: {\n\t\tReport\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tfilters: [\n\t\t\t\t{\n\t\t\t\t\tname: 'start_datetime',\n\t\t\t\t\tlabel: 'From:',\n\t\t\t\t\ttype: 'date',\n\t\t\t\t\tvalue: this.today\n\t\t\t\t},\n\t\t\t\t{ name: 'end_datetime', label: 'To:', type: 'date', value: this.today }\n\t\t\t],\n\t\t\tmax_lines: 20\n\t\t};\n\t},\n\twatch: {\n\t\tstartTime() {\n\t\t\tthis.reset();\n\t\t},\n\t\tendTime() {\n\t\t\tthis.reset();\n\t\t}\n\t},\n\tresources: {\n\t\tdeadlockReport() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.analytics.deadlock_report',\n\t\t\t\tparams: {\n\t\t\t\t\tsite: this.site?.name,\n\t\t\t\t\tstart: this.startTime || this.today,\n\t\t\t\t\tend: this.endTime || this.today,\n\t\t\t\t\tmax_lines: this.max_lines\n\t\t\t\t},\n\t\t\t\tauto: true,\n\t\t\t\tpageLength: 10,\n\t\t\t\tkeepData: true,\n\t\t\t\tinitialData: []\n\t\t\t};\n\t\t},\n\t\tgetPlan() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.site.current_plan',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.site?.name\n\t\t\t\t},\n\t\t\t\tauto: true\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\treset() {\n\t\t\tthis.$resources.deadlockReport.reset();\n\t\t}\n\t},\n\tcomputed: {\n\t\ttoday() {\n\t\t\treturn DateTime.local().toISODate();\n\t\t},\n\t\tstartTime() {\n\t\t\treturn this.filters[0].value;\n\t\t},\n\t\tendTime() {\n\t\t\treturn this.filters[1].value;\n\t\t},\n\t\tformatDeadlockData() {\n\t\t\tlet data = [];\n\t\t\tthis.$resources.deadlockReport.data.forEach(row => {\n\t\t\t\tlet timestamp = this.formatDate(\n\t\t\t\t\trow.timestamp,\n\t\t\t\t\t'TIME_24_WITH_SHORT_OFFSET'\n\t\t\t\t);\n\t\t\t\tlet out = [\n\t\t\t\t\t{ name: 'Timestamp', value: timestamp, class: 'w-2/12' },\n\t\t\t\t\t{ name: 'Query', value: row.query, class: 'w-10/12' }\n\t\t\t\t];\n\t\t\t\tdata.push(out);\n\t\t\t});\n\n\t\t\treturn data;\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","_a","DateTime","out","row","data","_openBlock","_createElementBlock","_hoisted_1","_c","_b","_ctx","_hoisted_2","_withCtx","$data","$options","_hoisted_3","_createCommentVNode","_cache","$event","_createTextVNode","_hoisted_5","_createElementVNode"],"mappings":"m3BA8DA,MAAAA,EAAA,2BAEC,MAAA,CAAA,MAAA,wBAIA,MAAA,CACC,MAAA,CACC,QAAA,CACC,CACC,KAAA,2CAGA,MAAA,KAAA,sFAOJ,MAAA,2BAIC,SAAA,aAEA,cAGA,gBAAA,OACC,MAAA,CACC,IAAA,sCACA,OAAA,CACC,MAAAC,EAAA,KAAA,OAAA,YAAAA,EAAA,KACA,MAAA,KAAA,WAAA,KAAA,6DAID,KAAA,8CAMF,SAAA,OACC,MAAA,CACC,IAAA,8BACA,OAAA,CACC,MAAAA,EAAA,KAAA,OAAA,YAAAA,EAAA,MAED,KAAA,GAEF,GAED,QAAA,CACC,OAAA,CACC,KAAA,WAAA,eAAA,MAAA,CACD,GAED,SAAA,CACC,OAAA,CACC,OAAAC,EAAA,MAAA,EAAA,UAAA,6CAKD,SAAA,+BAGA,oBAAA,iEAOE,IAAAC,EAAA,kGAEC,CAAA,KAAA,QAAA,MAAAC,EAAA,MAAA,MAAA,SAAA,GAEDC,EAAA,KAAAF,CAAA,CACD,CAAA,GAGD,CACD,CACD,WAlJE,MAAA,uDAiBE,MAAA,8CAUA,MAAA,0CAuBE,MAAA,gIAnDLG,IAAAC,EAAA,MAAAC,EAAA,UAMgBC,GAAAC,EAAAC,EAAA,WAAA,UAAA,YAAAD,EAAA,OAAA,MAAAD,EAAA,gBAAhBH,IAAAC,EAAA,MAAAK,EAAA,WAPD,QAAAC,EAAA,IAAA,MAUK,QAAAC,EAAA,QACA,QAAA,iGAGA,EACA,KAAAC,EAAA,mBACD,MAAA,2FAIsDJ,EAAA,WAAA,eAAA,KAAA,QAAA,GAFvDL,IAAAC,EAAA,MAAAS,EAAA,SAlBHC,EAAA,GAAA,EAAA,wCA8B2DN,EAAA,WAAA,eAAA,KAAA,QAAA,+BA9B3DM,EAAA,GAAA,EAAA,oCAuCuDN,EAAA,WAAA,eAAA,KAAA,uBAKlD,QAAAA,EAAA,WAAA,eAAA,QACD,YAAA,aACC,QAAAO,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAL,EAAA,WAAA,MA9CL,QAAAD,EAAA,IAAAK,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAAE,EAAA,aAAA,0BAAAH,EAAA,GAAA,EAAA,cAoDCX,EAAA,EAAAC,EAAA,MAAAc,EAAAH,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CACCI,EAAA,OAAA,CAAA,MAAA,+BAAA,EAAA,sEAAA,EAAA"}