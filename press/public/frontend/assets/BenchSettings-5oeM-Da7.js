import{_ as k}from"./Tags-ByxkPMV0.js";import{_ as D}from"./Card-BCzTSeNK.js";import{x as b,h as r,o as t,w as d,j as S,A as f,q as h,F as w,v as N,aA as V,u,X as B,Y as v,ae as C,a8 as I,r as R}from"./main-Dpl-JOF2.js";import{_ as $}from"./RichSelect-DPikL6tG.js";import{_ as T}from"./ListItem-CkkFcC1t.js";import{n as E}from"./toast-Dk0nDfLL.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},n=new Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="2f4d3303-d25e-41b8-98e4-2bcacd4de266",e._sentryDebugIdIdentifier="sentry-dbid-2f4d3303-d25e-41b8-98e4-2bcacd4de266")}catch(s){}})();{var _=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};_._sentryModuleMetadata=_._sentryModuleMetadata||{},_._sentryModuleMetadata[new Error().stack]=Object.assign({},_._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const O={name:"BenchRegions",props:["benchName"],components:{RichSelect:$},data(){return{selectedRegion:null,showAddRegionDialog:!1}},resources:{regions(){return{url:"press.api.bench.regions",params:{name:this.benchName},auto:!0}},availableRegions(){return{url:"press.api.bench.available_regions",params:{name:this.benchName},auto:!0,onSuccess(e){e.length&&(this.selectedRegion=e[0].name)}}},addRegion(){return{url:"press.api.bench.add_region",onSuccess(){window.location.reload()}}}},computed:{regionOptions(){let e=this.$resources.availableRegions.data;return e?e.map(n=>({label:n.title,value:n.name,image:n.image,beta:n.beta})):[]},showAddRegionButton(){let e=this.$resources.regions.data;return e&&e.length<2}}},U={class:"divide-y"};function x(e,n,s,y,o,l){const c=B,p=T,m=C,i=$,g=V,A=D;return t(),r(A,{title:"Regions",subtitle:"Regions available for your bench",loading:e.$resources.regions.loading},{actions:d(()=>[l.showAddRegionButton?(t(),r(c,{key:0,onClick:n[0]||(n[0]=a=>{e.$resources.availableRegions.data||e.$resources.availableRegions.fetch(),o.showAddRegionDialog=!0})},{default:d(()=>n[4]||(n[4]=[v(" Add Region ")])),_:1})):u("",!0)]),default:d(()=>[S("div",U,[(t(!0),h(w,null,N(e.$resources.regions.data,a=>(t(),r(p,{key:a.name,title:a.title,image:a.image},null,8,["title","image"]))),128))]),f(g,{options:{title:"Select secondary region for your bench"},modelValue:o.showAddRegionDialog,"onUpdate:modelValue":n[3]||(n[3]=a=>o.showAddRegionDialog=a)},{"body-content":d(()=>[e.$resources.availableRegions.loading?(t(),r(m,{key:0,class:"py-2"})):u("",!0),f(i,{value:o.selectedRegion,onChange:n[1]||(n[1]=a=>o.selectedRegion=a),options:l.regionOptions},null,8,["value","options"])]),actions:d(()=>[o.selectedRegion?(t(),r(c,{key:0,variant:"solid",class:"w-full",loading:e.$resources.addRegion.loading,onClick:n[2]||(n[2]=a=>e.$resources.addRegion.submit({name:s.benchName,region:o.selectedRegion}))},{default:d(()=>n[5]||(n[5]=[v(" Add ")])),_:1},8,["loading"])):u("",!0)]),_:1},8,["modelValue"])]),_:1},8,["loading"])}const j=b(O,[["render",x]]),F={name:"BenchDependencies",props:["benchName"],data(){return{isDirty:!1}},resources:{dependencies(){return{url:"press.api.bench.dependencies",params:{name:this.benchName},auto:!0,initialData:[]}},updateDependencies(){return{url:"press.api.bench.update_dependencies",params:{name:this.benchName,dependencies:JSON.stringify(this.dependencies.active_dependencies)},validate(){if(!this.isDirty)return"No changes made"},onSuccess(){this.isDirty=!1},onError(e){E({title:"Error",message:(e.messages||e.message.split("_")).join(", "),icon:"x",color:"red"})}}}},computed:{dependencies(){return this.$resources.dependencies.data},activeDependencies(){return this.dependencies.active_dependencies.filter(e=>!this.dependencies.internal_dependencies.includes(e.key))}},methods:{dependencySelectOptions(e){return this.dependencies.supported_dependencies.filter(s=>s.key===e).map(s=>({label:s.value,value:s.value}))}}},L={key:0,class:"ml-0.5 mt-2.5 text-base text-red-600"};function M(e,n,s,y,o,l){const c=B,p=I,m=D;return t(),r(m,{title:"Dependencies",subtitle:"Update dependencies for your bench",loading:e.$resources.dependencies.loading},{actions:d(()=>[o.isDirty?(t(),r(c,{key:0,label:"Update",onClick:n[0]||(n[0]=i=>e.$resources.updateDependencies.submit()),loading:e.$resources.updateDependencies.loading},null,8,["loading"])):u("",!0)]),default:d(()=>[(t(!0),h(w,null,N(l.activeDependencies,i=>(t(),r(p,{key:i.key,type:"select",modelValue:i.value,"onUpdate:modelValue":g=>i.value=g,options:l.dependencySelectOptions(i.key),value:i.value,label:l.dependencies.dependency_title[i.key],class:"mx-0.5 my-2",onInput:n[1]||(n[1]=g=>o.isDirty=!0)},null,8,["modelValue","onUpdate:modelValue","options","value","label"]))),128)),l.dependencies.update_available?(t(),h("p",L," The changes will take effect in your next bench deploy. ")):u("",!0)]),_:1},8,["loading"])}const q=b(F,[["render",M]]),J={name:"BenchSettings",props:["bench","benchName"],components:{Tags:k,BenchDependencies:q,BenchRegions:j}},K={class:"grid grid-cols-1 gap-5 sm:grid-cols-2"};function P(e,n,s,y,o,l){const c=k,p=R("BenchRegions"),m=R("BenchDependencies");return t(),h("div",K,[s.bench?(t(),r(c,{key:0,name:s.benchName,doctype:"Release Group",resourceTags:s.bench.bench_tags,tags:s.bench.tags},null,8,["name","resourceTags","tags"])):u("",!0),f(p,{benchName:s.benchName},null,8,["benchName"]),f(m,{benchName:s.benchName},null,8,["benchName"])])}const Z=b(J,[["render",P]]);export{Z as default};
//# sourceMappingURL=BenchSettings-5oeM-Da7.js.map
