var b=(t,e,n)=>new Promise((_,l)=>{var d=o=>{try{p(n.next(o))}catch(v){l(v)}},m=o=>{try{p(n.throw(o))}catch(v){l(v)}},p=o=>o.done?_(o.value):Promise.resolve(o.value).then(d,m);p((n=n.apply(t,e)).next())});import{_ as I}from"./WizardCard-D6pRuZbe.js";import{_ as U}from"./Steps-B0ktOnsZ.js";import{x as B,q as u,o as r,j as s,A as a,a8 as j,a9 as V,u as g,t as i,Y as x,r as S,h as k,w as y,ag as f,ah as h,c8 as z,X as F,n as W}from"./main-Dpl-JOF2.js";import{_ as M}from"./RichSelect-DPikL6tG.js";import{_ as A}from"./ServerPlansTable-BTTk3ODU.js";import{_ as D}from"./AlertBillingInformation-C5f9OKMF.js";import"./info-BXlf1Uhm.js";import"./Alert-COV4XS8q.js";import"./StripeLogo-BRF2qIyd.js";import"./stripe.esm-D4yu_pm0.js";import"./BillingInformationDialog-B5pmLI5R.js";import"./StripeCard-BRr8QCrN.js";import"./AddressForm-Cz0XUJgF.js";import"./Form-CIPLpg2e.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="71797185-1400-4282-8ee7-d686bcb0495d",t._sentryDebugIdIdentifier="sentry-dbid-71797185-1400-4282-8ee7-d686bcb0495d")}catch(n){}})();{var w=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};w._sentryModuleMetadata=w._sentryModuleMetadata||{},w._sentryModuleMetadata[new Error().stack]=Object.assign({},w._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const Y={name:"Hostname",props:["options","title","selectedRegion"],emits:["update:title","error","update:selectedRegion"],data(){return{errorMessage:null}},components:{RichSelect:M},computed:{regionOptions(){return this.options.regions.map(t=>({label:t.title,value:t.name,image:t.image,beta:t.beta}))}},mounted(){return b(this,null,function*(){this.regionOptions.length==1&&this.$emit("update:selectedRegion",this.regionOptions[0].value)})},methods:{titleChange(t){return b(this,null,function*(){let e=t.target.value;this.$emit("update:title",e);let n=this.validateTitle(e);this.errorMessage=n,this.$emit("error",n)})},validateTitle(t){return t?null:"Server name cannot be left blank"}}},q={class:"mt-4 flex"},K={class:"mt-6 space-y-1"},X={class:"mt-1"},J={class:"mt-4"};function L(t,e,n,_,l,d){const m=j,p=M,o=V;return r(),u("div",null,[e[3]||(e[3]=s("label",{class:"text-lg font-semibold"}," Choose a name for your server ",-1)),e[4]||(e[4]=s("p",{class:"text-base text-gray-700"}," Name your server based on its purpose. For e.g., Personal Websites, Staging Server, etc. ",-1)),s("div",q,[a(m,{class:"w-full",value:n.title,onChange:d.titleChange,placeholder:"Server"},null,8,["value","onChange"])]),s("div",K,[e[1]||(e[1]=s("h2",{class:"text-lg font-semibold"},"Select Region",-1)),e[2]||(e[2]=s("p",{class:"text-base text-gray-700"}," Select the datacenter region where your server should be created ",-1)),s("div",X,[a(p,{value:n.selectedRegion,onChange:e[0]||(e[0]=v=>t.$emit("update:selectedRegion",v)),options:d.regionOptions},null,8,["value","options"])])]),s("div",J,[a(o,{message:l.errorMessage},null,8,["message"])])])}const Q=B(Y,[["render",L]]),Z={name:"AppServerPlans",emits:["update:selectedAppPlan"],props:["options","selectedAppPlan","selectedRegion"],components:{ServerPlansTable:A,AlertBillingInformation:D},computed:{appPlanOptions(){return this.options.app_plans.filter(t=>t.cluster==this.selectedRegion)}}},G={class:"mt-4"};function ee(t,e,n,_,l,d){const m=D,p=A;return r(),u("div",null,[e[1]||(e[1]=s("label",{class:"text-lg font-semibold"}," Choose your application server plan ",-1)),e[2]||(e[2]=s("p",{class:"text-base text-gray-700"}," Select a plan based on the type of usage you are expecting on your application server. ",-1)),a(m,{class:"mt-4"}),s("div",G,[a(p,{plans:d.appPlanOptions,selectedPlan:n.selectedAppPlan,"onUpdate:selectedPlan":e[0]||(e[0]=o=>t.$emit("update:selectedAppPlan",o))},null,8,["plans","selectedPlan"])])])}const te=B(Z,[["render",ee]]),se={name:"DBServerPlans",emits:["update:selectedDBPlan"],props:["options","selectedDBPlan","selectedRegion"],components:{ServerPlansTable:A,AlertBillingInformation:D},computed:{dbPlanOptions(){return this.options.db_plans.filter(t=>t.cluster==this.selectedRegion)}}},ne={class:"mt-4"};function le(t,e,n,_,l,d){const m=D,p=A;return r(),u("div",null,[e[1]||(e[1]=s("label",{class:"text-lg font-semibold"}," Choose your database server plan ",-1)),e[2]||(e[2]=s("p",{class:"text-base text-gray-700"}," Select a plan based on the type of usage you are expecting on your database server. ",-1)),a(m,{class:"mt-4"}),s("div",ne,[a(p,{plans:d.dbPlanOptions,selectedPlan:n.selectedDBPlan,"onUpdate:selectedPlan":e[0]||(e[0]=o=>t.$emit("update:selectedDBPlan",o))},null,8,["plans","selectedPlan"])])])}const oe=B(se,[["render",le]]),ae={name:"VerifyServer",props:["options","selectedAppPlan","selectedDBPlan"],components:{},computed:{totalPlan(){return{plan_title:this.selectedAppPlan.plan_title+this.selectedDBPlan.plan_title,price_inr:this.selectedAppPlan.price_inr+this.selectedDBPlan.price_inr,price_usd:this.selectedAppPlan.price_usd+this.selectedDBPlan.price_usd}}}},ie={key:0,clas:"mt-4"},re={class:"focus-within:shadow-outline mt-2 flex rounded-md border px-4 py-3 text-left text-base"},de={class:"w-1/4 text-gray-900"},pe={class:"font-semibold"},ce={key:0},ue={class:"w-1/4 text-gray-900"},me={class:"w-1/4 text-gray-900"},ge={class:"w-1/4 text-gray-900"},_e={class:"w-1/4 text-gray-900"},ve={key:1,class:"mt-4"},fe={class:"focus-within:shadow-outline mt-2 flex rounded-md border px-4 py-3 text-left text-base"},Pe={class:"w-1/4 text-gray-900"},be={class:"font-semibold"},ye={key:0},he={class:"w-1/4 text-gray-900"},Be={class:"w-1/4 text-gray-900"},we={class:"w-1/4 text-gray-900"},Se={class:"w-1/4 text-gray-900"},xe={key:2,class:"mt-4"},Ae={class:"text-base text-gray-700"},De={class:"font-semibold"};function Ce(t,e,n,_,l,d){return r(),u("div",null,[e[3]||(e[3]=s("div",{class:"mb-2"},[s("p",{class:"text-base text-gray-700"}," You have selected following server plans ")],-1)),n.selectedAppPlan?(r(),u("div",ie,[e[0]||(e[0]=s("label",{class:"text-base font-semibold"},"Application Server",-1)),s("div",re,[s("div",de,[s("span",pe,i(t.$planTitle(n.selectedAppPlan)),1),n.selectedAppPlan.price_usd>0?(r(),u("span",ce," /mo")):g("",!0)]),s("div",ue,i(n.selectedAppPlan.vcpu)+" "+i(t.$plural(n.selectedAppPlan.vcpu,"vCPU","vCPUs")),1),s("div",me,i(t.formatBytes(n.selectedAppPlan.memory,0,2)),1),s("div",ge,i(n.selectedAppPlan.instance_type),1),s("div",_e,i(t.formatBytes(n.selectedAppPlan.disk,0,3)),1)])])):g("",!0),n.selectedDBPlan?(r(),u("div",ve,[e[1]||(e[1]=s("label",{class:"text-base font-semibold"},"Database Server",-1)),s("div",fe,[s("div",Pe,[s("span",be,i(t.$planTitle(n.selectedDBPlan)),1),n.selectedDBPlan.price_usd>0?(r(),u("span",ye," /mo")):g("",!0)]),s("div",he,i(n.selectedDBPlan.vcpu)+" "+i(t.$plural(n.selectedDBPlan.vcpu,"vCPU","vCPUs")),1),s("div",Be,i(t.formatBytes(n.selectedDBPlan.memory,0,2)),1),s("div",we,i(n.selectedDBPlan.instance_type),1),s("div",Se,i(t.formatBytes(n.selectedDBPlan.disk,0,3)),1)])])):g("",!0),this.selectedAppPlan&&this.selectedDBPlan?(r(),u("div",xe,[s("p",Ae,[e[2]||(e[2]=x(" Your monthly bill will be ")),s("span",De,i(t.$planTitle(d.totalPlan)),1)])])):g("",!0)])}const Re=B(ae,[["render",Ce]]),ke={name:"NewServer",components:{WizardCard:I,Steps:U,Hostname:Q,AppServerPlans:te,DBServerPlans:oe,VerifyServer:Re},data(){return{title:null,options:null,selectedRegion:null,selectedAppPlan:null,selectedDBPlan:null,validationMessage:null,steps:[{name:"Hostname",validate:()=>this.title&&this.selectedRegion},{name:"AppServerPlan",validate:()=>this.selectedAppPlan},{name:"DBServerPlan",validate:()=>this.selectedDBPlan},{name:"VerifyServer"}],agreedToRegionConsent:!1}},mounted(){return b(this,null,function*(){this.options=yield this.$call("press.api.server.options"),this.options.app_plans=this.options.app_plans.map(t=>(t.disabled=!this.$account.hasBillingInfo,t)),this.options.db_plans=this.options.db_plans.map(t=>(t.disabled=!this.$account.hasBillingInfo,t))})},resources:{newServer(){var t,e;return{url:"press.api.server.new",params:{server:{title:this.title,cluster:this.selectedRegion,app_plan:(t=this.selectedAppPlan)==null?void 0:t.name,db_plan:(e=this.selectedDBPlan)==null?void 0:e.name}},onSuccess(n){let{server:_}=n;this.$router.push(`/servers/${_}/install`)},validate(){let n=this.title&&this.selectedAppPlan&&this.selectedDBPlan&&this.selectedRegion;if(!this.selectedAppPlan)return"Please select a plan for application server";if(!this.selectedDBPlan)return"Please select a plan for database server";if(!this.selectedRegion)return"Please select the region";if(!this.agreedToRegionConsent)return document.getElementById("region-consent").focus(),"Please agree to the above consent to create server";if(!n)return"Cannot create server"}}}},computed:{},methods:{nextStep(t,e){return b(this,null,function*(){e()})}}},Te={class:"mt-4"},$e={key:0,class:"my-6"},Ie={class:"flex justify-between"};function Ue(t,e,n,_,l,d){const m=S("Hostname"),p=S("AppServerPlans"),o=S("DBServerPlans"),v=S("VerifyServer"),T=V,C=F,O=U,E=I;return l.options?(r(),k(E,{key:0},{default:y(()=>[e[11]||(e[11]=s("div",{class:"mb-6 text-center"},[s("h1",{class:"text-2xl font-bold"},"Create a new server")],-1)),a(O,{steps:l.steps},{default:y(({active:P,next:H,previous:N,hasPrevious:$,hasNext:R})=>[e[10]||(e[10]=s("div",{class:"mt-8"},null,-1)),f(a(m,{options:l.options,title:l.title,"onUpdate:title":e[0]||(e[0]=c=>l.title=c),selectedRegion:l.selectedRegion,"onUpdate:selectedRegion":e[1]||(e[1]=c=>l.selectedRegion=c)},null,8,["options","title","selectedRegion"]),[[h,P.name==="Hostname"]]),f(a(p,{selectedAppPlan:l.selectedAppPlan,"onUpdate:selectedAppPlan":e[2]||(e[2]=c=>l.selectedAppPlan=c),options:l.options,selectedRegion:l.selectedRegion},null,8,["selectedAppPlan","options","selectedRegion"]),[[h,P.name==="AppServerPlan"]]),f(a(o,{selectedDBPlan:l.selectedDBPlan,"onUpdate:selectedDBPlan":e[3]||(e[3]=c=>l.selectedDBPlan=c),options:l.options,selectedRegion:l.selectedRegion},null,8,["selectedDBPlan","options","selectedRegion"]),[[h,P.name==="DBServerPlan"]]),f(a(v,{options:l.options,selectedAppPlan:l.selectedAppPlan,selectedDBPlan:l.selectedDBPlan},null,8,["options","selectedAppPlan","selectedDBPlan"]),[[h,P.name==="VerifyServer"]]),a(T,{message:l.validationMessage},null,8,["message"]),s("div",Te,[R?g("",!0):(r(),u("div",$e,[f(s("input",{id:"region-consent",type:"checkbox",class:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500","onUpdate:modelValue":e[4]||(e[4]=c=>l.agreedToRegionConsent=c)},null,512),[[z,l.agreedToRegionConsent]]),e[6]||(e[6]=s("label",{for:"region-consent",class:"ml-1 text-sm font-semibold text-gray-900"}," I agree that the laws of the region selected by me shall stand applicable to me and Frappe. ",-1))])),a(T,{class:"mb-4",message:t.$resources.newServer.error},null,8,["message"]),s("div",Ie,[$?(r(),k(C,{key:0,onClick:N},{default:y(()=>e[7]||(e[7]=[x(" Back ")])),_:2},1032,["onClick"])):g("",!0),R?(r(),k(C,{key:1,class:W(["ml-auto",{"mt-2":$}]),variant:"solid",onClick:c=>d.nextStep(P,H)},{default:y(()=>e[8]||(e[8]=[x(" Next ")])),_:2},1032,["onClick","class"])):g("",!0),f(a(C,{variant:"solid",class:"ml-auto",onClick:e[5]||(e[5]=c=>t.$resources.newServer.submit()),loading:t.$resources.newServer.loading},{default:y(()=>e[9]||(e[9]=[x(" Create Servers ")])),_:2},1032,["loading"]),[[h,!R]])])])]),_:1},8,["steps"])]),_:1})):g("",!0)}const Le=B(ke,[["render",Ue]]);export{Le as default};
//# sourceMappingURL=NewServer-DLuVFRSU.js.map
