import{x,h,o as a,w as c,q as u,u as m,A as l,j as r,Y as P,t as o,F as A,v as E,aA as C,a9 as O,X as B,a4 as T,b3 as L,b4 as M,a8 as F,r as j,aK as R,y as K,ac as Y,Z as f}from"./main-Dpl-JOF2.js";import{_ as N}from"./Card-BCzTSeNK.js";import{_ as V}from"./ServerPlansTable-BTTk3ODU.js";import{_ as I}from"./ProgressArc-E4zT-R3H.js";import{P as U}from"./PlanIcon-xHfeoGnX.js";import{n as k}from"./toast-Dk0nDfLL.js";import{_ as q}from"./ListItem-CkkFcC1t.js";import"./info-BXlf1Uhm.js";(function(){try{var s=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[e]="da4b6509-12a6-4054-b710-5ed79ab54230",s._sentryDebugIdIdentifier="sentry-dbid-da4b6509-12a6-4054-b710-5ed79ab54230")}catch(t){}})();{var b=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};b._sentryModuleMetadata=b._sentryModuleMetadata||{},b._sentryModuleMetadata[new Error().stack]=Object.assign({},b._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const z={name:"ServerOverviewPlan",props:["server","plan"],components:{ServerPlansTable:V,ProgressArc:I,PlanIcon:U},data(){return{showChangePlanDialog:!1,selectedPlan:null}},resources:{usageResource(){var s;return{url:"press.api.server.usage",params:{name:(s=this.server)==null?void 0:s.name},initialData:{},auto:!0}},plans(){return{url:"press.api.server.plans",params:{name:"Server",cluster:this.server.region_info.name},initialData:[]}},changePlan(){var s,e;return{url:"press.api.server.change_plan",params:{name:(s=this.server)==null?void 0:s.name,plan:(e=this.selectedPlan)==null?void 0:e.name},onSuccess(){k({title:`Plan changed to ${this.selectedPlan.plan_title}`,icon:"check",color:"green"}),this.showChangePlanDialog=!1,this.selectedPlan=null,this.$emit("plan-change"),this.$resources.plans.reset()},onError(t){this.showChangePlanDialog=!1,k({title:t,icon:"x",color:"red"})}}}},methods:{plan_title(s){let e=this.$account.team.country=="India",t=e?"â‚¹":"$",n=s[e?"price_inr":"price_usd"];return n>0?`${t}${n}`:s.plan_title}},computed:{plans(){return this.$resources.plans.data.map(e=>(this.plan.name===e.name&&(e.disabled=!0),e))},used(){return this.$resources.usageResource.data},usage(){return[{label:"CPU",value:`${this.used.vcpu} / ${this.plan.vcpu} ${this.$plural(this.plan.vcpu,"vCPU","vCPUs")}`,percentage:this.used.vcpu/this.plan.vcpu*100},{label:"Memory",value:`${this.formatBytes(this.used.memory,0,2)} / ${this.formatBytes(this.plan.memory,0,2)}`,percentage:this.used.memory/this.plan.memory*100},{label:"Storage",value:`${this.formatBytes(this.used.disk,0,3)} / ${this.formatBytes(this.plan.disk,0,3)}`,percentage:this.used.disk/this.plan.disk*100}]}}},X={key:0,class:"flex items-center rounded-lg bg-gray-50 p-5"},Z={class:"ml-4"},H={class:"text-4xl font-semibold text-gray-900"},J={key:0,class:"text-lg"},Q={class:"text-base text-gray-700"},W={key:1,class:"mt-4 grid grid-cols-3 gap-12"},G={class:"mt-2 text-base font-medium text-gray-900"},ee={class:"mt-1 text-xs text-gray-600"};function se(s,e,t,y,n,i){const v=B,g=U,_=I,p=V,w=O,S=C,$=N;return a(),h($,{title:"Plan",subtitle:"Upgrade or downgrade your plan based on your usage"},{actions:c(()=>[l(v,{onClick:e[0]||(e[0]=()=>{n.showChangePlanDialog=!0,!i.plans.length&&s.$resources.plans.fetch()})},{default:c(()=>e[3]||(e[3]=[P(" Change ")])),_:1})]),default:c(()=>{var D;return[t.plan?(a(),u("div",X,[l(g),r("div",Z,[r("h4",H,[P(o(s.$planTitle(t.plan))+" ",1),t.plan.price_usd>0?(a(),u("span",J," /mo ")):m("",!0)]),r("p",Q,o(t.plan.vcpu)+" "+o(s.$plural(t.plan.vcpu,"vCPU","vCPUs"))+" + "+o(s.formatBytes(t.plan.memory,0,2))+" Memory + "+o(s.formatBytes(t.plan.disk,0,3))+" Storage ",1)])])):m("",!0),t.plan&&((D=i.used)!=null&&D.memory)?(a(),u("div",W,[(a(!0),u(A,null,E(i.usage,d=>(a(),u("div",{key:d.label},[l(_,{percentage:d.percentage},null,8,["percentage"]),r("div",G,o(d.label)+" "+o(isNaN(d.percentage)?"":`(${Number(d.percentage).toFixed(1)}%)`),1),r("div",ee,o(d.value),1)]))),128))])):m("",!0),l(S,{options:{title:"Change Plan",actions:[{label:"Submit",variant:"solid",loading:s.$resources.changePlan.loading,onClick:()=>s.$resources.changePlan.submit()}]},modelValue:n.showChangePlanDialog,"onUpdate:modelValue":e[2]||(e[2]=d=>n.showChangePlanDialog=d)},{"body-content":c(()=>[l(p,{class:"mt-6",plans:i.plans,selectedPlan:n.selectedPlan,"onUpdate:selectedPlan":e[1]||(e[1]=d=>n.selectedPlan=d)},null,8,["plans","selectedPlan"]),l(w,{class:"mt-4",message:s.$resources.changePlan.error},null,8,["message"])]),_:1},8,["options","modelValue"])]}),_:1})}const te=x(z,[["render",se]]),re={name:"ServerDrop",props:["server"],data(){return{dialogOpen:!1,confirmServerName:null}},resources:{dropServer(){var s;return{url:"press.api.server.archive",params:{name:(s=this.server)==null?void 0:s.name},onSuccess(){this.dialogOpen=!1,this.$router.push("/servers")},validate(){var e;if(((e=this.server)==null?void 0:e.name)!==this.confirmServerName)return"Please type the server name to confirm"}}}},methods:{showDialog(){this.dialogOpen=!0}}},ne={class:"shrink-0"},ae={class:"mt-4 text-base"},oe={class:"font-semibold"};function le(s,e,t,y,n,i){const v=F,g=O,_=C;return a(),u("div",ne,[T(s.$slots,"default",L(M({showDialog:i.showDialog}))),l(_,{options:{title:"Drop Server",actions:[{label:"Drop Server",variant:"solid",theme:"red",loading:s.$resources.dropServer.loading,onClick:()=>s.$resources.dropServer.submit()}]},modelValue:n.dialogOpen,"onUpdate:modelValue":e[1]||(e[1]=p=>n.dialogOpen=p)},{"body-content":c(()=>[e[4]||(e[4]=r("p",{class:"text-base"}," Are you sure you want to drop your server? The server will be archived and all of the benches and sites on it will be deleted. This action cannot be undone. ",-1)),r("p",ae,[e[2]||(e[2]=P(" Please type ")),r("span",oe,o(t.server.name),1),e[3]||(e[3]=P(" to confirm. "))]),l(v,{class:"mt-4 w-full",modelValue:n.confirmServerName,"onUpdate:modelValue":e[0]||(e[0]=p=>n.confirmServerName=p)},null,8,["modelValue"]),l(g,{class:"mt-2",message:s.$resources.dropServer.error},null,8,["message"])]),_:1},8,["options","modelValue"])])}const ie=x(re,[["render",le]]),de={name:"ServerOverviewInfo",props:["server","info"],components:{ServerDrop:ie},data(){return{loading:!1}},computed:{permissions(){return{drop:this.$account.hasPermission(this.server.name,"press.api.server.archive")}}}},ce={class:"divide-y"},ue={class:"flex items-center py-3"},me={class:"ml-3 flex flex-1 items-center justify-between"},pe={class:"text-base font-medium text-gray-900"},ve={class:"text-right"},ge={class:"text-base font-medium text-gray-900"},_e={key:0,class:"text-right"},fe={class:"text-base font-medium text-gray-900"};function he(s,e,t,y,n,i){const v=R,g=B,_=K,p=j("ServerDrop"),w=q,S=N;return a(),h(S,{title:"Server Info",subtitle:"General information about your server"},{default:c(()=>[r("div",ce,[r("div",ue,[t.info.owner?(a(),h(v,{key:0,image:t.info.owner.user_image,label:t.info.owner.first_name},null,8,["image","label"])):m("",!0),r("div",me,[r("div",null,[e[0]||(e[0]=r("div",{class:"text-base text-gray-600"},"Owned By",-1)),r("div",pe,o(t.info.owner.first_name)+" "+o(t.info.owner.last_name),1)]),r("div",ve,[e[1]||(e[1]=r("div",{class:"text-base text-gray-600"},"Created On",-1)),r("div",ge,o(s.formatDate(t.info.created_on,"DATE_FULL")),1)]),t.info.last_deployed?(a(),u("div",_e,[e[2]||(e[2]=r("div",{class:"text-base text-gray-600"},"Last Deployed",-1)),r("div",fe,o(s.$date(t.info.last_deployed).toLocaleString({month:"long",day:"numeric"})),1)])):m("",!0)])]),t.server.status!=="Pending"?(a(),h(w,{key:0,title:"Drop Server",description:"Once you drop server your server, there is no going back"},{actions:c(()=>[l(p,{server:t.server},{default:c(({showDialog:$})=>[l(_,{text:i.permissions.drop?"Drop Site":"You don't have enough permissions to perform this action"},{default:c(()=>[l(g,{theme:"red",onClick:$,disabled:!i.permissions.drop},{default:c(()=>e[3]||(e[3]=[r("span",{class:"text-red-600"},"Drop Server",-1)])),_:2},1032,["onClick","disabled"])]),_:2},1032,["text"])]),_:1},8,["server"])]),_:1})):m("",!0)])]),_:1})}const ye=x(de,[["render",he]]),be={key:0,class:"space-y-5"},Pe={key:0,class:"grid grid-cols-1 gap-5 sm:grid-cols-2"},Be={__name:"ServerOverview",props:{server:Object,serverName:String},setup(s){const t=Y({url:"press.api.server.overview",params:{name:s.serverName},auto:!0});return(y,n)=>s.server?(a(),u("div",be,[s.server&&f(t).data?(a(),u("div",Pe,[f(t).data.plan?(a(),h(te,{key:0,server:s.server,plan:f(t).data.plan,onPlanChange:n[0]||(n[0]=i=>f(t).reload())},null,8,["server","plan"])):m("",!0),l(ye,{server:s.server,info:f(t).data.info},null,8,["server","info"])])):m("",!0)])):m("",!0)}};export{Be as default};
//# sourceMappingURL=ServerOverview-Bw0l8xn-.js.map
