var L=(e,t,r)=>new Promise((o,a)=>{var i=n=>{try{s(r.next(n))}catch(c){a(c)}},v=n=>{try{s(r.throw(n))}catch(c){a(c)}},s=n=>n.done?o(n.value):Promise.resolve(n.value).then(i,v);s((r=r.apply(e,t)).next())});import{E as q,l as j,J as $,m as U,q as b,o as u,u as F,A as d,ag as _,t as V,w as f,Z as y,bF as M,j as h,ch as z,F as J,v as K,h as C,ci as R,n as W,k as Q,X as P,Y as X,ah as k,cj as Y,ck as Z,cl as H,B as G,x as ee,a9 as te,r as ae,aA as le,V as oe,av as se}from"./main-Dpl-JOF2.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="3d4e12cc-0956-4cd0-b22e-a1a9f8dab8b9",e._sentryDebugIdIdentifier="sentry-dbid-3d4e12cc-0956-4cd0-b22e-a1a9f8dab8b9")}catch(r){}})();{var x=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};x._sentryModuleMetadata=x._sentryModuleMetadata||{},x._sentryModuleMetadata[new Error().stack]=Object.assign({},x._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const ne={class:"relative space-y-1.5"},re={key:0,class:"block text-xs text-gray-600"},ue={class:"border-outline-gray-1 bg-surface-gray-1 text-text-icons-gray-8 hover:border-outline-gray-2 hover:bg-surface-gray-1 form-input flex h-7 w-full items-center justify-between gap-2 rounded p-0 text-sm transition-colors"},ce={class:"w-full list-none bg-white px-1.5 py-1.5"},de={key:0,class:"!text-text-icons-gray-5 flex w-full items-center gap-2 px-2.5 pb-2 pt-3 text-xs font-medium"},ie={key:0,class:"border-outline-gray-2 bg-surface-gray-1 sticky bottom-0 rounded-b-sm border-t"},ge=q({__name:"Autocomplete",props:{options:{type:Array,default:()=>[]},modelValue:{},placeholder:{type:String,default:""},label:{type:String,default:""},allowInputAsOption:{type:Boolean,default:!1},actionButton:{type:Object,default:null}},emits:["update:modelValue"],setup(e,{emit:t}){const r=t,o=e,a=j(""),i=$(()=>Array.isArray(o.modelValue)),v=$(()=>!i.value),s=j(o.options),n=l=>Array.isArray(l)?l.map(m=>m.label).join(", "):l&&(l.label||l.value)||"",c=$(()=>o.modelValue?s.value.find(l=>l.value===o.modelValue)||{label:o.modelValue,value:o.modelValue}:null);U(()=>a.value||o.options,I,{immediate:!0});function I(){return L(this,null,function*(){a.value?s.value=o.options.filter(l=>{const m=l.label.toLowerCase(),B=l.label.toLowerCase(),T=a.value.toLowerCase();return m.includes(T)||B.includes(a.value)}):s.value=o.options})}function S(l){a.value=l.target.value,o.allowInputAsOption&&!s.value.length&&r("update:modelValue",a.value)}const E=()=>r("update:modelValue",null);return(l,m)=>{const B=P,T=G;return u(),b("div",ne,[e.label?(u(),b("label",re,V(e.label),1)):F("",!0),d(y(H),{modelValue:c.value,"onUpdate:modelValue":m[0]||(m[0]=p=>{r("update:modelValue",p==null?void 0:p.value)}),nullable:v.value,multiple:i.value},{default:f(({open:p})=>[d(y(M),{class:"w-full",ref:"rootRef"},{target:f(({togglePopover:A})=>[_(d(y(Y),{ref:"comboboxButton"},null,512),[[k,!1]]),h("div",ue,[d(y(Z),{autocomplete:"off",onFocus:()=>{var D;A(),p.value||(D=l.$refs.comboboxButton)==null||D.$el.click()},onChange:S,displayValue:n,placeholder:e.modelValue?null:e.placeholder,class:"focus:ring-outline-gray-3 h-full w-full rounded border border-gray-100 bg-gray-100 bg-transparent pl-2 pr-5 text-base text-gray-800 placeholder-gray-500 transition-colors focus:border-gray-500 focus:bg-white focus:shadow-sm focus:ring-0 focus-visible:ring-2 focus-visible:ring-gray-400"},null,8,["onFocus","placeholder"])])]),body:f(({isOpen:A,togglePopover:D})=>[_(h("div",null,[_(d(y(z),{class:"bg-surface-white absolute right-0 z-[999] max-h-[15rem] w-full overflow-y-auto rounded-lg p-0 shadow-2xl"},{default:f(()=>{var O;return[h("div",ce,[(u(!0),b(J,null,K(s.value,g=>(u(),C(y(R),{key:g.value,value:g,disabled:String(g.value).startsWith("_separator"),title:g.label,class:"flex items-center",onClick:()=>{var w;p.value||(w=l.$refs.comboboxButton)==null||w.$el.click()}},{default:f(({active:w,selected:N})=>[String(g.value).startsWith("_separator")?(u(),b("span",de,V(g.label),1)):(u(),b("li",{key:1,class:W(["flex w-full cursor-pointer select-none items-center justify-between truncate rounded px-2.5 py-1.5 text-base",{"bg-gray-100":w,"bg-gray-300":N}])},V(g.label),3))]),_:2},1032,["value","disabled","title","onClick"]))),128))]),e.actionButton?(u(),b("div",ie,[(O=e.actionButton)!=null&&O.component?(u(),C(Q(e.actionButton.component),{key:0,onChange:I},null,32)):(u(),C(B,{key:1,iconLeft:e.actionButton.icon,class:"text-text-icons-gray-8 w-full rounded-none text-xs",onClick:e.actionButton.handler},{default:f(()=>[X(V(e.actionButton.label),1)]),_:1},8,["iconLeft","onClick"]))])):F("",!0)]}),_:2},1536),[[k,s.value.length]])],512),[[k,A]])]),_:2},1536)]),_:1},8,["modelValue","nullable","multiple"]),_(h("div",{class:"text-text-icons-gray-4 hover:text-text-icons-gray-5 absolute right-[1px] top-[3px] cursor-pointer p-1",onClick:E},[d(T,{name:"x",class:"mt-3.5 h-4 w-4 stroke-gray-700"})],512),[[k,e.modelValue]])])}}}),fe={name:"TagsDialog",props:["docname","doctype"],components:{ErrorMessage:te,PressAutocomplete:ge},data(){return{showDialog:!0,newTag:"",selectedTag:null}},resources:{availableTags(){return{type:"list",doctype:"Press Tag",filters:{doctype_name:this.doctype},fields:["tag"],pageLength:1e3,auto:!0}}},computed:{$doc(){return se(this.doctype,this.docname)},tagOptions(){const e=this.$doc.doc.tags.map(t=>t.tag_name);return[...(this.$resources.availableTags.data||[]).filter(t=>!e.includes(t.tag)).map(t=>({label:t.tag||"No label",value:t.tag}))]}},methods:{addTag(){const e=this.selectedTag;oe.promise(this.$doc.addTag.submit({tag:e}),{success:()=>(this.selectedTag=null,"Tag added successfully"),loading:"Adding tag...",error:"Failed to add tag"})}}},me={class:"space-y-4"},pe={class:"flex items-center space-x-2"};function be(e,t,r,o,a,i){const v=ae("PressAutocomplete"),s=P,n=le;return u(),C(n,{modelValue:a.showDialog,"onUpdate:modelValue":t[1]||(t[1]=c=>a.showDialog=c),options:{title:"Add Tag"}},{"body-content":f(()=>[h("div",me,[h("div",pe,[d(v,{modelValue:a.selectedTag,"onUpdate:modelValue":t[0]||(t[0]=c=>a.selectedTag=c),options:i.tagOptions,label:"Select or create a tag",allowInputAsOption:!0,class:"w-full"},null,8,["modelValue","options"]),d(s,{label:"Add","icon-left":"plus",onClick:i.addTag,class:"mt-5",disabled:!a.selectedTag},null,8,["onClick","disabled"])])])]),_:1},8,["modelValue"])}const ve=ee(fe,[["render",be]]);export{ve as default};
//# sourceMappingURL=TagsDialog-CQrOPzan.js.map
