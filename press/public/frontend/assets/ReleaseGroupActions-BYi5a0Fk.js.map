{"version":3,"file":"ReleaseGroupActions-BYi5a0Fk.js","sources":["../../../../dashboard/src2/components/group/ReleaseGroupActionCell.vue","../../../../dashboard/src2/components/group/ReleaseGroupActions.vue"],"sourcesContent":["<template>\n\t<div class=\"flex items-center justify-between gap-1\">\n\t\t<div>\n\t\t\t<h3 class=\"text-base font-medium\">{{ props.actionLabel }}</h3>\n\t\t\t<p class=\"mt-1 text-p-base text-gray-600\">{{ props.description }}</p>\n\t\t</div>\n\t\t<Button\n\t\t\tv-if=\"releaseGroup?.doc\"\n\t\t\tclass=\"whitespace-nowrap\"\n\t\t\t@click=\"getBenchActionHandler(props.actionLabel)\"\n\t\t>\n\t\t\t<p\n\t\t\t\t:class=\"\n\t\t\t\t\tgroup === 'Dangerous Actions' ? 'text-red-600' : 'text-gray-800'\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\t{{ props.buttonLabel }}\n\t\t\t</p>\n\t\t</Button>\n\t</div>\n</template>\n\n<script setup>\nimport { getCachedDocumentResource } from 'frappe-ui';\nimport { toast } from 'vue-sonner';\nimport { confirmDialog } from '../../utils/components';\nimport router from '../../router';\n\nconst props = defineProps({\n\tbenchName: { type: String, required: true },\n\tactionLabel: { type: String, required: true },\n\tmethod: { type: String, required: true },\n\tdescription: { type: String, required: true },\n\tbuttonLabel: { type: String, required: true },\n\tgroup: { type: String, required: false }\n});\n\nconst releaseGroup = getCachedDocumentResource(\n\t'Release Group',\n\tprops.benchName\n);\n\nfunction getBenchActionHandler(action) {\n\tconst actionHandlers = {\n\t\t'Rename Bench Group': onRenameBench,\n\t\t'Transfer Bench Group': onTransferBench,\n\t\t'Drop Bench Group': onDropBench\n\t};\n\tif (actionHandlers[action]) {\n\t\tactionHandlers[action].call(this);\n\t}\n}\n\nfunction onRenameBench() {\n\tconfirmDialog({\n\t\ttitle: 'Rename Bench Group',\n\t\tfields: [\n\t\t\t{\n\t\t\t\tlabel: 'Enter new bench group name',\n\t\t\t\tfieldname: 'newBenchName'\n\t\t\t}\n\t\t],\n\t\tonSuccess({ hide, values }) {\n\t\t\tif (values.newBenchName) {\n\t\t\t\ttoast.promise(\n\t\t\t\t\treleaseGroup.setValue.submit(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: values.newBenchName\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tonSuccess() {\n\t\t\t\t\t\t\t\thide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t),\n\t\t\t\t\t{\n\t\t\t\t\t\tloading: 'Renaming bench group...',\n\t\t\t\t\t\tsuccess: 'Bench group renamed successfully',\n\t\t\t\t\t\terror: 'Failed to rename bench group'\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttoast.error('Please enter a valid bench group name');\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction onTransferBench() {\n\tconfirmDialog({\n\t\ttitle: 'Transfer Bench Group Ownership',\n\t\tfields: [\n\t\t\t{\n\t\t\t\tlabel:\n\t\t\t\t\t'Enter email address of the team for transfer of bench group ownership',\n\t\t\t\tfieldname: 'email'\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: 'Reason for transfer',\n\t\t\t\tfieldname: 'reason',\n\t\t\t\ttype: 'textarea'\n\t\t\t}\n\t\t],\n\t\tprimaryAction: {\n\t\t\tlabel: 'Transfer',\n\t\t\tvariant: 'solid',\n\t\t\tonClick: ({ hide, values }) => {\n\t\t\t\tif (!values.email) {\n\t\t\t\t\tthrow new Error('Please enter a valid email address');\n\t\t\t\t}\n\n\t\t\t\treturn releaseGroup.sendTransferRequest\n\t\t\t\t\t.submit({ team_mail_id: values.email, reason: values.reason || '' })\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\thide();\n\t\t\t\t\t\ttoast.success(\n\t\t\t\t\t\t\t`Transfer request sent to ${values.email} successfully.`\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction onDropBench() {\n\tconfirmDialog({\n\t\ttitle: 'Drop Bench Group',\n\t\tmessage: `Are you sure you want to drop the bench group <b>${\n\t\t\treleaseGroup.doc.title || releaseGroup.name\n\t\t}</b>?`,\n\t\tfields: [\n\t\t\t{\n\t\t\t\tlabel: 'Please type the bench group name to confirm',\n\t\t\t\tfieldname: 'confirmBenchName'\n\t\t\t}\n\t\t],\n\t\tprimaryAction: {\n\t\t\tlabel: 'Drop',\n\t\t\ttheme: 'red',\n\t\t\tonClick: ({ hide, values }) => {\n\t\t\t\tif (releaseGroup.delete.loading) return;\n\t\t\t\tif (values.confirmBenchName !== releaseGroup.doc.title) {\n\t\t\t\t\tthrow new Error('Bench group name does not match');\n\t\t\t\t}\n\t\t\t\ttoast.promise(\n\t\t\t\t\treleaseGroup.delete.submit(null, {\n\t\t\t\t\t\tonSuccess: () => {\n\t\t\t\t\t\t\thide();\n\t\t\t\t\t\t\trouter.push({ name: 'Release Group List' });\n\t\t\t\t\t\t}\n\t\t\t\t\t}),\n\t\t\t\t\t{\n\t\t\t\t\t\tloading: 'Dropping bench group...',\n\t\t\t\t\t\tsuccess: 'Bench group dropped successfully',\n\t\t\t\t\t\terror: error =>\n\t\t\t\t\t\t\terror.messages.length\n\t\t\t\t\t\t\t\t? error.messages.join('\\n')\n\t\t\t\t\t\t\t\t: 'Failed to drop bench group'\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n}\n</script>\n","<template>\n\t<div class=\"mx-auto max-w-3xl space-y-4\" v-if=\"$releaseGroup?.doc?.actions\">\n\t\t<div\n\t\t\tv-for=\"group in actions\"\n\t\t\t:key=\"group.group\"\n\t\t\tclass=\"divide-y rounded border border-gray-200 p-5\"\n\t\t>\n\t\t\t<div class=\"pb-3 text-lg font-semibold\">{{ group.group }}</div>\n\t\t\t<div\n\t\t\t\tclass=\"py-3 first:pt-0 last:pb-0\"\n\t\t\t\tv-for=\"row in group.actions\"\n\t\t\t\t:key=\"row.action\"\n\t\t\t>\n\t\t\t\t<ReleaseGroupActionCell\n\t\t\t\t\t:benchName=\"releaseGroup\"\n\t\t\t\t\t:group=\"group.group\"\n\t\t\t\t\t:actionLabel=\"row.action\"\n\t\t\t\t\t:method=\"row.doc_method\"\n\t\t\t\t\t:description=\"row.description\"\n\t\t\t\t\t:buttonLabel=\"row.button_label\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport { getCachedDocumentResource } from 'frappe-ui';\nimport ReleaseGroupActionCell from './ReleaseGroupActionCell.vue';\n\nexport default {\n\tprops: ['releaseGroup'],\n\tcomponents: { ReleaseGroupActionCell },\n\tcomputed: {\n\t\t$releaseGroup() {\n\t\t\treturn getCachedDocumentResource('Release Group', this.releaseGroup);\n\t\t},\n\t\tactions() {\n\t\t\tconst groupedActions = this.$releaseGroup.doc.actions.reduce(\n\t\t\t\t(acc, action) => {\n\t\t\t\t\tconst group = action.group || 'General Actions';\n\t\t\t\t\tif (!acc[group]) {\n\t\t\t\t\t\tacc[group] = [];\n\t\t\t\t\t}\n\t\t\t\t\tacc[group].push(action);\n\t\t\t\t\treturn acc;\n\t\t\t\t},\n\t\t\t\t{}\n\t\t\t);\n\n\t\t\treturn Object.keys(groupedActions).map(group => ({\n\t\t\t\tgroup,\n\t\t\t\tactions: groupedActions[group]\n\t\t\t}));\n\t\t}\n\t}\n};\n</script>\n"],"names":["props","__props","releaseGroup","getCachedDocumentResource","getBenchActionHandler","action","actionHandlers","onRenameBench","onTransferBench","onDropBench","confirmDialog","hide","values","toast","router","error","_sfc_main","ReleaseGroupActionCell","acc","group","_hoisted_2","_openBlock","_createElementBlock","_hoisted_1","_Fragment","_renderList","$options","_createElementVNode","_toDisplayString","row","$props","_createCommentVNode"],"mappings":"ysCA4BA,MAAAA,EAAAC,EASAC,EAAAC,EACA,gBACAH,EAAA,SACA,EAEA,SAAAI,EAAAC,EAAA,CACA,MAAAC,EAAA,CACA,qBAAAC,EACA,uBAAAC,EACA,mBAAAC,CACA,EACAH,EAAAD,CAAA,GACAC,EAAAD,CAAA,EAAA,KAAA,IAAA,CAEA,CAEA,SAAAE,GAAA,CACAG,EAAA,CACA,MAAA,qBACA,OAAA,CACA,CACA,MAAA,6BACA,UAAA,cACA,CACA,EACA,UAAA,CAAA,KAAAC,EAAA,OAAAC,GAAA,CACAA,EAAA,aACAC,EAAA,QACAX,EAAA,SAAA,OACA,CACA,MAAAU,EAAA,YACA,EACA,CACA,WAAA,CACAD,EAAA,CACA,CACA,CACA,EACA,CACA,QAAA,0BACA,QAAA,mCACA,MAAA,8BACA,CACA,EAEAE,EAAA,MAAA,uCAAA,CAEA,CACA,CAAA,CACA,CAEA,SAAAL,GAAA,CACAE,EAAA,CACA,MAAA,iCACA,OAAA,CACA,CACA,MACA,wEACA,UAAA,OACA,EACA,CACA,MAAA,sBACA,UAAA,SACA,KAAA,UACA,CACA,EACA,cAAA,CACA,MAAA,WACA,QAAA,QACA,QAAA,CAAA,CAAA,KAAAC,EAAA,OAAAC,KAAA,CACA,GAAA,CAAAA,EAAA,MACA,MAAA,IAAA,MAAA,oCAAA,EAGA,OAAAV,EAAA,oBACA,OAAA,CAAA,aAAAU,EAAA,MAAA,OAAAA,EAAA,QAAA,EAAA,CAAA,EACA,KAAA,IAAA,CACAD,EAAA,EACAE,EAAA,QACA,4BAAAD,EAAA,KAAA,gBACA,CACA,CAAA,CACA,CACA,CACA,CAAA,CACA,CAEA,SAAAH,GAAA,CACAC,EAAA,CACA,MAAA,mBACA,QAAA,oDACAR,EAAA,IAAA,OAAAA,EAAA,IACA,QACA,OAAA,CACA,CACA,MAAA,8CACA,UAAA,kBACA,CACA,EACA,cAAA,CACA,MAAA,OACA,MAAA,MACA,QAAA,CAAA,CAAA,KAAAS,EAAA,OAAAC,KAAA,CACA,GAAA,CAAAV,EAAA,OAAA,QACA,IAAAU,EAAA,mBAAAV,EAAA,IAAA,MACA,MAAA,IAAA,MAAA,iCAAA,EAEAW,EAAA,QACAX,EAAA,OAAA,OAAA,KAAA,CACA,UAAA,IAAA,CACAS,EAAA,EACAG,EAAA,KAAA,CAAA,KAAA,oBAAA,CAAA,CACA,CACA,CAAA,EACA,CACA,QAAA,0BACA,QAAA,mCACA,MAAAC,GACAA,EAAA,SAAA,OACAA,EAAA,SAAA,KAAA;AAAA,CAAA,EACA,4BACA,CACA,EACA,CACA,CACA,CAAA,CACA,iXCtIAC,EAAA,wBAEC,WAAA,CAAAC,uBAAAA,CAAA,EACA,SAAA,CACC,eAAA,CACC,OAAAd,EAAA,gBAAA,KAAA,YAAA,GAED,SAAA,+CAEE,CAAAe,EAAAb,IAAA,CACC,MAAAc,EAAAd,EAAA,OAAA,kBACA,OAAAa,EAAAC,CAAA,0BAIAD,0DAQF,EAAA,CACD,CACD,CACD,WAtDM,MAAA,+BAMEE,EAAA,CAAA,MAAA,4BAAA,yIANPC,IAAAC,EAAA,MAAAC,EAAA,EACCF,EAAA,EAAA,EAAAC,EAAAE,EAAA,KAAAC,EAAAC,EAAA,QAAAP,6BAGC,MAAA,gDAEAQ,EAAA,MAAAP,EAAAQ,EAAAT,EAAA,KAAA,EAAA,CAAA,GACAE,EAAA,EAAA,EAAAC,EAAAE,EAAA,KAAAC,EAAAN,EAAA,QAAAU,iBACC,MAAA,gDAKE,UAAAC,EAAA,kOAdNC,EAAA,GAAA,EAAA"}