{"version":3,"file":"SiteInstalling-DjrX42BS.js","sources":["../../../../dashboard/src/views/site/SiteInstalling.vue"],"sourcesContent":["<template>\n\t<Section\n\t\tv-if=\"installingJob\"\n\t\ttitle=\"Your site is being installed...\"\n\t\tdescription=\"Please wait while we set up your site for use\"\n\t>\n\t\t<SectionCard>\n\t\t\t<div\n\t\t\t\tv-for=\"step in installingJob.steps\"\n\t\t\t\tclass=\"flex items-center px-6 py-2 text-base\"\n\t\t\t\t:key=\"step.name\"\n\t\t\t>\n\t\t\t\t<div class=\"h-4 w-4 text-gray-800\">\n\t\t\t\t\t<FeatherIcon\n\t\t\t\t\t\tclass=\"h-4 w-4\"\n\t\t\t\t\t\t:class=\"{ spin: step.status === 'Running' }\"\n\t\t\t\t\t\t:name=\"iconMap[step.status]\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<span class=\"ml-2\">{{ step.name }}</span>\n\t\t\t</div>\n\t\t</SectionCard>\n\t</Section>\n</template>\n\n<script>\nexport default {\n\tname: 'SiteActivity',\n\tprops: ['site'],\n\tdata() {\n\t\treturn {\n\t\t\ticonMap: {\n\t\t\t\tRunning: 'loader',\n\t\t\t\tSuccess: 'check',\n\t\t\t\tPending: 'minus'\n\t\t\t},\n\t\t\tinstallingJob: null\n\t\t};\n\t},\n\tmounted() {\n\t\tthis.setupSiteInstall();\n\t\tthis.fetchPendingJobs();\n\t},\n\tmethods: {\n\t\tsetupSiteInstall() {\n\t\t\tthis.$socket.on('agent_job_update', data => {\n\t\t\t\tif (\n\t\t\t\t\tdata.site === this.site.name &&\n\t\t\t\t\t(data.name === 'New Site' || data.name === 'New Site from Backup')\n\t\t\t\t) {\n\t\t\t\t\tthis.installingJob = data;\n\n\t\t\t\t\tif (\n\t\t\t\t\t\tdata.status === 'Success' &&\n\t\t\t\t\t\tthis.$route.path.startsWith(`/sites/${this.site.name}`)\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.installingJob = null;\n\t\t\t\t\t\tthis.$router.replace(`/sites/${this.site.name}`);\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tasync fetchPendingJobs() {\n\t\t\tlet jobs = await this.$call('press.api.site.running_jobs', {\n\t\t\t\tname: this.site.name\n\t\t\t});\n\t\t\tjobs.forEach(job => {\n\t\t\t\tif (job.name === 'New Site' || job.name === 'New Site from Backup') {\n\t\t\t\t\tthis.installingJob = job;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n};\n</script>\n\n<style>\n.spin {\n\tanimation: spin 4s linear infinite;\n}\n\n@keyframes spin {\n\t100% {\n\t\ttransform: rotate(360deg);\n\t}\n}\n</style>\n"],"names":["_sfc_main","data","job","_hoisted_1","_hoisted_2","_withCtx","_openBlock","_createElementBlock","_Fragment","_renderList","$data","step","_createElementVNode","_normalizeClass","_toDisplayString","_createCommentVNode"],"mappings":"4gCA0BA,MAAAA,EAAA,CACC,KAAA,eACA,MAAA,CAAA,MAAA,EACA,MAAA,CACC,MAAA,CACC,QAAA,CACC,QAAA,SACA,QAAA,QACA,QAAA,SAED,cAAA,OAGF,SAAA,kDAIA,QAAA,CACC,kBAAA,CACC,KAAA,QAAA,GAAA,mBAAAC,GAAA,2RAgBA,CAAA,sGAIC,KAAA,KAAA,KAAA,IACD,CAAA,GACA,QAAAC,GAAA,+EAIA,CAAA,CACD,GACD,CACD,EA9DSC,EAAA,CAAA,MAAA,uBAAA,EAOCC,EAAA,CAAA,MAAA,MAAA,mFAhBR,MAAA,kCACA,YAAA,kDAJF,QAAAC,EAAA,IAAA,WAAA,QAAAA,EAAA,IAAA,EAOGC,EAAA,EAAA,EAAAC,EAAAC,EAAA,KAAAC,EAAAC,EAAA,cAAA,MAAAC,iBAEC,MAAA,qDAGAC,EAAA,MAAAT,EAAA,MAEE,MAAAU,EAAA,CAAA,UAAA,CAAA,KAAAF,EAAA,SAAA,SAAA,CAAA,CAAA,EAEC,KAAAD,EAAA,QAAAC,EAAA,MAAA,8BAGHC,EAAA,OAAAR,EAAAU,EAAAH,EAAA,IAAA,EAAA,CAAA,6BAnBJI,EAAA,GAAA,EAAA"}