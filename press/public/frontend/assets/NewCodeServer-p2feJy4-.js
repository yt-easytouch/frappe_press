var w=(s,e,t)=>new Promise((b,o)=>{var l=i=>{try{a(t.next(i))}catch(h){o(h)}},d=i=>{try{a(t.throw(i))}catch(h){o(h)}},a=i=>i.done?b(i.value):Promise.resolve(i.value).then(l,d);a((t=t.apply(s,e)).next())});import{_ as D}from"./WizardCard-D6pRuZbe.js";import{_ as E}from"./Steps-B0ktOnsZ.js";import{x as S,q as m,o as r,j as n,t as V,u as v,A as p,a9 as H,a8 as U,F as M,v as A,n as G,r as B,h as f,ae as F,w as _,a5 as L,Y as g,ag as x,ah as k,X as j}from"./main-Dpl-JOF2.js";import{F as q}from"./fuse.basic.esm-KoNXVm3X.js";import{_ as W}from"./ListItem-CkkFcC1t.js";(function(){try{var s=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(s._sentryDebugIds=s._sentryDebugIds||{},s._sentryDebugIds[e]="1584562e-4a36-4c79-ab19-46401c40e98f",s._sentryDebugIdIdentifier="sentry-dbid-1584562e-4a36-4c79-ab19-46401c40e98f")}catch(t){}})();{var C=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};C._sentryModuleMetadata=C._sentryModuleMetadata||{},C._sentryModuleMetadata[new Error().stack]=Object.assign({},C._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const K={name:"Hostname",props:["modelValue","domain"],emits:["update:modelValue","error"],data(){return{subdomainAvailable:!1,errorMessage:null}},methods:{subdomainChange(s){return w(this,null,function*(){let e=s.target.value;this.$emit("update:modelValue",e),this.subdomainAvailable=!1;let t=this.validateSubdomain(e);t||((yield this.$call("press.api.spaces.exists",{subdomain:e,domain:this.domain}))?t=`${e}.${this.domain} already exists.`:this.subdomainAvailable=!0),this.errorMessage=t,this.$emit("error",t)})},validateSubdomain(s){return s?s.length<5?"Subdomain too short. Use 5 or more characters":s.length>32?"Subdomain too long. Use 32 or less characters":s.match(/^[a-z0-9][a-z0-9-]*[a-z0-9]$/)?null:"Subdomain contains invalid characters. Use lowercase characters, numbers and hyphens":"Subdomain cannot be empty"}}},P={class:"mt-4 flex"},X=["value"],Y={class:"flex items-center rounded-r bg-gray-100 px-4 text-base"},J={class:"mt-1"},Q={key:0,class:"text-sm text-green-600",role:"alert"};function R(s,e,t,b,o,l){const d=H;return r(),m("div",null,[e[1]||(e[1]=n("label",{class:"text-lg font-semibold"}," Choose a Hostname ",-1)),e[2]||(e[2]=n("p",{class:"text-base text-gray-700"}," Give your code server a unique name. It can only contain alphanumeric characters and dashes. ",-1)),n("div",P,[n("input",{class:"form-input z-10 w-full rounded-r-none",type:"text",value:t.modelValue,placeholder:"subdomain",onChange:e[0]||(e[0]=(...a)=>l.subdomainChange&&l.subdomainChange(...a))},null,40,X),n("div",Y," ."+V(t.domain),1)]),n("div",J,[o.subdomainAvailable?(r(),m("div",Q,V(t.modelValue)+"."+V(t.domain)+" is available ",1)):v("",!0),p(d,{message:o.errorMessage},null,8,["message"])])])}const Z=S(K,[["render",R]]),ee={name:"NewCodeServerBench",props:["modelValue"],emits:["update:modelValue","error"],data(){return{filteredOptions:[]}},resources:{options(){return{url:"press.api.spaces.code_server_group_options",auto:!0,onSuccess(s){this.fuse=new q(s,{keys:["title"]}),this.filteredOptions=s}}}},computed:{groups(){return this.$resources.options.data}},methods:{selectGroup(s){this.$emit("update:modelValue",s)},updateSearchTerm(s){s?this.filteredOptions=this.fuse.search(s).map(e=>e.item):this.filteredOptions=this.$resources.options.data}}},se={class:"grid grid-cols-1 gap-2 sm:grid-cols-2"},te=["onClick"];function oe(s,e,t,b,o,l){const d=U;return r(),m("div",null,[e[1]||(e[1]=n("div",null,[n("label",{class:"text-lg font-semibold"}," Choose a Bench "),n("p",{class:"text-base text-gray-700"}," Choose a bench where you want to install the code server. ")],-1)),p(d,{class:"my-2",placeholder:"Search for Bench",onInput:e[0]||(e[0]=a=>l.updateSearchTerm(a.target.value))}),n("div",se,[(r(!0),m(M,null,A(o.filteredOptions,a=>(r(),m("div",{onClick:i=>l.selectGroup(a),class:G(["m-2 rounded-md border px-6 py-5 text-lg shadow-sm hover:cursor-pointer hover:shadow-md",[t.modelValue&&t.modelValue.name==a.name?"relative ring-2 ring-inset ring-blue-500":""]])},V(a.title),11,te))),256))])])}const ne=S(ee,[["render",oe]]),re={name:"NewCodeServerBench",props:["modelValue","selectedGroup"],emits:["update:modelValue","error"],methods:{selectBench(s){this.$emit("update:modelValue",s)}},resources:{options(){return{url:"press.api.spaces.code_server_bench_options",params:{group:this.selectedGroup},auto:!0}}},computed:{benches(){return this.$resources.options.data?this.$resources.options.data:[]}}},ae={key:1},le={key:1,class:"ml-2 mt-4 text-sm"};function ie(s,e,t,b,o,l){const d=F,a=L,i=W,h=B("router-link");return r(),m("div",null,[e[3]||(e[3]=n("div",null,[n("label",{class:"text-lg font-semibold"}," Choose a Bench "),n("p",{class:"text-base text-gray-700"}," Choose a bench where you want to install the code server. ")],-1)),s.$resources.options.loading?(r(),f(d,{key:0})):(r(),m("div",ae,[l.benches.length>0?(r(!0),m(M,{key:0},A(l.benches,(c,$)=>(r(),f(i,{key:c,title:c,class:G(["m-2 rounded-md border px-2 shadow-sm hover:cursor-pointer hover:shadow-md",[t.modelValue&&t.modelValue==c?"relative ring-2 ring-inset ring-blue-500":""]]),onClick:N=>l.selectBench(c)},{actions:_(()=>[$===0?(r(),f(a,{key:0,label:"Latest Deployed"})):v("",!0)]),_:2},1032,["title","class","onClick"]))),128)):(r(),m("div",le,[e[1]||(e[1]=g(" No bench versions found with a code server. Click ")),p(h,{to:`/groups/${t.selectedGroup}`,class:"text-blue-600 hover:underline"},{default:_(()=>e[0]||(e[0]=[g("here")])),_:1},8,["to"]),e[2]||(e[2]=g(" to deploy a new available version of your bench. "))]))]))])}const de=S(re,[["render",ie]]),ue={name:"NewServer",components:{WizardCard:D,Steps:E,Hostname:Z,Group:ne,Bench:de},data(){return{title:null,subdomain:null,domain:null,subdomainValid:!1,selectedGroup:null,selectedBench:null,steps:[{name:"Hostname",validate:()=>this.subdomainValid},{name:"Group",validate:()=>this.selectedGroup!=null},{name:"Bench"}]}},mounted(){return w(this,null,function*(){this.domain=yield this.$call("press.api.spaces.code_server_domain")})},resources:{newCodeServer(){return{url:"press.api.spaces.create_code_server",params:{subdomain:this.subdomain,bench:this.selectedBench,domain:this.domain},onSuccess(s){this.$router.replace(`/codeservers/${s}/jobs`)},validate(){if(this.selectedBench===null)return"Please select a bench version to deploy the code server on"}}}},methods:{nextStep(s,e){return w(this,null,function*(){e()})}}},me={class:"mt-4"};function ce(s,e,t,b,o,l){const d=B("Hostname"),a=B("Group"),i=B("Bench"),h=H,c=j,$=E,N=D;return o.domain?(r(),f(N,{key:0},{default:_(()=>[e[9]||(e[9]=n("div",{class:"mb-6 text-center"},[n("h1",{class:"text-2xl font-bold"},"Create a new codespace")],-1)),p($,{steps:o.steps},{default:_(({active:y,next:O,previous:T,hasPrevious:I,hasNext:z})=>[e[8]||(e[8]=n("div",{class:"mt-8"},null,-1)),x(p(d,{modelValue:o.subdomain,"onUpdate:modelValue":e[0]||(e[0]=u=>o.subdomain=u),domain:o.domain,onError:e[1]||(e[1]=u=>o.subdomainValid=!u)},null,8,["modelValue","domain"]),[[k,y.name==="Hostname"]]),x(p(a,{modelValue:o.selectedGroup,"onUpdate:modelValue":e[2]||(e[2]=u=>o.selectedGroup=u)},null,8,["modelValue"]),[[k,y.name==="Group"]]),o.selectedGroup?x((r(),f(i,{key:0,modelValue:o.selectedBench,"onUpdate:modelValue":e[3]||(e[3]=u=>o.selectedBench=u),selectedGroup:o.selectedGroup.name},null,8,["modelValue","selectedGroup"])),[[k,y.name==="Bench"]]):v("",!0),n("div",me,[p(h,{class:"mb-4",message:s.$resources.newCodeServer.error},null,8,["message"]),n("div",null,[I?(r(),f(c,{key:0,class:"w-full",onClick:T},{default:_(()=>e[5]||(e[5]=[g(" Back ")])),_:2},1032,["onClick"])):v("",!0),z?(r(),f(c,{key:1,class:G(["w-full",{"mt-2":I}]),variant:"solid",onClick:u=>l.nextStep(y,O)},{default:_(()=>e[6]||(e[6]=[g(" Next ")])),_:2},1032,["onClick","class"])):v("",!0),x(p(c,{class:"w-full mt-2",variant:"solid",onClick:e[4]||(e[4]=u=>s.$resources.newCodeServer.submit()),loading:s.$resources.newCodeServer.loading,disabled:o.selectedBench==null},{default:_(()=>e[7]||(e[7]=[g(" Create Codespace ")])),_:2},1032,["loading","disabled"]),[[k,!z]])])])]),_:1},8,["steps"])]),_:1})):v("",!0)}const ge=S(ue,[["render",ce]]);export{ge as default};
//# sourceMappingURL=NewCodeServer-p2feJy4-.js.map
