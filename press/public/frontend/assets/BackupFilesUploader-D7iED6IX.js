var _=(e,t,i)=>new Promise((w,p)=>{var d=s=>{try{o(i.next(s))}catch(l){p(l)}},f=s=>{try{o(i.throw(s))}catch(l){p(l)}},o=s=>s.done?w(s.value):Promise.resolve(s.value).then(d,f);o((i=i.apply(e,t)).next())});import{_ as x}from"./FileUploader-C1pIUjCt.js";import{_ as V}from"./ListItem-CkkFcC1t.js";import{x as E,q as b,o as r,j as y,F as U,v as B,h,w as u,A as H,u as v,X as M,Y as q,ak as I,n as $,t as z}from"./main-Dpl-JOF2.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ec1b9422-2b79-4856-9021-fcaa46024d7b",e._sentryDebugIdIdentifier="sentry-dbid-ec1b9422-2b79-4856-9021-fcaa46024d7b")}catch(i){}})();{var c=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};c._sentryModuleMetadata=c._sentryModuleMetadata||{},c._sentryModuleMetadata[new Error().stack]=Object.assign({},c._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const D={name:"BackupFilesUploader",components:{FileUploader:x},emits:["update:backupFiles"],props:["backupFiles"],data(){return{files:[{icon:'<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.33325 9.33333V22.6667C5.33325 25.6133 10.1093 28 15.9999 28C21.8906 28 26.6666 25.6133 26.6666 22.6667V9.33333M5.33325 9.33333C5.33325 12.28 10.1093 14.6667 15.9999 14.6667C21.8906 14.6667 26.6666 12.28 26.6666 9.33333M5.33325 9.33333C5.33325 6.38667 10.1093 4 15.9999 4C21.8906 4 26.6666 6.38667 26.6666 9.33333M26.6666 16C26.6666 18.9467 21.8906 21.3333 15.9999 21.3333C10.1093 21.3333 5.33325 18.9467 5.33325 16" stroke="#1F272E" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',type:"database",ext:"application/x-gzip,application/sql,.sql",title:"Database Backup",description:"Upload the database backup file. Usually file name ends in .sql.gz or .sql",file:null},{icon:'<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M9.39111 6.3913H26.3476V22.2174C26.3476 25.9478 23.2955 29 19.565 29H9.39111V6.3913Z" stroke="#1F272E" stroke-width="1.5" stroke-miterlimit="10"/><path d="M13.9131 13.1739H21.8261" stroke="#1F272E" stroke-width="1.5" stroke-miterlimit="10"/><path d="M13.9131 17.6957H21.8261" stroke="#1F272E" stroke-width="1.5" stroke-miterlimit="10"/><path d="M13.9131 22.2173H19.8479" stroke="#1F272E" stroke-width="1.5" stroke-miterlimit="10"/><path d="M22.9565 6.3913V3H6V25.6087H9.3913" stroke="#1F272E" stroke-width="1.5" stroke-miterlimit="10"/></svg>',type:"public",ext:"application/x-tar",title:"Public Files",description:"Upload the public files backup. Usually file name ends in -files.tar",file:null},{icon:'<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.39111 6.3913H25.3476V22.2174C25.3476 25.9478 22.2955 29 18.565 29H8.39111V6.3913Z" stroke="#1F272E" stroke-width="1.5" stroke-miterlimit="10"/><path d="M21.9565 6.3913V3H5V25.6087H8.3913" stroke="#1F272E" stroke-width="1.5" stroke-miterlimit="10"/></svg>',type:"private",ext:"application/x-tar",title:"Private Files",description:"Upload the private files backup. Usually file name ends in -private-files.tar",file:null},{icon:'<svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M8.39111 6.3913H25.3476V22.2174C25.3476 25.9478 22.2955 29 18.565 29H8.39111V6.3913Z" stroke="#1F272E" stroke-width="1.5" stroke-miterlimit="10"/><path d="M21.9565 6.3913V3H5V25.6087H8.3913" stroke="#1F272E" stroke-width="1.5" stroke-miterlimit="10"/></svg>',type:"config",ext:"application/json",title:"Site Config (required if backup is encrypted)",description:"Upload the site config file. Usually file name ends in -site_config_backup.json",file:null}]}},methods:{onFileUpload(e,t){let i=Object.assign({},this.backupFiles);i[e.type]=t,this.$emit("update:backupFiles",i)},databaseBackupChecker(e,t){return _(this,null,function*(){if(t==="database"){if(!/\.sql( \(\d\))?\.gz$|\.sql$/.test(e.name))throw new Error('Database backup file should end with the name "database.sql.gz" or "database.sql"');if(!["application/x-gzip","application/gzip","application/sql"].includes(e.type))throw new Error("Invalid database backup file")}if(["public","private"].includes(t)&&e.type!="application/x-tar")throw new Error(`Invalid ${t} files backup file`);if(t==="config"&&e.type!="application/json")throw new Error(`Invalid ${t} files backup file`)})}}},j={class:"mt-2 space-y-2"};function N(e,t,i,w,p,d){const f=M,o=I,s=V,l=x;return r(),b("div",null,[y("div",j,[(r(!0),b(U,null,B(p.files,a=>(r(),h(l,{fileTypes:a.ext,key:a.type,type:a.type,onSuccess:n=>d.onFileUpload(a,n),fileValidator:n=>d.databaseBackupChecker(n,a.type),s3:!0},{default:u(({file:n,uploading:g,progress:F,error:k,success:m,openFileSelector:C})=>[H(s,{class:"border-b",title:n?n.name:a.title},{subtitle:u(()=>[y("span",{class:$(["text-base",k?"text-red-500":"text-gray-600"])},z(g?`Uploading ${F}%`:m?e.formatBytes(n.size):k||a.description),3)]),actions:u(()=>[m?v("",!0):(r(),h(f,{key:0,loading:g,loadingText:"Uploading...",onClick:S=>C()},{default:u(()=>t[0]||(t[0]=[q(" Upload ")])),_:2},1032,["loading","onClick"])),m?(r(),h(o,{key:1,class:"w-5"})):v("",!0)]),_:2},1032,["title"])]),_:2},1032,["fileTypes","type","onSuccess","fileValidator"]))),128))])])}const L=E(D,[["render",N]]);export{L as _};
//# sourceMappingURL=BackupFilesUploader-D7iED6IX.js.map
