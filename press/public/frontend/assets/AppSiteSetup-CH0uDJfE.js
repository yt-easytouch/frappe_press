import{Z as u,ce as R,cf as z,J as k,l as g,m as I,bL as D,H as N,x as j,cg as M,ac as x,q as v,u as $,o as _,A as m,w as h,a8 as W,bf as L,j as S,t as V,a9 as B,X as F,Y as K}from"./main-Dpl-JOF2.js";import{_ as T}from"./Progress.vue_vue_type_script_setup_true_lang-DREy3z5o.js";import{L as Y}from"./LoginBox-DSVNkn_s.js";import{v as U}from"./FileUploader-C1pIUjCt.js";import"./YooltechLogo-DH5Linvn.js";import"./ETLogo-Ziye5dPH.js";import"./toast-Dk0nDfLL.js";import"./datetime-PXpIdgFA.js";import"./dayjs.min-BK4AnHlu.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},n=new Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="d2491044-01d3-48e0-8cac-911e2d284c65",e._sentryDebugIdIdentifier="sentry-dbid-d2491044-01d3-48e0-8cac-911e2d284c65")}catch(o){}})();{var y=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};y._sentryModuleMetadata=y._sentryModuleMetadata||{},y._sentryModuleMetadata[new Error().stack]=Object.assign({},y._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}function H(e){return R()?(z(e),!0):!1}function J(e){return typeof e=="function"?e():u(e)}const X=typeof window!="undefined";function w(e){var n;const o=J(e);return(n=o==null?void 0:o.$el)!=null?n:o}const q=X?window:void 0;function Z(){const e=g(!1);return D()&&N(()=>{e.value=!0}),e}function Q(e){const n=Z();return k(()=>(n.value,!!e()))}var E=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,te=(e,n)=>{var o={};for(var s in e)G.call(e,s)&&n.indexOf(s)<0&&(o[s]=e[s]);if(e!=null&&E)for(var s of E(e))n.indexOf(s)<0&&ee.call(e,s)&&(o[s]=e[s]);return o};function se(e,n,o={}){const s=o,{window:l=q}=s,p=te(s,["window"]);let a;const c=Q(()=>l&&"ResizeObserver"in l),i=()=>{a&&(a.disconnect(),a=void 0)},d=k(()=>Array.isArray(e)?e.map(r=>w(r)):[w(e)]),f=I(d,r=>{if(i(),c.value&&l){a=new ResizeObserver(n);for(const b of r)b&&a.observe(b,p)}},{immediate:!0,flush:"post",deep:!0}),t=()=>{i(),f()};return H(t),{isSupported:c,stop:t}}function oe(e,n={width:0,height:0},o={}){const{window:s=q,box:l="content-box"}=o,p=k(()=>{var i,d;return(d=(i=w(e))==null?void 0:i.namespaceURI)==null?void 0:d.includes("svg")}),a=g(n.width),c=g(n.height);return se(e,([i])=>{const d=l==="border-box"?i.borderBoxSize:l==="content-box"?i.contentBoxSize:i.devicePixelContentBoxSize;if(s&&p.value){const f=w(e);if(f){const t=s.getComputedStyle(f);a.value=Number.parseFloat(t.width),c.value=Number.parseFloat(t.height)}}else if(d){const f=Array.isArray(d)?d:[d];a.value=f.reduce((t,{inlineSize:r})=>t+r,0),c.value=f.reduce((t,{blockSize:r})=>t+r,0)}else a.value=i.contentRect.width,c.value=i.contentRect.height},o),I(()=>w(e),i=>{a.value=i?n.width:0,c.value=i?n.height:0}),{width:a,height:c}}const ne={key:0,class:"min-h-screen bg-gray-50"},re={class:"mx-auto flex flex-col items-center"},ae=["src","alt"],ie={key:1,class:"text-4xl font-semibold text-gray-900"},ue={key:0,class:"space-y-3"},le={key:1},de={key:2},ce={__name:"AppSiteSetup",props:["product"],setup(e){M(t=>({f0eaa960:f.value}));const n=e,o=g("Pending"),s=x({url:"press.api.saas.get_saas_product_info",params:{product:n.product},auto:!0,onSuccess(t){t!=null&&t.site_request&&(o.value=t.site_request.status,o.value==="Wait for Site"&&a.reload())}}),l=g(null),p=x({url:"press.api.saas.create_site",makeParams(){return{product:n.product,subdomain:l.value,site_request:s.data.site_request}},validate(){return U(l.value)},onSuccess(){o.value="Wait for Site",a.reload()}}),a=x({url:"press.api.saas.get_site_progress",makeParams(){return{site_request:s.data.site_request.name}},onSuccess(t){t.progress==100?(o.value="Site Created",c.submit()):setTimeout(()=>{a.reload()},2e3)}}),c=x({url:"press.api.saas.login_to_site",makeParams(){return{site_request:s.data.site_request.name}},onSuccess(t){t!=null&&t.sid&&(t!=null&&t.site)&&(window.location.href=`https://${t.site}/desk?sid=${t.sid}`)}}),i=g(null),{width:d}=oe(i),f=k(()=>d.value+10+"px");return(t,r)=>{const b=W,A=F;return u(s).data?(_(),v("div",ne,[m(Y,{title:o.value=="Pending"?"Create your site":""},{logo:h(()=>[S("div",re,[u(s).data.logo?(_(),v("img",{key:0,class:"mb-1",src:u(s).data.logo,alt:u(s).data.title},null,8,ae)):(_(),v("div",ie,V(u(s).data.title),1)),r[3]||(r[3]=S("div",{class:"text-base text-gray-700"},"Powered by Easytouch Cloud",-1))])]),default:h(()=>{var P,O;return[o.value=="Pending"?(_(),v("div",ue,[m(b,{label:"Your Email",modelValue:t.$account.user.email,disabled:!0},null,8,["modelValue"]),m(b,{class:"subdomain mt-2",label:"Site Name",modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=C=>l.value=C),onKeydown:r[1]||(r[1]=L(C=>u(p).submit(),["enter"]))},{suffix:h(()=>[S("div",{ref_key:"domainSuffix",ref:i,class:"flex items-center text-base text-gray-600"}," ."+V(u(s).data.domain||"frappe.cloud"),513)]),_:1},8,["modelValue"]),m(u(B),{message:u(p).error},null,8,["message"]),m(A,{class:"w-full",variant:"solid",onClick:r[2]||(r[2]=C=>u(p).submit()),loading:u(p).loading},{default:h(()=>r[4]||(r[4]=[K(" Create ")])),_:1},8,["loading"])])):o.value=="Wait for Site"?(_(),v("div",le,[m(u(T),{label:"Creating site",value:((P=u(a).data)==null?void 0:P.progress)||0,size:"md"},null,8,["value"]),m(u(B),{message:(O=u(a).data)!=null&&O.error?"An error occurred":null},null,8,["message"])])):o.value=="Site Created"?(_(),v("div",de,r[5]||(r[5]=[S("div",{class:"text-center text-base text-gray-900"}," Your site is ready. Logging in... ",-1)]))):$("",!0)]}),_:1},8,["title"])])):$("",!0)}}},xe=j(ce,[["__scopeId","data-v-1c5c8e24"]]);export{xe as default};
//# sourceMappingURL=AppSiteSetup-CH0uDJfE.js.map
