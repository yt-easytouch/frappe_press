var b=(e,s,t)=>new Promise((y,o)=>{var m=r=>{try{l(t.next(r))}catch(i){o(i)}},n=r=>{try{l(t.throw(r))}catch(i){o(i)}},l=r=>r.done?y(r.value):Promise.resolve(r.value).then(m,n);l((t=t.apply(e,s)).next())});import{x as v,r as g,h as A,q as f,u as F,o as c,w,j as _,a7 as h,A as a,a8 as V,a9 as S,X as E,Y as u,t as B}from"./main-Dpl-JOF2.js";import{L as K}from"./LoginBox-qd4moaUa.js";import"./YooltechLogo-DH5Linvn.js";import"./ETLogo-Ziye5dPH.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},s=new Error().stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="f7da02e0-1972-4517-b8dc-9f56456a6dca",e._sentryDebugIdIdentifier="sentry-dbid-f7da02e0-1972-4517-b8dc-9f56456a6dca")}catch(t){}})();{var p=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};p._sentryModuleMetadata=p._sentryModuleMetadata||{},p._sentryModuleMetadata[new Error().stack]=Object.assign({},p._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const P={name:"ResetPassword",components:{LoginBox:K},props:["requestKey"],data(){return{email:null,ask2FA:!1,password:null}},resources:{validateResetKey(){return{url:"press.api.account.get_user_for_reset_password_key",params:{key:this.requestKey},onSuccess(e){this.email=e||null},auto:!0}},resetPassword(){return{url:"press.api.account.reset_password",params:{key:this.requestKey,password:this.password},onSuccess(){window.location.reload()}}},is2FAEnabled(){return{url:"press.api.account.is_2fa_enabled"}},verify2FA(){return{url:"press.api.account.verify_2fa",onSuccess:()=>b(this,null,function*(){yield this.$resources.resetPassword.submit()})}}},methods:{handleSubmit(){this.ask2FA?this.$resources.verify2FA.submit({user:this.email,totp_code:this.twoFactorCode}):this.$resources.is2FAEnabled.submit({user:this.email},{onSuccess:e=>{e?this.ask2FA=!0:this.$resources.resetPassword.submit()}})}}},$={key:0},C={key:1,class:"space-y-4"},q={key:1,class:"mt-20 px-6 text-center"};function D(e,s,t,y,o,m){const n=V,l=S,r=E,i=g("LoginBox"),k=g("router-link");return!e.$resources.validateResetKey.loading&&o.email?(c(),A(i,{key:0,title:"Set a new password for your account"},{default:w(()=>[_("form",{class:"flex flex-col",onSubmit:s[2]||(s[2]=h((...d)=>m.handleSubmit&&m.handleSubmit(...d),["prevent"]))},[o.ask2FA?(c(),f("div",$,[a(n,{label:"2FA Code from your Authenticator App",placeholder:"123456",modelValue:e.twoFactorCode,"onUpdate:modelValue":s[0]||(s[0]=d=>e.twoFactorCode=d),required:""},null,8,["modelValue"])])):(c(),f("div",C,[a(n,{label:"Email",class:"pointer-events-none",modelValue:o.email,name:"email",autocomplete:"off",disabled:""},null,8,["modelValue"]),a(n,{label:"Password",type:"password",modelValue:o.password,"onUpdate:modelValue":s[1]||(s[1]=d=>o.password=d),name:"password",autocomplete:"new-password",required:""},null,8,["modelValue"])])),a(l,{class:"mt-6",message:e.$resources.resetPassword.error||e.$resources.verify2FA.error||e.$resources.is2FAEnabled.error},null,8,["message"]),a(r,{class:"mt-6",variant:"solid",disabled:!o.password,loading:e.$resources.resetPassword.loading||e.$resources.verify2FA.loading||e.$resources.is2FAEnabled.loading},{default:w(()=>s[3]||(s[3]=[u(" Submit ")])),_:1},8,["disabled","loading"])],32)]),_:1})):!e.$resources.validateResetKey.loading&&!o.email?(c(),f("div",q,[s[5]||(s[5]=u(" Account Key ")),_("strong",null,B(t.requestKey),1),s[6]||(s[6]=u(" is invalid or expired. Go back to ")),a(k,{class:"underline",to:"/login"},{default:w(()=>s[4]||(s[4]=[u("login")])),_:1}),s[7]||(s[7]=u(". "))])):F("",!0)}const N=v(P,[["render",D]]);export{N as default};
//# sourceMappingURL=ResetPassword-Hu-AE5AU.js.map
