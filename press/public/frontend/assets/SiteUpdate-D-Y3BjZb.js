import{x as v,an as x,r as b,q as p,o as c,A as a,j as s,w as i,Y as h,X as U,t as d,a5 as k,bZ as S,C as $,F as D,v as B,h as A}from"./main-Dpl-JOF2.js";import{J as C,_ as E}from"./JobStep-yl8qYLQg.js";import{_ as I}from"./arrow-left-DH4AOn6w.js";import{A as M}from"./AlertAddressableError-BvcXrI8s.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="da8a8778-4bea-4e14-9a56-9b62b649f098",t._sentryDebugIdIdentifier="sentry-dbid-da8a8778-4bea-4e14-9a56-9b62b649f098")}catch(o){}})();{var l=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};l._sentryModuleMetadata=l._sentryModuleMetadata||{},l._sentryModuleMetadata[new Error().stack]=Object.assign({},l._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const O={name:"SiteUpdate",props:["id"],components:{JobStep:C,AlertBanner:x,AlertAddressableError:M},resources:{siteUpdate(){if(this.id)return{type:"document",doctype:"Site Update",name:this.id,auto:!0,transform:t=>{t.steps=t.steps.map(e=>({name:e.name,title:`${e.stage} - ${e.title}`,output:e.output||"No Output",status:e.status,isOpen:!1}))},onSuccess:t=>{t.status!="Success"&&setTimeout(()=>{this.$resources.siteUpdate.reload()},5e3)}}}},computed:{siteUpdate(){var t,e;return(e=(t=this.$resources.siteUpdate)==null?void 0:t.doc)!=null?e:{}},steps(){var t,e;return((e=(t=this.$resources.siteUpdate)==null?void 0:t.doc)==null?void 0:e.steps)||[]},dropdownOptions(){return[{label:"View in Desk",icon:"external-link",condition:()=>{var t;return(t=this.$team.doc)==null?void 0:t.is_desk_user},onClick:()=>{window.open(`${window.location.protocol}//${window.location.host}/app/site-update/${this.id}`,"_blank")}}].filter(t=>{var e,o;return(o=(e=t.condition)==null?void 0:e.call(t))!=null?o:!0})}},methods:{format_seconds(t){if(t===null)return"-";if(t<60)return`${Math.ceil(t)}s`;const e=Math.floor(t/60),o=Math.ceil(t%60);return`${e}m ${o}s`}}},J={class:"p-5"},N={class:"mt-3"},V={class:"flex w-full items-center"},j={class:"text-lg font-medium text-gray-900"},F={class:"ml-auto space-x-2"},T={class:"mt-4 grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-5"},q={class:"mt-2 text-sm text-gray-900"},z={class:"mt-2 text-sm text-gray-900"},K={class:"mt-2 text-sm text-gray-900"},L={class:"mt-2 text-sm text-gray-900"},P={class:"mt-2 text-sm text-gray-900"},X={class:"mt-8 space-y-4"};function Y(t,e,o,Z,H,n){const m=I,u=U,_=k,f=S,g=E,y=$,w=b("JobStep");return c(),p("div",J,[a(u,{route:{name:"Site Detail Updates"}},{prefix:i(()=>[a(m,{class:"inline-block h-4 w-4"})]),default:i(()=>[e[1]||(e[1]=h(" All Updates "))]),_:1}),s("div",N,[s("div",V,[s("h2",j," Update Site "+d(n.siteUpdate.deploy_type),1),a(_,{class:"ml-2",label:n.siteUpdate.status},null,8,["label"]),s("div",F,[a(u,{onClick:e[0]||(e[0]=r=>t.$resources.siteUpdate.reload()),loading:t.$resources.siteUpdate.loading},{icon:i(()=>[a(f,{class:"h-4 w-4"})]),_:1},8,["loading"]),a(y,{options:n.dropdownOptions},{default:i(({open:r})=>[a(u,null,{icon:i(()=>[a(g,{class:"h-4 w-4"})]),_:1})]),_:1},8,["options"])])]),s("div",null,[s("div",T,[s("div",null,[e[2]||(e[2]=s("div",{class:"text-sm font-medium text-gray-500"},"Creation",-1)),s("div",q,d(t.$format.date(n.siteUpdate.creation,"lll")),1)]),s("div",null,[e[3]||(e[3]=s("div",{class:"text-sm font-medium text-gray-500"},"Creator",-1)),s("div",z,d(n.siteUpdate.owner),1)]),s("div",null,[e[4]||(e[4]=s("div",{class:"text-sm font-medium text-gray-500"},"Duration",-1)),s("div",K,d(n.siteUpdate.update_duration?this.format_seconds(n.siteUpdate.update_duration):"-"),1)]),s("div",null,[e[5]||(e[5]=s("div",{class:"text-sm font-medium text-gray-500"},"Start",-1)),s("div",L,d(t.$format.date(n.siteUpdate.update_start,"lll")),1)]),s("div",null,[e[6]||(e[6]=s("div",{class:"text-sm font-medium text-gray-500"},"End",-1)),s("div",P,d(n.siteUpdate.update_end?t.$format.date(n.siteUpdate.update_end,"lll"):"-"),1)])])])]),s("div",X,[(c(!0),p(D,null,B(n.steps,r=>(c(),A(w,{step:r,key:r.name},null,8,["step"]))),128))])])}const tt=v(O,[["render",Y]]);export{tt as default};
//# sourceMappingURL=SiteUpdate-D-Y3BjZb.js.map
