{"version":3,"file":"SiteMariaDBSlowQueries-PNCXPHY9.js","sources":["../../../../dashboard/src/views/site/SiteMariaDBSlowQueries.vue"],"sourcesContent":["<template>\n\t<div\n\t\tclass=\"flex items-center justify-center\"\n\t\tv-if=\"$resources.getPlan?.loading\"\n\t>\n\t\t<LoadingText />\n\t</div>\n\t<div v-else-if=\"$resources.getPlan?.data?.monitor_access\">\n\t\t<Card>\n\t\t\t<Report\n\t\t\t\t:filters=\"filters\"\n\t\t\t\t:columns=\"[\n\t\t\t\t\t{ label: 'Timestamp', name: 'timestamp', class: 'w-2/12' },\n\t\t\t\t\t{ label: 'Query', name: 'query', class: 'w-7/12' },\n\t\t\t\t\t{ label: 'Duration', name: 'duration', class: 'w-1/12' },\n\t\t\t\t\t{ label: 'Rows Examined', name: 'examined', class: 'w-1/12' },\n\t\t\t\t\t{ label: 'Rows Sent', name: 'sent', class: 'w-1/12' }\n\t\t\t\t]\"\n\t\t\t\t:data=\"formatSlowQueries\"\n\t\t\t\ttitle=\"MariaDB Slow Queries Report\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\tclass=\"px-2 py-2 text-base text-gray-600\"\n\t\t\t\tv-if=\"\n\t\t\t\t\t$resources.slowQueries.loading &&\n\t\t\t\t\t$resources.slowQueries.data.length == 0\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\t<LoadingText />\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"py-2 text-base text-gray-600\"\n\t\t\t\tv-if=\"\n\t\t\t\t\t!$resources.slowQueries.loading &&\n\t\t\t\t\t$resources.slowQueries.data.length == 0\n\t\t\t\t\"\n\t\t\t>\n\t\t\t\tNo data\n\t\t\t</div>\n\t\t\t<Button\n\t\t\t\tv-if=\"$resources.slowQueries.data && $resources.slowQueries.data.length\"\n\t\t\t\t:loading=\"$resources.slowQueries.loading\"\n\t\t\t\tloadingText=\"Loading...\"\n\t\t\t\t@click=\"max_lines += 20\"\n\t\t\t>\n\t\t\t\tLoad more\n\t\t\t</Button>\n\t\t</Card>\n\t</div>\n\t<div class=\"flex justify-center\" v-else>\n\t\t<span class=\"mt-16 text-base text-gray-700\">\n\t\t\tYour plan doesn't support this feature. Please upgrade your plan.\n\t\t</span>\n\t</div>\n</template>\n<script>\nimport Report from '@/components/Report.vue';\n\nexport default {\n\tname: 'SiteMariaDBSlowQueries',\n\tprops: ['site'],\n\tcomponents: {\n\t\tReport\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tfilters: [\n\t\t\t\t{\n\t\t\t\t\tname: 'pattern',\n\t\t\t\t\tlabel: 'Search:',\n\t\t\t\t\ttype: 'text',\n\t\t\t\t\tvalue: this.pattern\n\t\t\t\t},\n\t\t\t\t{ name: 'start', label: 'From:', type: 'datetime-local', value: '' },\n\t\t\t\t{ name: 'end', label: 'To:', type: 'datetime-local', value: '' }\n\t\t\t],\n\t\t\tmax_lines: 20\n\t\t};\n\t},\n\twatch: {\n\t\tpattern() {\n\t\t\tthis.reset();\n\t\t},\n\t\tstartTime() {\n\t\t\tthis.reset();\n\t\t},\n\t\tendTime() {\n\t\t\tthis.reset();\n\t\t}\n\t},\n\tresources: {\n\t\tslowQueries() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.analytics.mariadb_slow_queries',\n\t\t\t\tparams: {\n\t\t\t\t\tsite: this.site?.name,\n\t\t\t\t\tstart: this.startTime || this.today,\n\t\t\t\t\tend: this.endTime || this.today,\n\t\t\t\t\tpattern: this.pattern,\n\t\t\t\t\tmax_lines: this.max_lines\n\t\t\t\t},\n\t\t\t\tauto: true,\n\t\t\t\tpageLength: 10,\n\t\t\t\tkeepData: true,\n\t\t\t\tinitialData: []\n\t\t\t};\n\t\t},\n\t\tgetPlan() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.site.current_plan',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.site?.name\n\t\t\t\t},\n\t\t\t\tauto: true\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\treset() {\n\t\t\tthis.$resources.slowQueries.reset();\n\t\t}\n\t},\n\tcomputed: {\n\t\tstartTime() {\n\t\t\treturn this.filters[1].value;\n\t\t},\n\t\tendTime() {\n\t\t\treturn this.filters[2].value;\n\t\t},\n\t\tpattern() {\n\t\t\treturn this.filters[0].value;\n\t\t},\n\t\tformatSlowQueries() {\n\t\t\tlet data = [];\n\t\t\tthis.$resources.slowQueries.data.forEach(row => {\n\t\t\t\tlet time = this.formatDate(row.timestamp, 'TIME_24_WITH_SHORT_OFFSET');\n\t\t\t\tlet out = [\n\t\t\t\t\t{ name: 'Timestamp', value: time, class: 'w-2/12' },\n\t\t\t\t\t{ name: 'Query', value: row.query, class: 'w-7/12' },\n\t\t\t\t\t{ name: 'Duration', value: row.duration, class: 'w-1/12' },\n\t\t\t\t\t{ name: 'Examined', value: row.rows_examined, class: 'w-1/12' },\n\t\t\t\t\t{ name: 'Sent', value: row.sent, class: 'w-1/12' }\n\t\t\t\t];\n\t\t\t\tdata.push(out);\n\t\t\t});\n\t\t\treturn data;\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","_a","out","row","data","_openBlock","_createElementBlock","_hoisted_1","_c","_b","_ctx","_hoisted_2","_withCtx","$data","$options","_hoisted_3","_createCommentVNode","_cache","$event","_createTextVNode","_hoisted_5","_createElementVNode"],"mappings":"60BA4DA,MAAAA,EAAA,+BAEC,MAAA,CAAA,MAAA,wBAIA,MAAA,CACC,MAAA,CACC,QAAA,CACC,CACC,KAAA,UACA,MAAA,sBAEA,MAAA,KAAA,6IAQJ,MAAA,CACC,SAAA,yCAMA,SAAA,aAEA,kCAIC,MAAA,gDAEC,OAAA,CACC,MAAAC,EAAA,KAAA,OAAA,YAAAA,EAAA,KACA,MAAA,KAAA,WAAA,KAAA,mCAEA,QAAA,KAAA,kCAGD,KAAA,8CAMF,SAAA,OACC,MAAA,CACC,IAAA,8BACA,OAAA,CACC,MAAAA,EAAA,KAAA,OAAA,YAAAA,EAAA,MAED,KAAA,GAEF,GAED,QAAA,CACC,OAAA,CACC,KAAA,WAAA,YAAA,MAAA,CACD,GAED,SAAA,2CAIC,SAAA,+BAGA,SAAA,+BAGA,mBAAA,8DAIE,IAAAC,EAAA,CACC,CAAA,KAAA,YAAA,MAFD,KAAA,WAAAC,EAAA,UAAA,2BAAA,EAEC,MAAA,QAAA,EACA,CAAA,KAAA,QAAA,MAAAA,EAAA,MAAA,MAAA,QAAA,2GAGA,CAAA,KAAA,OAAA,MAAAA,EAAA,KAAA,MAAA,QAAA,GAEDC,EAAA,KAAAF,CAAA,CACD,CAAA,GAED,CACD,CACD,WApJE,MAAA,uDAoBE,MAAA,8CAUA,MAAA,yCAmBE,MAAA,gIAlDLG,IAAAC,EAAA,MAAAC,EAAA,UAMgBC,GAAAC,EAAAC,EAAA,WAAA,UAAA,YAAAD,EAAA,OAAA,MAAAD,EAAA,gBAAhBH,IAAAC,EAAA,MAAAK,EAAA,WAPD,QAAAC,EAAA,IAAA,MAUK,QAAAC,EAAA,QACA,QAAA,wPAMA,EACA,KAAAC,EAAA,kBACD,MAAA,4FAImDJ,EAAA,WAAA,YAAA,KAAA,QAAA,GAFpDL,IAAAC,EAAA,MAAAS,EAAA,SArBHC,EAAA,GAAA,EAAA,qCAiCwDN,EAAA,WAAA,YAAA,KAAA,QAAA,+BAjCxDM,EAAA,GAAA,EAAA,sFA2CK,QAAAN,EAAA,WAAA,YAAA,QACD,YAAA,aACC,QAAAO,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAL,EAAA,WAAA,MA7CL,QAAAD,EAAA,IAAAK,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAAE,EAAA,aAAA,0BAAAH,EAAA,GAAA,EAAA,cAmDCX,EAAA,EAAAC,EAAA,MAAAc,EAAAH,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CACCI,EAAA,OAAA,CAAA,MAAA,+BAAA,EAAA,sEAAA,EAAA"}