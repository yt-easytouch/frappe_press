import{q as o,o as n,j as s,x as q,r as b,A as i,w as m,as as K,a9 as X,u as p,h as g,F as _,v as x,n as w,t as P,y as J,a8 as Q,a5 as W,Y as u,at as Z,X as G,ad as a}from"./main-Dpl-JOF2.js";import{_ as $}from"./info-BXlf1Uhm.js";import{_ as ee}from"./Breadcrumbs-yx7M4N4X.js";import{_ as re}from"./Header-BNMc-OFG.js";import{S as se}from"./Summary-B8iBDrxJ.js";import{S as te}from"./ServerPlansCards-Cc172p6H.js";import{C as le}from"./ClickToCopyField-C85Phphs.js";import"./PlansCards-CiqqQthx.js";import"./badge-check-DXteVc7W.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="27ac31da-5c83-42a2-abe8-e983c2d2694b",t._sentryDebugIdIdentifier="sentry-dbid-27ac31da-5c83-42a2-abe8-e983c2d2694b")}catch(c){}})();{var h=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};h._sentryModuleMetadata=h._sentryModuleMetadata||{},h._sentryModuleMetadata[new Error().stack]=Object.assign({},h._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const ne={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ie=s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 2h13a2 2 0 0 1 2 2v4a2 2 0 0 1-2 2h-5m-5 0L2.5 2.5C2 2 2 2.5 2 5v3a2 2 0 0 0 2 2h6zm12 7v-1a2 2 0 0 0-2-2h-1M4 14a2 2 0 0 0-2 2v4a2 2 0 0 0 2 2h16.5l1-.5l.5.5l-8-8H4zm2 4h.01M2 2l20 20"},null,-1),oe=[ie];function ae(t,e){return n(),o("svg",ne,oe)}const de={name:"lucide-server-off",render:ae},pe={components:{ServerPlansCards:te,LucideServer:de,ClickToCopy:le,Summary:se,Header:re},props:["server"],data(){return{serverTitle:"",appServerPlan:"",dbServerPlan:"",serverRegion:"",serverType:"",appPublicIP:"",appPrivateIP:"",dbPublicIP:"",dbPrivateIP:"",planType:"Standard",serverEnabled:!0,agreedToRegionConsent:!1}},watch:{serverType(){this.appServerPlan="",this.dbServerPlan="",this.serverRegion="",this.appPublicIP="",this.appPrivateIP="",this.dbPublicIP="",this.dbPrivateIP=""},planType(){this.appServerPlan="",this.dbServerPlan=""}},resources:{options(){return{url:"press.api.server.options",auto:!0,transform(t){return{server_types:[{name:"dedicated",title:"Dedicated Server",description:"A pair of dedicated servers managed and owned by frappe"},{name:"hybrid",title:"Hybrid Server",description:"A pair of dedicated servers managed by frappe and owned/provisioned by you"}],regions:t.regions,app_plans:t.app_plans.filter(e=>e.premium==0),db_plans:t.db_plans.filter(e=>e.premium==0),app_premium_plans:t.app_plans.filter(e=>e.premium==1),db_premium_plans:t.db_plans.filter(e=>e.premium==1)}},onError(t){t.messages.includes("Servers feature is not yet enabled on your account")&&(this.serverEnabled=!1)}}},hybridOptions(){return{url:"press.api.selfhosted.options_for_new",auto:!0}},createServer(){return{url:"press.api.server.new",validate({server:t}){if(t.title)if(t.cluster)if(t.app_plan)if(t.db_plan){if(Object.keys(this.$team.doc.billing_details).length===0)throw new a("You don't have billing details added. Please add billing details from settings to continue.");if(this.$team.doc.servers_enabled==0&&(this.$team.doc.currency=="USD"&&this.$team.doc.balance<200||this.$team.doc.currency=="INR"&&this.$team.doc.balance<16e3))throw new a("You need to have $200 worth of credits to create a server.")}else throw new a("Please select a Database Server Plan");else throw new a("Please select an App Server Plan");else throw new a("Please select a region");else throw new a("Server name is required")},onSuccess(t){this.$router.push({name:"Server Detail Plays",params:{name:t.server}})}}},createHybridServer(){return{url:"press.api.selfhosted.create_and_verify_selfhosted",validate(){if(this.serverTitle){if(!this.appPublicIP||!this.dbPublicIP||!this.appPrivateIP||!this.dbPrivateIP)throw new a("Please fill all the IP addresses");if(this.validateIP(this.appPublicIP))throw new a("Please enter a valid Application Public IP");if(this.validateIP(this.appPrivateIP))throw new a("Please enter a valid Application Private IP");if(this.validateIP(this.dbPublicIP))throw new a("Please enter a valid Database Public IP");if(this.validateIP(this.dbPrivateIP))throw new a("Please enter a valid Database Private IP");if(this.dbPublicIP===this.appPublicIP)throw new a("Please don't use the same server as Application and Database servers");if(!this.agreedToRegionConsent)throw new a("Please agree to the region consent")}else throw new a("Server name is required")},onSuccess(t){this.$router.push({name:"Server Detail Plays",params:{name:t}})}}}},computed:{options(){return this.$resources.options.data},_totalPerMonth(){var e,c;let t=this.$team.doc.currency=="INR"?"price_inr":"price_usd";if(this.serverType==="dedicated")return this.appServerPlan[t]+this.dbServerPlan[t];if(this.serverType==="hybrid")return((c=(e=this.$resources.hybridOptions)==null?void 0:e.data)==null?void 0:c.plans[0][t])*2},totalPerMonth(){return this.$format.userCurrency(this._totalPerMonth)},totalPerDay(){return this.$format.userCurrency(this.$format.pricePerDay(this._totalPerMonth))},summaryOptions(){var t,e;return[{label:"Server Name",value:this.serverTitle},{label:"Region",value:this.serverRegion,condition:()=>this.serverType==="dedicated"},{label:"App Server Plan",value:this.$format.planTitle(this.appServerPlan)+" per month",condition:()=>this.serverType==="dedicated"},{label:"DB Server Plan",value:this.$format.planTitle(this.dbServerPlan)+" per month",condition:()=>this.serverType==="dedicated"},{label:"App Public IP",value:this.appPublicIP,condition:()=>this.serverType==="hybrid"},{label:"App Private IP",value:this.appPrivateIP,condition:()=>this.serverType==="hybrid"},{label:"DB Public IP",value:this.dbPublicIP,condition:()=>this.serverType==="hybrid"},{label:"DB Private IP",value:this.dbPrivateIP,condition:()=>this.serverType==="hybrid"},{label:"Plan",value:`${this.$format.planTitle((e=(t=this.$resources.hybridOptions)==null?void 0:t.data)==null?void 0:e.plans[0])} per month`,condition:()=>{var c,f;return this.serverType==="hybrid"&&((f=(c=this.$resources.hybridOptions)==null?void 0:c.data)==null?void 0:f.plans[0])}},{label:"Total",value:`${this.totalPerMonth} per month <div class="text-gray-600"> ${this.totalPerDay} per day</div>`,condition:()=>this._totalPerMonth}]}},methods:{validateIP(t){return!t.match(/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)}}},ue={class:"sticky top-0 z-10 shrink-0"},ce={key:0,class:"mx-auto mt-60 w-fit rounded border border-dashed px-12 py-8 text-center text-gray-600"},me={key:1,class:"mx-auto max-w-2xl px-5"},ve={key:0,class:"space-y-12 pb-[50vh] pt-12"},be={class:"flex flex-col"},ye={class:"mt-2 w-full space-y-2"},he={class:"grid grid-cols-2 gap-3"},_e=["onClick"],Pe={class:"flex w-full items-center justify-between space-x-2"},fe={class:"text-sm font-medium"},ge={key:0,class:"flex flex-col"},xe={class:"mt-2"},we={key:1,class:"space-y-12"},Se={key:0,class:"flex flex-col"},Ie={class:"mt-2 w-full space-y-2"},ke={class:"grid grid-cols-2 gap-3"},Te=["onClick"],Ce={class:"flex w-full items-center justify-between"},Ve={class:"flex w-full items-center space-x-2"},De=["src"],Ae={class:"text-sm font-medium"},Re={key:1,class:"flex flex-col"},Be={class:"flex items-center justify-between"},He={class:"mt-2 w-full space-y-2"},Me={class:"grid grid-cols-2 gap-3"},Oe=["onClick"],Ee={class:"flex w-full items-center justify-between space-x-2"},Ne={class:"text-sm font-medium"},Ue={key:2},je={key:0,class:"flex flex-col"},Le={class:"mt-2 space-y-2"},Fe={key:3},ze={key:0,class:"flex flex-col"},Ye={class:"mt-2 w-full space-y-2"},qe={key:2,class:"space-y-12"},Ke={class:"flex flex-col space-y-2"},Xe={class:"flex space-x-3"},Je={class:"flex flex-col space-y-2"},Qe={class:"flex space-x-3"},We={class:"flex flex-col space-y-2"},Ze={key:4,class:"flex flex-col space-y-4"},Ge={key:2,class:"mx-auto mt-60 w-fit rounded border-2 border-dashed px-12 py-8 text-center text-gray-600"};function $e(t,e,c,f,r,d){var V,D,A,R,B,H;const O=ee,E=b("Header"),N=K,S=X,I=$,k=J,v=Q,U=W,j=Z,T=G,C=b("ServerPlansCards"),L=b("ClickToCopy"),F=b("Summary"),z=b("LucideServer"),Y=b("router-link");return n(),o(_,null,[s("div",ue,[i(E,null,{default:m(()=>[i(O,{items:[{label:"Servers",route:"/servers"},{label:"New Server",route:"/servers/new"}]})]),_:1})]),!((V=t.$team.doc)!=null&&V.is_desk_user)&&!t.$session.hasServerCreationAccess?(n(),o("div",ce,[i(N,{class:"mx-auto mb-4 h-6 w-6 text-red-600"}),i(S,{message:"You aren't permitted to create new servers"})])):r.serverEnabled?(n(),o("div",me,[d.options?(n(),o("div",ve,[s("div",be,[e[9]||(e[9]=s("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Choose Server Type ",-1)),s("div",ye,[s("div",he,[(n(!0),o(_,null,x((D=d.options)==null?void 0:D.server_types,l=>(n(),o("button",{key:l.name,onClick:y=>r.serverType=l.name,class:w([r.serverType===l.name?"border-gray-900 ring-1 ring-gray-900 hover:bg-gray-100":"border-gray-400 bg-white text-gray-900 ring-gray-200 hover:bg-gray-50","flex w-full items-center rounded border p-3 text-left text-base text-gray-900"])},[s("div",Pe,[s("span",fe,P(l.title),1),i(k,{text:l.description},{default:m(()=>[i(I,{class:"h-4 w-4 text-gray-500"})]),_:2},1032,["text"])])],10,_e))),128))])])]),r.serverType?(n(),o("div",ge,[e[10]||(e[10]=s("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Enter Server Name ",-1)),s("div",xe,[i(v,{modelValue:r.serverTitle,"onUpdate:modelValue":e[0]||(e[0]=l=>r.serverTitle=l),type:"text",class:"block rounded-md border-gray-300 shadow-sm focus:border-gray-900 focus:ring-gray-900 sm:text-sm"},null,8,["modelValue"])])])):p("",!0),r.serverType==="dedicated"?(n(),o("div",we,[(A=d.options)!=null&&A.regions.length?(n(),o("div",Se,[e[11]||(e[11]=s("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Select Region ",-1)),s("div",Ie,[s("div",ke,[(n(!0),o(_,null,x((R=d.options)==null?void 0:R.regions,l=>(n(),o("button",{key:l.name,onClick:y=>r.serverRegion=l.name,class:w([r.serverRegion===l.name?"border-gray-900 ring-1 ring-gray-900 hover:bg-gray-100":"border-gray-400 bg-white text-gray-900 ring-gray-200 hover:bg-gray-50","flex w-full items-center rounded border p-3 text-left text-base text-gray-900"])},[s("div",Ce,[s("div",Ve,[s("img",{src:l.image,class:"h-5 w-5"},null,8,De),s("span",Ae,P(l.title),1)]),l.beta?(n(),g(U,{key:0,label:l.beta?"Beta":""},null,8,["label"])):p("",!0)])],10,Te))),128))])])])):p("",!0),r.serverRegion&&d.options.app_premium_plans.length>0?(n(),o("div",Re,[s("div",Be,[e[13]||(e[13]=s("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Plan Type ",-1)),s("div",null,[i(T,{link:"https://easytouch.cloud/pricing#dedicated",variant:"ghost"},{prefix:m(()=>[i(j,{class:"h-4 w-4 text-gray-700"})]),default:m(()=>[e[12]||(e[12]=u(" Help "))]),_:1})])]),s("div",He,[s("div",Me,[(n(),o(_,null,x([{name:"Standard",description:"Includes standard support and SLAs"},{name:"Premium",description:"Includes enterprise support and SLAs"}],l=>s("button",{key:l.name,onClick:y=>r.planType=l.name,class:w([r.planType===l.name?"border-gray-900 ring-1 ring-gray-900 hover:bg-gray-100":"border-gray-400 bg-white text-gray-900 ring-gray-200 hover:bg-gray-50","flex w-full items-center rounded border p-3 text-left text-base text-gray-900"])},[s("div",Ee,[s("span",Ne,P(l.name),1),i(k,{text:l.description},{default:m(()=>[i(I,{class:"h-4 w-4 text-gray-500"})]),_:2},1032,["text"])])],10,Oe)),64))])])])):p("",!0),r.serverRegion?(n(),o("div",Ue,[(B=d.options)!=null&&B.app_plans.length?(n(),o("div",je,[e[14]||(e[14]=s("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Select Application Server Plan ",-1)),s("div",Le,[i(C,{modelValue:r.appServerPlan,"onUpdate:modelValue":e[1]||(e[1]=l=>r.appServerPlan=l),plans:(r.planType==="Standard"?d.options.app_plans:d.options.app_premium_plans).filter(l=>l.cluster===r.serverRegion)},null,8,["modelValue","plans"])])])):p("",!0)])):p("",!0),r.serverRegion?(n(),o("div",Fe,[(H=d.options)!=null&&H.db_plans.length?(n(),o("div",ze,[e[15]||(e[15]=s("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Select Database Server Plan ",-1)),s("div",Ye,[d.options.db_plans?(n(),g(C,{key:0,modelValue:r.dbServerPlan,"onUpdate:modelValue":e[2]||(e[2]=l=>r.dbServerPlan=l),plans:(r.planType==="Standard"?d.options.db_plans:d.options.db_premium_plans).filter(l=>l.cluster===r.serverRegion)},null,8,["modelValue","plans"])):p("",!0)])])):p("",!0)])):p("",!0)])):r.serverType==="hybrid"?(n(),o("div",qe,[s("div",Ke,[e[16]||(e[16]=s("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," App Server IP Addresses ",-1)),s("div",Xe,[i(v,{class:"w-full",modelValue:r.appPublicIP,"onUpdate:modelValue":e[3]||(e[3]=l=>r.appPublicIP=l),label:"Public IP",type:"text"},null,8,["modelValue"]),i(v,{class:"w-full",modelValue:r.appPrivateIP,"onUpdate:modelValue":e[4]||(e[4]=l=>r.appPrivateIP=l),label:"Private IP",type:"text"},null,8,["modelValue"])])]),s("div",Je,[e[17]||(e[17]=s("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Database Server IP Addresses ",-1)),s("div",Qe,[i(v,{class:"w-full",modelValue:r.dbPublicIP,"onUpdate:modelValue":e[5]||(e[5]=l=>r.dbPublicIP=l),label:"Public IP",type:"text"},null,8,["modelValue"]),i(v,{class:"w-full",modelValue:r.dbPrivateIP,"onUpdate:modelValue":e[6]||(e[6]=l=>r.dbPrivateIP=l),label:"Private IP",type:"text"},null,8,["modelValue"])])]),s("div",We,[e[18]||(e[18]=s("h2",{class:"text-sm font-medium leading-6 text-gray-900"}," Add SSH Key ",-1)),e[19]||(e[19]=s("span",{class:"text-xs text-gray-600"},[u(" Add this SSH Key to "),s("span",{class:"font-mono"},"~/.ssh/authorized_keys"),u(" file on Application and Database server")],-1)),i(L,{textContent:t.$resources.hybridOptions.data.ssh_key},null,8,["textContent"])])])):p("",!0),r.serverTitle&&(r.serverRegion&&r.dbServerPlan&&r.appServerPlan||r.appPublicIP&&r.appPrivateIP&&r.dbPublicIP&&r.dbPrivateIP)?(n(),g(F,{key:3,options:d.summaryOptions},null,8,["options"])):p("",!0),r.serverTitle&&(r.serverRegion&&r.dbServerPlan&&r.appServerPlan||r.appPublicIP&&r.appPrivateIP&&r.dbPublicIP&&r.dbPrivateIP)?(n(),o("div",Ze,[i(v,{type:"checkbox",modelValue:r.agreedToRegionConsent,"onUpdate:modelValue":e[7]||(e[7]=l=>r.agreedToRegionConsent=l),label:"I agree that the laws of the region selected by me shall stand applicable to me and Frappe."},null,8,["modelValue"]),i(S,{class:"my-2",message:t.$resources.createServer.error||t.$resources.createHybridServer.error},null,8,["message"]),i(T,{variant:"solid",disabled:!r.agreedToRegionConsent,onClick:e[8]||(e[8]=l=>{var y,M;return r.serverType==="dedicated"?t.$resources.createServer.submit({server:{title:r.serverTitle,cluster:r.serverRegion,app_plan:(y=r.appServerPlan)==null?void 0:y.name,db_plan:(M=r.dbServerPlan)==null?void 0:M.name}}):t.$resources.createHybridServer.submit({server:{title:r.serverTitle,app_public_ip:r.appPublicIP,app_private_ip:r.appPrivateIP,db_public_ip:r.dbPublicIP,db_private_ip:r.dbPrivateIP,plan:t.$resources.hybridOptions.data.plans[0]}})}),loading:t.$resources.createServer.loading||t.$resources.createHybridServer.loading},{default:m(()=>[u(P(r.serverType==="hybrid"?"Add Hybrid Server":"Create Server"),1)]),_:1},8,["disabled","loading"])])):p("",!0)])):p("",!0)])):(n(),o("div",Ge,[i(z,{class:"mx-auto mb-4 h-8 w-8"}),e[23]||(e[23]=s("p",null,"Server feature isn't enabled for your account.",-1)),e[24]||(e[24]=s("p",null,"You need to have $200 worth of credits to enable this feature.",-1)),s("p",null,[e[21]||(e[21]=u(" Please add it from ")),i(Y,{class:"underline",to:{name:"BillingOverview"}},{default:m(()=>e[20]||(e[20]=[u("here")])),_:1}),e[22]||(e[22]=u(". "))]),e[25]||(e[25]=s("p",null,[u(" Or you can "),s("a",{class:"underline",href:"https://easytouch.cloud/support",target:"_blank"},"contact support"),u(" to enable it. ")],-1))]))],64)}const dr=q(pe,[["render",$e]]);export{dr as default};
//# sourceMappingURL=NewServer-CfJQGOH7.js.map
