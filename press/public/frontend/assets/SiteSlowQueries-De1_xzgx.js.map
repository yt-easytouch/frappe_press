{"version":3,"file":"SiteSlowQueries-De1_xzgx.js","sources":["../../../../dashboard/src2/components/site/performance/SiteSlowQueryDialog.vue","../../../../dashboard/src2/components/site/performance/SiteSlowQueries.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\t:options=\"{\n\t\t\ttitle: 'Normalized Query',\n\t\t\tsize: '2xl'\n\t\t}\"\n\t\tv-model=\"show\"\n\t>\n\t\t<template #body-content>\n\t\t\t<pre\n\t\t\t\tclass=\"mt-2 whitespace-pre-wrap rounded-lg border-2 border-gray-200 bg-gray-100 p-3 text-sm text-gray-700\"\n\t\t\t\t>{{ query }}</pre\n\t\t\t>\n\t\t\t<div class=\"mt-2 flex text-sm\">\n\t\t\t\t<span class=\"ml-auto\">Duration: {{ duration.toFixed(2) }} seconds</span>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n\n<script>\nexport default {\n\tprops: ['query', 'duration']\n};\n</script>\n","<template>\n\t<div>\n\t\t<PerformanceReport\n\t\t\ttitle=\"Slow Queries\"\n\t\t\t:site=\"name\"\n\t\t\t:reportOptions=\"slowQueriesOptions\"\n\t\t/>\n\t\t<SiteSlowQueryDialog\n\t\t\tv-if=\"show\"\n\t\t\tv-model=\"show\"\n\t\t\t:query=\"selectedQuery\"\n\t\t\t:duration=\"selectedQueryDuration\"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nimport AlertBanner from '../../AlertBanner.vue';\nimport PerformanceReport from './PerformanceReport.vue';\nimport SiteSlowQueryDialog from './SiteSlowQueryDialog.vue';\n\nexport default {\n\tprops: ['name', 'siteVersion'],\n\tcomponents: {\n\t\tPerformanceReport,\n\t\tAlertBanner,\n\t\tSiteSlowQueryDialog\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshow: false,\n\t\t\tselectedQuery: '',\n\t\t\tselectedQueryDuration: 0\n\t\t};\n\t},\n\tcomputed: {\n\t\tslowQueriesOptions() {\n\t\t\treturn {\n\t\t\t\texperimental: true,\n\t\t\t\tdocumentation: 'https://easytouch.cloud/docs/performance-tuning',\n\t\t\t\tdata: () => this.$resources.slowQueries.data.data,\n\t\t\t\tonRowClick: row => {\n\t\t\t\t\tthis.selectedQuery = row.query;\n\t\t\t\t\tthis.selectedQueryDuration = row.duration;\n\t\t\t\t\tthis.show = true;\n\t\t\t\t},\n\t\t\t\temptyStateMessage: 'No slow queries found',\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Query',\n\t\t\t\t\t\tfieldname: 'query',\n\t\t\t\t\t\tclass: 'font-mono',\n\t\t\t\t\t\twidth: '600px'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Duration',\n\t\t\t\t\t\tfieldname: 'duration',\n\t\t\t\t\t\tclass: 'text-gray-600',\n\t\t\t\t\t\twidth: 0.3,\n\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\tformat: value => value.toFixed(2)\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Rows Examined',\n\t\t\t\t\t\tfieldname: 'rows_examined',\n\t\t\t\t\t\tclass: 'text-gray-600',\n\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\twidth: 0.3\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Rows Sent',\n\t\t\t\t\t\tfieldname: 'rows_sent',\n\t\t\t\t\t\tclass: 'text-gray-600',\n\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\twidth: 0.3\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Count',\n\t\t\t\t\t\tfieldname: 'count',\n\t\t\t\t\t\tclass: 'text-gray-600',\n\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\twidth: 0.3\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tactions: () => [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Refresh',\n\t\t\t\t\t\ticon: 'refresh-ccw',\n\t\t\t\t\t\tloading: this.$resources.slowQueries.loading,\n\t\t\t\t\t\tonClick: () => this.$resources.slowQueries.reload()\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\tgetDateTimeRange() {\n\t\t\tconst formatDateTime = date => {\n\t\t\t\treturn this.$dayjs(date).format('YYYY-MM-DD HH:mm:ss');\n\t\t\t};\n\n\t\t\tconst now = new Date();\n\t\t\tconst startDateTime = new Date(now.getTime() - 24 * 60 * 60 * 1000);\n\t\t\tconst endDateTime = formatDateTime(now);\n\t\t\tconst startDateTimeFormatted = formatDateTime(startDateTime);\n\n\t\t\treturn {\n\t\t\t\tstartDateTime: startDateTimeFormatted,\n\t\t\t\tendDateTime: endDateTime\n\t\t\t};\n\t\t}\n\t},\n\tresources: {\n\t\tslowQueries() {\n\t\t\tconst { startDateTime, endDateTime } = this.getDateTimeRange();\n\t\t\treturn {\n\t\t\t\turl: 'press.api.analytics.mariadb_slow_queries',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.name,\n\t\t\t\t\tstart_datetime: startDateTime,\n\t\t\t\t\tstop_datetime: endDateTime,\n\t\t\t\t\tmax_lines: 10,\n\t\t\t\t\tsearch_pattern: '.*',\n\t\t\t\t\tnormalize_queries: true,\n\t\t\t\t\tanalyze: false\n\t\t\t\t},\n\t\t\t\tauto: true,\n\t\t\t\tinitialData: { columns: [], data: [] }\n\t\t\t};\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","_hoisted_1","_hoisted_2","_hoisted_3","_ctx","_cache","$event","_withCtx","_createElementVNode","PerformanceReport","SiteSlowQueryDialog","row","now","endDateTime","formatDateTime","$props","$options","$data","_createCommentVNode"],"mappings":"yzBAqBA,MAAAA,EAAA,2BAEA,EAbIC,EAAA,CAAA,MAAA,oGAAA,EAGIC,EAAA,CAAA,MAAA,mBAAA,EACEC,EAAA,CAAA,MAAA,SAAA,oDAZP,QAAA,oCAGA,EALH,WAAAC,EAAA,KAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,KAAAE,KAQa,eAAAC,EAAA,IAAA,yBAKVC,EAAA,MAAAN,EAAA,uHCQHF,EAAA,0CAGE,kBAAAS,gBAEA,oBAAAC,GAED,MAAA,CACC,MAAA,SAEC,cAAA,6BAIF,SAAA,CACC,oBAAA,CACC,MAAA,CACC,aAAA,GACA,cAAA,iGAEA,WAAAC,GAAA,4BAEC,KAAA,sBAAAA,EAAA,SACA,KAAA,KAAA,IAED,kBAAA,wBACA,QAAA,CACC,eAEC,UAAA,QACA,MAAA,2BAGD,CACC,MAAA,WACA,UAAA,WACA,MAAA,gBACA,MAAA,yCAID,CACC,MAAA,0CAEA,MAAA,8BAEA,MAAA,IAED,CACC,MAAA,YACA,UAAA,YACA,MAAA,8BAEA,MAAA,IAED,eAEC,UAAA,QACA,MAAA,8BAEA,MAAA,EACD,gBAGA,CACC,MAAA,UACA,KAAA,cACA,QAAA,KAAA,WAAA,YAAA,wDAED,CACD,EAEF,GAED,QAAA,CACC,kBAAA,yDAKCC,EAAA,IAAA,0CAEAC,EAAAC,EAAAF,CAAA,EAGA,MAAA,CACC,iCAGF,yFAKC,MAAA,gDAEC,OAAA,CACC,KAAA,KAAA,mDAIA,eAAA,sCAID,KAAA,GACA,YAAA,CAAA,QAAA,CAAA,EAAA,KAAA,CAAA,CAAA,EAEF,CACD,CACD,kHAhIG,MAAA,eACC,KAAAG,EAAA,KACA,cAAAC,EAAA,4EALJ,WAAAC,EAAA,KAAA,sBAAAZ,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAW,EAAA,KAAAX,GAUI,MAAAW,EAAA,cACA,SAAAA,EAAA,kEAXJC,EAAA,GAAA,EAAA"}