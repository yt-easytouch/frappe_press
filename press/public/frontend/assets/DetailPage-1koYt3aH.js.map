{"version":3,"file":"DetailPage-1koYt3aH.js","sources":["../../../../dashboard/src2/pages/DetailPage.vue"],"sourcesContent":["<template>\n\t<Header class=\"sticky top-0 z-10 bg-white\">\n\t\t<div class=\"w-full sm:flex sm:items-center sm:justify-between\">\n\t\t\t<div class=\"flex items-center space-x-2\">\n\t\t\t\t<FBreadcrumbs :items=\"breadcrumbs\" />\n\t\t\t\t<Badge\n\t\t\t\t\tclass=\"hidden sm:inline-flex\"\n\t\t\t\t\tv-if=\"$resources.document?.doc && badge\"\n\t\t\t\t\tv-bind=\"badge\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass=\"mt-1 flex items-center justify-between space-x-2 sm:mt-0\"\n\t\t\t\tv-if=\"$resources.document?.doc\"\n\t\t\t>\n\t\t\t\t<div class=\"sm:hidden\">\n\t\t\t\t\t<Badge v-if=\"$resources.document?.doc && badge\" v-bind=\"badge\" />\n\t\t\t\t</div>\n\t\t\t\t<div class=\"space-x-2\">\n\t\t\t\t\t<ActionButton\n\t\t\t\t\t\tv-for=\"button in actions\"\n\t\t\t\t\t\tv-bind=\"button\"\n\t\t\t\t\t\t:key=\"button.label\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</Header>\n\t<div>\n\t\t<TabsWithRouter\n\t\t\tv-if=\"!$resources.document.get.error && $resources.document.get.fetched\"\n\t\t\t:document=\"$resources.document?.doc\"\n\t\t\t:tabs=\"tabs\"\n\t\t>\n\t\t\t<template #tab-content=\"{ tab }\">\n\t\t\t\t<!-- this div is required for some reason -->\n\t\t\t\t<div></div>\n\t\t\t\t<router-view\n\t\t\t\t\tv-if=\"$resources.document?.doc\"\n\t\t\t\t\t:tab=\"tab\"\n\t\t\t\t\t:document=\"$resources.document\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</TabsWithRouter>\n\t\t<div\n\t\t\tv-else-if=\"$resources.document.get.error\"\n\t\t\tclass=\"mx-auto mt-60 w-fit rounded border border-dashed px-12 py-8 text-center text-gray-600\"\n\t\t>\n\t\t\t<i-lucide-alert-triangle class=\"mx-auto mb-4 h-6 w-6 text-red-600\" />\n\t\t\t<ErrorMessage :message=\"$resources.document.get.error\" />\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport Header from '../components/Header.vue';\nimport ActionButton from '../components/ActionButton.vue';\nimport { Breadcrumbs } from 'frappe-ui';\nimport { getObject } from '../objects';\nimport TabsWithRouter from '../components/TabsWithRouter.vue';\n\nlet subscribed = {};\n\nexport default {\n\tname: 'DetailPage',\n\tprops: {\n\t\tid: String,\n\t\tobjectType: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\tname: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t}\n\t},\n\tcomponents: {\n\t\tHeader,\n\t\tActionButton,\n\t\tTabsWithRouter,\n\t\tFBreadcrumbs: Breadcrumbs\n\t},\n\tresources: {\n\t\tdocument() {\n\t\t\treturn {\n\t\t\t\ttype: 'document',\n\t\t\t\tdoctype: this.object.doctype,\n\t\t\t\tname: this.name,\n\t\t\t\twhitelistedMethods: this.object.whitelistedMethods || {},\n\t\t\t\tonError(error) {\n\t\t\t\t\tfor (let message of error?.messages || []) {\n\t\t\t\t\t\tif (message.redirect) {\n\t\t\t\t\t\t\twindow.location.href = message.redirect;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tmounted() {\n\t\tif (!subscribed[`${this.object.doctype}:${this.name}`]) {\n\t\t\tthis.$socket.emit('doc_subscribe', this.object.doctype, this.name);\n\t\t\tsubscribed[`${this.object.doctype}:${this.name}`] = true;\n\t\t}\n\t\tthis.$socket.on('doc_update', data => {\n\t\t\tif (data.doctype === this.object.doctype && data.name === this.name) {\n\t\t\t\tthis.$resources.document.reload();\n\t\t\t}\n\t\t});\n\t},\n\tbeforeUnmount() {\n\t\tlet doctype = this.object.doctype;\n\t\tif (subscribed[`${doctype}:${this.name}`]) {\n\t\t\tthis.$socket.emit('doc_unsubscribe', doctype, this.name);\n\t\t\tsubscribed[`${doctype}:${this.name}`] = false;\n\t\t}\n\t},\n\tcomputed: {\n\t\tobject() {\n\t\t\treturn getObject(this.objectType);\n\t\t},\n\t\ttabs() {\n\t\t\treturn this.object.detail.tabs.filter(tab => {\n\t\t\t\tif (tab.condition) {\n\t\t\t\t\treturn tab.condition({\n\t\t\t\t\t\tdocumentResource: this.$resources.document\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t});\n\t\t},\n\t\ttitle() {\n\t\t\tlet doc = this.$resources.document?.doc;\n\t\t\treturn doc ? doc[this.object.detail.titleField || 'name'] : this.name;\n\t\t},\n\t\tbadge() {\n\t\t\tif (this.object.detail.statusBadge) {\n\t\t\t\treturn this.object.detail.statusBadge({\n\t\t\t\t\tdocumentResource: this.$resources.document\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\t\tactions() {\n\t\t\tif (this.object.detail.actions && this.$resources.document?.doc) {\n\t\t\t\tlet actions = this.object.detail.actions({\n\t\t\t\t\tdocumentResource: this.$resources.document\n\t\t\t\t});\n\t\t\t\treturn actions.filter(action => {\n\t\t\t\t\tif (action.condition) {\n\t\t\t\t\t\treturn action.condition({\n\t\t\t\t\t\t\tdocumentResource: this.$resources.document\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn [];\n\t\t},\n\t\tbreadcrumbs() {\n\t\t\tlet items = [\n\t\t\t\t{ label: this.object.list.title, route: this.object.list.route },\n\t\t\t\t{\n\t\t\t\t\tlabel: this.title,\n\t\t\t\t\troute: {\n\t\t\t\t\t\tname: `${this.object.doctype} Detail`,\n\t\t\t\t\t\tparams: { name: this.name }\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t];\n\t\t\tif (this.object.detail.breadcrumbs && this.$resources.document?.doc) {\n\t\t\t\tlet result = this.object.detail.breadcrumbs({\n\t\t\t\t\tdocumentResource: this.$resources.document,\n\t\t\t\t\titems\n\t\t\t\t});\n\t\t\t\tif (Array.isArray(result)) {\n\t\t\t\t\titems = result;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// add ellipsis if breadcrumbs too long\n\t\t\tfor (let i = 0; i < items.length; i++) {\n\t\t\t\tif (items[i].label.length > 30 && i !== items.length - 1) {\n\t\t\t\t\titems[i].label = items[i].label.slice(0, 30) + '...';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn items;\n\t\t}\n\t}\n};\n</script>\n<style scoped>\n:deep(button[role='tab']) {\n\twhite-space: nowrap;\n}\n</style>\n"],"names":["subscribed","_sfc_main","Header","TabsWithRouter","error","message","data","doctype","getObject","tab","doc","_a","action","items","result","i","_hoisted_1","_hoisted_2","_hoisted_4","_hoisted_5","_openBlock","_createElementBlock","_Fragment","_withCtx","_createElementVNode","_ctx","$options","_createBlock","_component_Badge","_mergeProps","_createCommentVNode","_hoisted_3","_c","_normalizeProps","_renderList","button","_component_ActionButton","_hoisted_6"],"mappings":"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"}