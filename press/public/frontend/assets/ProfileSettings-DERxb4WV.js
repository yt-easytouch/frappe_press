var q=(t,e,d)=>new Promise((u,o)=>{var s=c=>{try{f(d.next(c))}catch(_){o(_)}},b=c=>{try{f(d.throw(c))}catch(_){o(_)}},f=c=>c.done?u(c.value):Promise.resolve(c.value).then(s,b);f((d=d.apply(t,e)).next())});import{x as k,r as B,h,o as i,w as r,A as n,aA as F,q as C,u as D,j as a,aK as H,n as O,t as y,X as L,Y as p,a8 as x,a9 as J,F as Y,aB as S,V as A,aF as $,a2 as R,z as U,ax as X,D as M,b as Q,ai as W,ad as z,v as j}from"./main-Dpl-JOF2.js";import{_ as I}from"./Card-BCzTSeNK.js";import{_ as T}from"./ListItem-CkkFcC1t.js";import{_ as K}from"./FileUploader-C1pIUjCt.js";import{C as Z}from"./Configure2FA-CD1RyWQM.js";import{_ as ee}from"./AddPrepaidCreditsDialog-DtI4IApw.js";import{_ as te}from"./ClickToCopyField-DpU9Eau5.js";import{C as oe}from"./ClickToCopyField-C85Phphs.js";import{C as se}from"./Card-ihLdqqkA.js";import"./datetime-PXpIdgFA.js";import"./dayjs.min-BK4AnHlu.js";import"./PrepaidCreditsForm-DIaFhUMJ.js";import"./stripe.esm-D4yu_pm0.js";import"./StripeLogo-De_iztuU.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="700d4ea6-2bb1-4aec-bddb-33b0a0018a69",t._sentryDebugIdIdentifier="sentry-dbid-700d4ea6-2bb1-4aec-bddb-33b0a0018a69")}catch(d){}})();{var V=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};V._sentryModuleMetadata=V._sentryModuleMetadata||{},V._sentryModuleMetadata[new Error().stack]=Object.assign({},V._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const ae={props:{modelValue:{type:Boolean,required:!0}},components:{Configure2FA:Z},methods:{closeDialog(){this.show=!1}},computed:{is2FAEnabled(){var t,e;return(e=(t=this.$team.doc)==null?void 0:t.user_info)==null?void 0:e.is_2fa_enabled},show:{get(){return this.modelValue},set(t){this.$emit("update:modelValue",t)}}}};function ne(t,e,d,u,o,s){const b=B("Configure2FA"),f=F;return i(),h(f,{modelValue:s.show,"onUpdate:modelValue":e[0]||(e[0]=c=>s.show=c),options:{title:s.is2FAEnabled?"Disable Two-Factor Authentication":"Enable Two-Factor Authentication"}},{"body-content":r(()=>[n(b,{onEnabled:s.closeDialog,onDisabled:s.closeDialog},null,8,["onEnabled","onDisabled"])]),_:1},8,["modelValue","options"])}const re=k(ae,[["render",ne]]),le={name:"AccountProfile",components:{TFADialog:re,FileUploader:K,AddPrepaidCreditsDialog:ee},data(){return{show2FADialog:!1,disableAccount2FACode:"",showProfileEditDialog:!1,showEnableAccountDialog:!1,showDisableAccountDialog:!1,showAddPrepaidCreditsDialog:!1,showActiveServersDialog:!1,showMessage:!1,draftInvoice:{},unpaidInvoices:[]|{}}},computed:{teamEnabled(){return this.$team.doc.enabled},user(){var t,e;return(e=(t=this.$team)==null?void 0:t.doc)==null?void 0:e.user_info}},resources:{updateProfile(){let{first_name:t,last_name:e,email:d}=this.user;return{url:"press.api.account.update_profile",params:{first_name:t,last_name:e,email:d},onSuccess(){this.showProfileEditDialog=!1,this.notifySuccess()}}},disableAccount:{url:"press.api.account.disable_account",onSuccess(){this.showDisableAccountDialog=!1;const t=U(()=>M(()=>import("./ChurnFeedbackDialog-DNx_SsAV.js"),__vite__mapDeps([0,1,2,3])));$(R(t,{team:this.$team.doc.name,onUpdated:()=>{A.success("Your feedback was submitted successfully")}})),A.success("Your account was disabled successfully"),this.reloadAccount()}},enableAccount:{url:"press.api.account.enable_account",onSuccess(){A.success("Your account was enabled successfully"),this.reloadAccount(),this.showEnableAccountDialog=!1}},upcomingInvoice:{url:"press.api.billing.upcoming_invoice",auto:!0,onSuccess(t){this.draftInvoice=t.upcoming_invoice}},unPaidInvoices:{url:"press.api.billing.get_unpaid_invoices",auto:!0,onSuccess(t){this.unpaidInvoices=t}},hasActiveServers(){return{url:"press.api.account.has_active_servers",auto:!0,params:{team:this.$team.doc.name},onSuccess(t){t&&(this.showActiveServersDialog=!0)}}}},methods:{reloadAccount(){this.$team.reload()},onProfilePhotoChange(){this.reloadAccount(),this.notifySuccess()},notifySuccess(){A.success("Your profile was updated successfully")},deactivateAccount(t){const d=this.$team.doc.currency==="INR"?410:5;if(this.draftInvoice&&this.draftInvoice.amount_due>d){const u=U(()=>M(()=>import("./FinalizeInvoicesDialog-Du3Hd19J.js"),__vite__mapDeps([4,1,2])));$(R(u))}else if(this.unpaidInvoices)if(this.unpaidInvoices.length>1)this.showDisableAccountDialog=!1,this.$team.doc.payment_mode==="Prepaid Credits"?this.showAddPrepaidCreditsDialog=!0:S({title:"Multiple unpaid invoices",message:"You have multiple unpaid invoices. Please pay them from the invoices page",primaryAction:{label:"Go to invoices",variant:"solid",onClick:({hide:u})=>{X.push({name:"BillingInvoices"}),u()}}});else{let u=this.unpaidInvoices;u.amount_due>d&&(this.showDisableAccountDialog=!1,S({title:"Clear Unpaid Invoice",message:`You have an unpaid invoice of ${u.currency==="INR"?"â‚¹":"$"} ${u.amount_due}. Please clear it before disabling the account.`,primaryAction:{label:"Settle it now",variant:"solid",onClick:({hide:o})=>{u.stripe_invoice_url&&this.$team.doc.payment_mode==="Card"?window.open(`/api/method/press.api.client.run_doc_method?dt=Invoice&dn=${u.name}&method=stripe_payment_url`):this.showAddPrepaidCreditsDialog=!0,o()}}}))}if(this.showActiveServersDialog){const u=U(()=>M(()=>import("./ActiveServersDialog-Pyelmm_p.js"),__vite__mapDeps([5,1,2])));$(R(u));return}this.$resources.disableAccount.submit({totp_code:t})},confirmPublisherAccount(){S({title:"Become a marketplace app developer?",message:"You will be able to publish apps to our Marketplace upon confirmation.",onSuccess:({hide:t})=>{A.promise(this.$team.setValue.submit({is_developer:1},{onSuccess:()=>{t(),this.$router.push({name:"Marketplace App List"})},onError(e){console.error(e)}}),{success:"You can now publish apps to our Marketplace",error:"Failed to mark you as a developer",loading:"Making you a developer..."})}})}}},ie={class:"flex items-center border-b pb-3"},ue={class:"relative"},de={class:"ml-4"},ce=["onClick"],me={key:0},pe={key:1},fe={class:"ml-4"},be={class:"text-base font-semibold"},_e={class:"mt-1 text-base text-gray-600"},ge={class:"ml-auto"},he={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"};function ve(t,e,d,u,o,s){const b=H,f=K,c=L,_=T,P=x,E=J,g=F,w=B("AddPrepaidCreditsDialog"),v=I,m=B("TFADialog");return i(),C(Y,null,[s.user?(i(),h(v,{key:0,title:"Profile",class:"mx-auto max-w-3xl"},{default:r(()=>[a("div",ie,[a("div",ue,[n(b,{size:"2xl",label:s.user.first_name,image:s.user.user_image},null,8,["label","image"]),n(f,{onSuccess:s.onProfilePhotoChange,fileTypes:"image/*","upload-args":{doctype:"User",docname:s.user.name,method:"press.api.account.update_profile_picture"}},{default:r(({openFileSelector:l,uploading:N,progress:G,error:Ye})=>[a("div",de,[a("button",{onClick:Le=>l(),class:O(["absolute inset-0 grid h-10 w-full place-items-center rounded-full bg-black text-xs font-medium text-white opacity-0 transition hover:opacity-50 focus:opacity-50 focus:outline-none",{"opacity-50":N}])},[N?(i(),C("span",me,y(G)+"%",1)):(i(),C("span",pe,"Edit"))],10,ce)])]),_:1},8,["onSuccess","upload-args"])]),a("div",fe,[a("h3",be,y(s.user.first_name)+" "+y(s.user.last_name),1),a("p",_e,y(s.user.email),1)]),a("div",ge,[n(c,{"icon-left":"edit",onClick:e[0]||(e[0]=l=>o.showProfileEditDialog=!0)},{default:r(()=>e[11]||(e[11]=[p(" Edit ")])),_:1})])]),a("div",null,[t.$team.doc.is_developer?D("",!0):(i(),h(_,{key:0,title:"Become Marketplace Developer",subtitle:"Become a marketplace app publisher"},{actions:r(()=>[n(c,{onClick:s.confirmPublisherAccount},{default:r(()=>e[12]||(e[12]=[a("span",null,"Become a Publisher",-1)])),_:1},8,["onClick"])]),_:1})),n(_,{title:s.user.is_2fa_enabled?"Disable 2FA":"Enable 2FA",subtitle:s.user.is_2fa_enabled?"Disable two-factor authentication for your account":"Enable two-factor authentication for your account to add an extra layer of security"},{actions:r(()=>[n(c,{onClick:e[1]||(e[1]=l=>o.show2FADialog=!0)},{default:r(()=>[p(y(s.user.is_2fa_enabled?"Disable":"Enable"),1)]),_:1})]),_:1},8,["title","subtitle"]),n(_,{title:s.teamEnabled?"Disable Account":"Enable Account",subtitle:s.teamEnabled?"Disable your account and stop billing":"Enable your account and resume billing"},{actions:r(()=>[n(c,{onClick:e[2]||(e[2]=()=>{s.teamEnabled?o.showDisableAccountDialog=!0:o.showEnableAccountDialog=!0})},{default:r(()=>[a("span",{class:O({"text-red-600":s.teamEnabled})},y(s.teamEnabled?"Disable":"Enable"),3)]),_:1})]),_:1},8,["title","subtitle"])]),n(g,{options:{title:"Update Profile Information",actions:[{variant:"solid",label:"Save Changes",onClick:()=>t.$resources.updateProfile.submit()}]},modelValue:o.showProfileEditDialog,"onUpdate:modelValue":e[5]||(e[5]=l=>o.showProfileEditDialog=l)},{"body-content":r(()=>[a("div",he,[n(P,{label:"First Name",modelValue:s.user.first_name,"onUpdate:modelValue":e[3]||(e[3]=l=>s.user.first_name=l)},null,8,["modelValue"]),n(P,{label:"Last Name",modelValue:s.user.last_name,"onUpdate:modelValue":e[4]||(e[4]=l=>s.user.last_name=l)},null,8,["modelValue"])]),n(E,{class:"mt-4",message:t.$resources.updateProfile.error},null,8,["message"])]),_:1},8,["options","modelValue"]),n(g,{options:{title:"Disable Account",actions:[{label:"Disable Account",variant:"solid",theme:"red",loading:t.$resources.disableAccount.loading,onClick:()=>s.deactivateAccount(o.disableAccount2FACode)}]},modelValue:o.showDisableAccountDialog,"onUpdate:modelValue":e[7]||(e[7]=l=>o.showDisableAccountDialog=l)},{"body-content":r(()=>[e[13]||(e[13]=a("div",{class:"prose text-base"},[p(" By confirming this action: "),a("ul",null,[a("li",null,"Your account will be disabled"),a("li",null," Your active sites will be suspended immediately and will be deleted after a week. "),a("li",null,"Your account billing will be stopped")]),p(" You can log in later to enable your account. Do you want to continue? ")],-1)),s.user.is_2fa_enabled?(i(),h(P,{key:0,class:"mt-4",label:"Enter your 2FA code to confirm",modelValue:o.disableAccount2FACode,"onUpdate:modelValue":e[6]||(e[6]=l=>o.disableAccount2FACode=l)},null,8,["modelValue"])):D("",!0),n(E,{class:"mt-2",message:t.$resources.disableAccount.error},null,8,["message"])]),_:1},8,["options","modelValue"]),n(g,{options:{title:"Enable Account",actions:[{label:"Enable Account",variant:"solid",loading:t.$resources.enableAccount.loading,onClick:()=>t.$resources.enableAccount.submit()}]},modelValue:o.showEnableAccountDialog,"onUpdate:modelValue":e[8]||(e[8]=l=>o.showEnableAccountDialog=l)},{"body-content":r(()=>[e[14]||(e[14]=a("div",{class:"prose text-base"},[p(" By confirming this action: "),a("ul",null,[a("li",null,"Your account will be enabled"),a("li",null,"Your suspended sites will become active"),a("li",null,"Your account billing will be resumed")]),p(" Do you want to continue? ")],-1)),n(E,{class:"mt-2",message:t.$resources.enableAccount.error},null,8,["message"])]),_:1},8,["options","modelValue"]),o.showAddPrepaidCreditsDialog?(i(),h(w,{key:0,showMessage:o.showMessage,modelValue:o.showAddPrepaidCreditsDialog,"onUpdate:modelValue":e[9]||(e[9]=l=>o.showAddPrepaidCreditsDialog=l),onSuccess:s.reloadAccount},null,8,["showMessage","modelValue","onSuccess"])):D("",!0)]),_:1})):D("",!0),n(m,{modelValue:o.show2FADialog,"onUpdate:modelValue":e[10]||(e[10]=l=>o.show2FADialog=l)},null,8,["modelValue"])],64)}const ye=k(le,[["render",ve]]),we={name:"AccountReferral",components:{ClickToCopyField:oe},computed:{referralLink(){var t,e;return(t=this.$team.doc)!=null&&t.referrer_id?`${location.origin}/dashboard/signup?referrer=${(e=this.$team.doc)==null?void 0:e.referrer_id}`:""},minimumSpentAmount(){var t;return((t=this.$team.doc)==null?void 0:t.country)=="India"?"â‚¹1800":"$25"},creditAmountInTeamCurrency(){var t;return((t=this.$team.doc)==null?void 0:t.country)=="India"?"â‚¹750":"$10"}}},Ae={class:"flex flex-col space-y-4 overflow-hidden"},De={class:"text-sm font-medium leading-4 text-gray-700"};function Ce(t,e,d,u,o,s){const b=te,f=I;return s.referralLink?(i(),h(f,{key:0,title:"Refer & Earn",subtitle:"Your unique referral link",class:"mx-auto max-w-3xl"},{default:r(()=>[a("div",Ae,[n(b,{textContent:s.referralLink},null,8,["textContent"]),a("span",De,[e[0]||(e[0]=p(" Invite someone to Easytouch Cloud and ")),a("strong",null," get "+y(s.creditAmountInTeamCurrency)+" in Easytouch Cloud credits",1),p(" when they sign up and spend at least "+y(s.minimumSpentAmount)+"! ",1)])])]),_:1})):D("",!0)}const Ee=k(we,[["render",Ce]]),Pe={name:"AccountPartner",components:{Card:se,FormControl:x},data(){return{showAddPartnerCodeDialog:!1,showRemovePartnerDialog:!1,code:"",partnerExists:!1,partner:"",errorMessage:""}},resources:{addPartnerCode(){return{url:"press.api.partner.add_partner",params:{referral_code:this.code},onSuccess(t){this.showAddPartnerCodeDialog=!1,t==="Request already sent"?A.error("Approval Request has already been sent to Partner"):A.success("Approval Request has been sent to Partner. Please wait for Partner to accept the request")},onError(){throw new z("Failed to add Partner Code")}}},partnerName(){var t;return{url:"press.api.partner.get_partner_name",auto:!0,params:{partner_email:(t=this.$team.doc)==null?void 0:t.partner_email}}},removePartner(){return{url:"press.api.partner.remove_partner",onSuccess(){this.showRemovePartnerDialog=!1,A.success("Partner removed successfully")},onError(){throw new z("Failed to remove Partner")}}}},methods:{referralCodeChange:Q(function(t){return q(this,null,function*(){let e=t.target.value;this.partnerExists=!1;let d=yield W({url:"press.api.partner.validate_partner_code",params:{code:e}}),u=d[0],o=d[1];u?(this.partnerExists=!0,this.referralCode=e,this.partner=o):this.errorMessage=`${e} is Invalid Referral Code`})},500)},computed:{partner_billing_name(){return this.$resources.partnerName.data}}},ke={class:"py-4"},Ve={key:0,class:"text-base font-medium text-gray-700"},Fe={class:"mt-1"},xe={key:0,class:"text-sm text-green-600",role:"alert"};function Ie(t,e,d,u,o,s){var E;const b=L,f=T,c=x,_=F,P=I;return(E=t.$team.doc)!=null&&E.erpnext_partner?D("",!0):(i(),h(P,{key:0,title:"Frappe Partner",subtitle:"Frappe Partner associated with your account",class:"mx-auto max-w-3xl"},{actions:r(()=>{var g;return[(g=t.$team.doc)!=null&&g.partner_email?(i(),h(b,{key:1,"icon-left":"trash-2",onClick:e[1]||(e[1]=w=>o.showRemovePartnerDialog=!0)},{default:r(()=>e[6]||(e[6]=[p(" Unlink Partner ")])),_:1})):(i(),h(b,{key:0,"icon-left":"edit",onClick:e[0]||(e[0]=w=>o.showAddPartnerCodeDialog=!0)},{default:r(()=>e[5]||(e[5]=[p(" Add Partner Code ")])),_:1}))]}),default:r(()=>{var g,w;return[a("div",ke,[(g=t.$team.doc)!=null&&g.partner_email?(i(),h(f,{key:1,title:s.partner_billing_name,subtitle:(w=t.$team.doc)==null?void 0:w.partner_email},null,8,["title","subtitle"])):(i(),C("span",Ve,e[7]||(e[7]=[p(" Have a Frappe Partner Referral Code? Click on "),a("strong",null,"Add Partner Code",-1),p(" to link with your Partner team. ")])))]),n(_,{options:{title:"Link Partner Account",actions:[{label:"Submit",variant:"solid",onClick:()=>t.$resources.addPartnerCode.submit()}]},modelValue:o.showAddPartnerCodeDialog,"onUpdate:modelValue":e[3]||(e[3]=v=>o.showAddPartnerCodeDialog=v)},{"body-content":r(()=>[e[8]||(e[8]=a("p",{class:"pb-2 text-p-base"}," Enter the partner code provided by your Partner ",-1)),e[9]||(e[9]=a("div",{class:"rounded border border-gray-200 bg-gray-100 p-2 mb-4"},[a("span",{class:"text-sm leading-[1.5] text-gray-700"},[a("strong",null,"Note"),p(": After linking with Partner, following details shall be shared with your partner team: "),a("br"),a("li",null,"Billing name"),a("li",null,"Monthly billing amount")])],-1)),n(c,{placeholder:"e.g. rGjw3hJ81b",modelValue:o.code,"onUpdate:modelValue":e[2]||(e[2]=v=>o.code=v),onInput:s.referralCodeChange},null,8,["modelValue","onInput"]),a("div",Fe,[o.partnerExists?(i(),C("div",xe," Referral Code "+y(o.code)+" belongs to "+y(o.partner),1)):D("",!0)])]),_:1},8,["options","modelValue"]),n(_,{modelValue:o.showRemovePartnerDialog,"onUpdate:modelValue":e[4]||(e[4]=v=>o.showRemovePartnerDialog=v),options:{title:"Remove Partner",actions:[{label:"Remove",variant:"solid",theme:"red",onClick:()=>{t.$resources.removePartner.submit()}}]}},{"body-content":r(()=>e[10]||(e[10]=[a("div",{class:"text-p-base pb-2"},[p(" This will remove the Partner associated with your account. Are you sure you want to remove the Partner? "),a("br"),a("br"),a("div",{class:"text-gray-800 bg-gray-200 p-2 rounded-md"}," Your partner will no longer have access to your sites and servers and will be removed as team member from your team. ")],-1)])),_:1},8,["modelValue","options"])]}),_:1}))}const Se=k(Pe,[["render",Ie]]),$e={name:"AccountEmails",data(){return{showEmailsEditDialog:!1,emailData:[]}},resources:{getEmails(){return{url:"press.api.account.get_emails",auto:!0,transform(t){this.emailData=t.map(e=>({type:e.type,value:e.value}))}}},changeEmail(){return{url:"press.api.account.update_emails",params:{data:JSON.stringify(this.emailData)},onSuccess(t){this.showEmailsEditDialog=!1,A.success("Emails updated successfully")}}}},computed:{fieldLabelMap(){return{billing_email:"Get billing emails at",notify_email:"Get operational emails at"}}}};function Re(t,e,d,u,o,s){var g,w,v;const b=L,f=T,c=x,_=J,P=F,E=I;return((w=(g=t.$team)==null?void 0:g.doc)==null?void 0:w.user)===((v=t.$session)==null?void 0:v.user)?(i(),h(E,{key:0,title:"Email Notifications",class:"mx-auto max-w-3xl"},{actions:r(()=>[n(b,{"icon-left":"edit",onClick:e[0]||(e[0]=m=>o.showEmailsEditDialog=!0)},{default:r(()=>e[2]||(e[2]=[p(" Edit ")])),_:1})]),default:r(()=>[o.emailData?(i(!0),C(Y,{key:0},j(o.emailData,m=>(i(),h(f,{title:s.fieldLabelMap[m.type]||m.type,description:m.value,key:m.type},null,8,["title","description"]))),128)):D("",!0),n(P,{options:{title:"Edit Emails",actions:[{label:"Save Changes",variant:"solid",onClick:()=>t.$resources.changeEmail.submit()}]},modelValue:o.showEmailsEditDialog,"onUpdate:modelValue":e[1]||(e[1]=m=>o.showEmailsEditDialog=m)},{"body-content":r(()=>[(i(!0),C(Y,null,j(o.emailData,m=>(i(),C("div",{class:"mt-3",key:m.type},[n(c,{label:s.fieldLabelMap[m.type]||m.type,modelValue:m.value,"onUpdate:modelValue":l=>m.value=l},null,8,["label","modelValue","onUpdate:modelValue"])]))),128)),n(_,{class:"mt-2",message:t.$resources.changeEmail.error},null,8,["message"])]),_:1},8,["options","modelValue"])]),_:1})):D("",!0)}const Ue=k($e,[["render",Re]]),Me={class:"p-5"},Be={class:"space-y-5"},tt={__name:"ProfileSettings",setup(t){return document.title="Settings - Profile",(e,d)=>(i(),C("div",Me,[a("div",Be,[n(ye),n(Ee),n(Se),n(Ue)])]))}};export{tt as default};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ChurnFeedbackDialog-DNx_SsAV.js","assets/main-Dpl-JOF2.js","assets/main-B0ZLDivw.css","assets/ChurnFeedbackDialog-wW-6SoKX.css","assets/FinalizeInvoicesDialog-Du3Hd19J.js","assets/ActiveServersDialog-Pyelmm_p.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
//# sourceMappingURL=ProfileSettings-DERxb4WV.js.map
