var $=Object.defineProperty,x=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var _=(e,t,s)=>t in e?$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s,p=(e,t)=>{for(var s in t||(t={}))J.call(t,s)&&_(e,s,t[s]);if(v)for(var s of v(t))B.call(t,s)&&_(e,s,t[s]);return e},m=(e,t)=>x(e,C(t));import{_ as b}from"./Tabs-d4e9i9wh.js";import{x as D,r as j,q as f,o as u,j as n,u as h,A as a,w as d,C as A,X as U,t as I,a5 as E,h as M,k as O}from"./main-Dpl-JOF2.js";import{_ as T}from"./Breadcrumbs-yx7M4N4X.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="1e984212-039f-4818-90e6-a56328f6b397",e._sentryDebugIdIdentifier="sentry-dbid-1e984212-039f-4818-90e6-a56328f6b397")}catch(s){}})();{var i=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};i._sentryModuleMetadata=i._sentryModuleMetadata||{},i._sentryModuleMetadata[new Error().stack]=Object.assign({},i._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const P={name:"CodeServer",components:{Tabs:b},props:["serverName"],data(){return{runningJob:!1}},methods:{open(){window.open(`https://${this.serverName}`,"_blank")},onSocketUpdate({doctype:e,name:t}){e==="Code Server"&&t===this.serverName&&this.$resources.codeServer.reload()},setupAgentJobUpdate(){this._agentJobUpdateSet||(this._agentJobUpdateSet=!0,this.$socket.on("agent_job_update",e=>{e.name==="Setup Code Server"&&e.status==="Success"&&e.code_server===this.serverName&&setTimeout(()=>{this.$router.push(`/codeservers/${this.serverName}/overview`),this.$resources.codeServer.reload()},1e3),this.runningJob=e.code_server===this.serverName&&e.status!=="Success"}))},routeToGeneral(){if(this.$route.matched.length===1){let e=["Pending"].includes(this.codeServer.status)?"jobs":"overview";this.$router.replace(`/codeservers/${this.serverName}/${e}`)}}},resources:{codeServer(){return{url:"press.api.spaces.code_server",params:{name:this.serverName},auto:!0,onSuccess:this.routeToGeneral,onError:this.$routeTo404PageIfNotFound}}},activated(){var e;this.setupAgentJobUpdate(),((e=this.codeServer)==null?void 0:e.status)==="Running"&&this.$socket.on("list_update",this.onSocketUpdate)},deactivated(){this.$socket.off("list_update",this.onSocketUpdate)},computed:{codeServer(){return this.$resources.codeServer.data},tabs(){let e=r=>`/codeservers/${this.serverName}/${r}`,t=[{label:"Overview",route:"overview"},{label:"Jobs",route:"jobs",showRedDot:this.runningJob}],s={Active:["Overview","Jobs"],Pending:["Jobs"]};if(this.codeServer){let r=s[this.codeServer.status];return r!=null&&r.length&&(t=t.filter(c=>r.includes(c.label))),t.map(c=>m(p({},c),{route:e(c.route)}))}return[]},codeServerActions(){return[{label:"Open",icon:"external-link",onClick:()=>{window.open(`https://${this.serverName}`,"_blank")}}]}}},R={class:"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5"},V={key:0,class:"p-5"},z={class:"pb-2"},q={class:"flex flex-col space-y-3 md:flex-row md:items-baseline md:justify-between md:space-y-0"},F={class:"mt-2 flex items-center"},K={class:"text-2xl font-bold"};function X(e,t,s,r,c,o){const S=U,g=A,w=T,y=E,k=j("router-view"),N=b;return u(),f("div",null,[n("header",R,[a(w,{items:[{label:"Spaces",route:{name:"Spaces"}},{label:s.serverName,route:{name:"CodeServerOverview",params:{serverName:s.serverName}}}]},{actions:d(()=>[n("div",null,[a(g,{options:o.codeServerActions},{default:d(({open:l})=>[a(S,{variant:"ghost",class:"mr-2",icon:"more-horizontal"})]),_:1},8,["options"])])]),_:1},8,["items"])]),o.codeServer?(u(),f("div",V,[n("div",z,[n("div",q,[n("div",F,[n("h1",K,I(o.codeServer.name),1),a(y,{class:"ml-4",label:o.codeServer.status,colorMap:e.$badgeStatusColorMap},null,8,["label","colorMap"])])])]),a(N,{tabs:o.tabs},{default:d(()=>[a(k,null,{default:d(({Component:l,route:H})=>[o.codeServer?(u(),M(O(l),{key:0,codeServer:o.codeServer},null,8,["codeServer"])):h("",!0)]),_:1})]),_:1},8,["tabs"])])):h("",!0)])}const Z=D(P,[["render",X]]);export{Z as default};
//# sourceMappingURL=CodeServer-Du8T5HCY.js.map
