{"version":3,"file":"PlayPage-BWYvGN-p.js","sources":["../../../../dashboard/src2/pages/PlayPage.vue"],"sourcesContent":["<template>\n\t<div class=\"p-5\" v-if=\"play\">\n\t\t<Button :route=\"{ name: `${object.doctype} Detail Plays` }\">\n\t\t\t<template #prefix>\n\t\t\t\t<i-lucide-arrow-left class=\"inline-block h-4 w-4\" />\n\t\t\t</template>\n\t\t\tAll plays\n\t\t</Button>\n\n\t\t<div class=\"mt-3\">\n\t\t\t<div>\n\t\t\t\t<div class=\"flex items-center\">\n\t\t\t\t\t<h2 class=\"text-lg font-medium text-gray-900\">{{ play.play }}</h2>\n\t\t\t\t\t<Badge class=\"ml-2\" :label=\"play.status\" />\n\t\t\t\t\t<div class=\"ml-auto space-x-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t@click=\"$resources.play.reload()\"\n\t\t\t\t\t\t\t:loading=\"$resources.play.loading\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t<i-lucide-refresh-ccw class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Dropdown v-if=\"dropdownOptions.length\" :options=\"dropdownOptions\">\n\t\t\t\t\t\t\t<template v-slot=\"{ open }\">\n\t\t\t\t\t\t\t\t<Button>\n\t\t\t\t\t\t\t\t\t<template #icon>\n\t\t\t\t\t\t\t\t\t\t<i-lucide-more-horizontal class=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</Dropdown>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div>\n\t\t\t\t\t<div class=\"mt-4 grid grid-cols-5 gap-4\">\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">Creation</div>\n\t\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t\t{{ $format.date(play.creation) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">Creator</div>\n\t\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t\t{{ play.owner }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">Duration</div>\n\t\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t\t{{ $format.duration(play.duration) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">Start</div>\n\t\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t\t{{ $format.date(play.start) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div class=\"text-sm font-medium text-gray-500\">End</div>\n\t\t\t\t\t\t\t<div class=\"mt-2 text-sm text-gray-900\">\n\t\t\t\t\t\t\t\t{{ $format.date(play.end) }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"mt-8 space-y-4\">\n\t\t\t\t<JobStep v-for=\"task in play.tasks\" :step=\"task\" :key=\"task.name\" />\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport { FeatherIcon, Tooltip } from 'frappe-ui';\nimport { duration } from '../utils/format';\nimport { getObject } from '../objects';\nimport JobStep from '../components/JobStep.vue';\n\nexport default {\n\tname: 'PlayPage',\n\tprops: ['id', 'objectType'],\n\tcomponents: { Tooltip, FeatherIcon, JobStep },\n\tresources: {\n\t\tplay() {\n\t\t\treturn {\n\t\t\t\ttype: 'document',\n\t\t\t\tdoctype: 'Ansible Play',\n\t\t\t\tname: this.id,\n\t\t\t\ttransform(play) {\n\t\t\t\t\tfor (let task of play.tasks) {\n\t\t\t\t\t\ttask.title = task.task;\n\t\t\t\t\t\ttask.duration = duration(task.duration);\n\t\t\t\t\t\ttask.isOpen = false;\n\t\t\t\t\t}\n\t\t\t\t\treturn play;\n\t\t\t\t},\n\t\t\t\tonSuccess() {\n\t\t\t\t\tthis.lastLoaded = Date.now();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tcomputed: {\n\t\tobject() {\n\t\t\treturn getObject(this.objectType);\n\t\t},\n\t\tplay() {\n\t\t\treturn this.$resources.play.doc;\n\t\t},\n\t\tdropdownOptions() {\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'View in Desk',\n\t\t\t\t\ticon: 'external-link',\n\t\t\t\t\tcondition: () => this.$team.doc?.is_desk_user,\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\twindow.open(\n\t\t\t\t\t\t\t`${window.location.protocol}//${window.location.host}/app/ansible-play/${this.id}`,\n\t\t\t\t\t\t\t'_blank'\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t].filter(option => option.condition?.() ?? true);\n\t\t}\n\t},\n\tmounted() {\n\t\tthis.$socket.emit('doc_subscribe', 'Ansible Play', this.id);\n\t\tthis.$socket.on('ansible_play_update', data => {\n\t\t\tif (data.id === this.id) {\n\t\t\t\tthis.reload();\n\t\t\t}\n\t\t});\n\t\t// reload play every minute, in case socket is not working\n\t\tthis.reloadInterval = setInterval(() => {\n\t\t\tthis.reload();\n\t\t}, 1000 * 60);\n\t},\n\tbeforeUnmount() {\n\t\tthis.$socket.emit('doc_unsubscribe', 'Ansible Play', this.id);\n\t\tthis.$socket.off('ansible_play_update');\n\t\tclearInterval(this.reloadInterval);\n\t},\n\tmethods: {\n\t\treload() {\n\t\t\tif (\n\t\t\t\t!this.$resources.play.loading &&\n\t\t\t\t// reload if play was loaded more than 5 seconds ago\n\t\t\t\tDate.now() - this.lastLoaded > 5000\n\t\t\t) {\n\t\t\t\tthis.$resources.play.reload();\n\t\t\t}\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","Tooltip","FeatherIcon","JobStep","play","task","duration","getObject","_a","option","_b","data","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_openBlock","_createElementBlock","_hoisted_1","_withCtx","_cache","_createTextVNode","_createElementVNode","_toDisplayString","$options","$event","_ctx","_createCommentVNode","_Fragment","_renderList"],"mappings":"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"}