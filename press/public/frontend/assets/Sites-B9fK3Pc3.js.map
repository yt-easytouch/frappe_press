{"version":3,"mappings":"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","names":["_sfc_main","TableRow","TableCell","defineAsyncComponent","__vitePreload","loginAsAdmin","notify","data","event","sites","site","sitesByGroup","group","seen","groups","defaultOptions","tag","_hoisted_1","_hoisted_2","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_16","_hoisted_20","_createElementVNode","_createVNode","_component_Breadcrumbs","_createSlots","_withCtx","$options","_createCommentVNode","_openBlock","_createElementBlock","_hoisted_3","_cache","_createTextVNode","_Fragment","$data","$event","_ctx","rows","columns","_renderList","_toDisplayString","_hoisted_10","_hoisted_11","row","column","_hoisted_12","_hoisted_14","_hoisted_15","_hoisted_17","_hoisted_18","open","_hoisted_19","_createBlock","_component_LoadingText"],"sources":["../../../../dashboard/src/views/site/Sites.vue"],"sourcesContent":["<template>\n\t<div>\n\t\t<div>\n\t\t\t<header\n\t\t\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5\"\n\t\t\t>\n\t\t\t\t<Breadcrumbs :items=\"[{ label: 'Sites', route: { name: 'Sites' } }]\">\n\t\t\t\t\t<template v-if=\"this.$account?.team.enabled\" #actions>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\ticon-left=\"plus\"\n\t\t\t\t\t\t\tclass=\"ml-2\"\n\t\t\t\t\t\t\tlabel=\"Create\"\n\t\t\t\t\t\t\t@click=\"validateCreateSite\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</template>\n\t\t\t\t</Breadcrumbs>\n\t\t\t</header>\n\n\t\t\t<div class=\"my-5 space-y-2 px-5\">\n\t\t\t\t<div v-if=\"!$account.team.enabled\">\n\t\t\t\t\t<Alert title=\"Your account is disabled\">\n\t\t\t\t\t\tEnable your account to start creating sites\n\t\t\t\t\t\t<template #actions>\n\t\t\t\t\t\t\t<Button variant=\"solid\" route=\"/settings/profile\">\n\t\t\t\t\t\t\t\tEnable Account\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Alert>\n\t\t\t\t</div>\n\t\t\t\t<AlertBillingInformation />\n\t\t\t\t<template v-if=\"showUnpaidInvoiceAlert\">\n\t\t\t\t\t<Alert\n\t\t\t\t\t\tv-if=\"latestUnpaidInvoice.payment_mode === 'Prepaid Credits'\"\n\t\t\t\t\t\ttitle=\"Your last invoice payment has failed.\"\n\t\t\t\t\t>\n\t\t\t\t\t\tPlease add\n\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t{{ latestUnpaidInvoice.currency }}\n\t\t\t\t\t\t\t{{ latestUnpaidInvoice.amount_due }}\n\t\t\t\t\t\t</strong>\n\t\t\t\t\t\tmore in credits.\n\t\t\t\t\t\t<template #actions>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t\t$account.team.billing_address\n\t\t\t\t\t\t\t\t\t\t? (showPrepaidCreditsDialog = true)\n\t\t\t\t\t\t\t\t\t\t: (showAddressDialog = true)\n\t\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tAdd Credits\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Alert>\n\n\t\t\t\t\t<Alert v-else title=\"Your last invoice payment has failed.\">\n\t\t\t\t\t\tPay now for uninterrupted services.\n\t\t\t\t\t\t<template v-if=\"this.$resources.latestUnpaidInvoice.data\" #actions>\n\t\t\t\t\t\t\t<router-link\n\t\t\t\t\t\t\t\t:to=\"{ path: '/billing', query: { invoiceStatus: 'Unpaid' } }\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Button variant=\"solid\"> Go to Billing </Button>\n\t\t\t\t\t\t\t</router-link>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Alert>\n\n\t\t\t\t\t<UpdateBillingDetails\n\t\t\t\t\t\tv-if=\"showAddressDialog\"\n\t\t\t\t\t\tv-model=\"showAddressDialog\"\n\t\t\t\t\t\t@updated=\"\n\t\t\t\t\t\t\tshowAddressDialog = false;\n\t\t\t\t\t\t\tshowPrepaidCreditsDialog = true;\n\t\t\t\t\t\t\t$resources.billingDetails.reload();\n\t\t\t\t\t\t\"\n\t\t\t\t\t/>\n\n\t\t\t\t\t<PrepaidCreditsDialog\n\t\t\t\t\t\tv-if=\"showPrepaidCreditsDialog\"\n\t\t\t\t\t\tv-model:show=\"showPrepaidCreditsDialog\"\n\t\t\t\t\t\t:minimum-amount=\"Math.ceil(latestUnpaidInvoice.amount_due)\"\n\t\t\t\t\t\t@success=\"handleAddPrepaidCreditsSuccess\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t\t<div class=\"mx-5\">\n\t\t\t\t<div class=\"pb-20\">\n\t\t\t\t\t<div class=\"flex\">\n\t\t\t\t\t\t<div class=\"flex w-full space-x-2 pb-4\">\n\t\t\t\t\t\t\t<FormControl label=\"Search Sites\" v-model=\"searchTerm\">\n\t\t\t\t\t\t\t\t<template #prefix>\n\t\t\t\t\t\t\t\t\t<FeatherIcon name=\"search\" class=\"w-4 text-gray-600\" />\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\tlabel=\"Status\"\n\t\t\t\t\t\t\t\tclass=\"mr-8\"\n\t\t\t\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t\t\t\t:options=\"siteStatusFilterOptions\"\n\t\t\t\t\t\t\t\tv-model=\"site_status\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\tv-if=\"$resources.siteTags.data.length > 0\"\n\t\t\t\t\t\t\t\tlabel=\"Tag\"\n\t\t\t\t\t\t\t\tclass=\"mr-8\"\n\t\t\t\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t\t\t\t:options=\"siteTagFilterOptions\"\n\t\t\t\t\t\t\t\tv-model=\"site_tag\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Table\n\t\t\t\t\t\t:columns=\"[\n\t\t\t\t\t\t\t{ label: 'Site Name', name: 'name', width: 2 },\n\t\t\t\t\t\t\t{ label: 'Status', name: 'status', width: 1 },\n\t\t\t\t\t\t\t{ label: 'Region', name: 'region', width: 0.5 },\n\t\t\t\t\t\t\t{ label: 'Tags', name: 'tags', width: 1 },\n\t\t\t\t\t\t\t{ label: 'Plan', name: 'plan', width: 1.5 },\n\t\t\t\t\t\t\t{ label: '', name: 'actions', width: 0.5 }\n\t\t\t\t\t\t]\"\n\t\t\t\t\t\t:rows=\"sites\"\n\t\t\t\t\t\tv-slot=\"{ rows, columns }\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<TableHeader class=\"mb-4 hidden lg:grid\" />\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-for=\"group in groups\"\n\t\t\t\t\t\t\t:key=\"group.group\"\n\t\t\t\t\t\t\tclass=\"mb-4 rounded border\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"flex w-full items-center rounded-t bg-gray-50 px-3 py-2 text-base\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span class=\"font-semibold text-gray-900\">\n\t\t\t\t\t\t\t\t\t{{ group.title }}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<span v-if=\"!group.public\" class=\"ml-2 text-gray-600\">{{\n\t\t\t\t\t\t\t\t\tgroup.version\n\t\t\t\t\t\t\t\t}}</span>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tv-if=\"!group.public\"\n\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\tclass=\"ml-auto\"\n\t\t\t\t\t\t\t\t\t:route=\"{ name: 'Bench', params: { benchName: group.group } }\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tView Bench\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<div v-else class=\"h-7\" />\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<TableRow\n\t\t\t\t\t\t\t\tv-for=\"(row, index) in sitesByGroup[group.group]\"\n\t\t\t\t\t\t\t\t:key=\"row.name\"\n\t\t\t\t\t\t\t\t:row=\"row\"\n\t\t\t\t\t\t\t\t:class=\"index === 0 ? 'rounded-b' : 'rounded'\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<TableCell v-for=\"column in columns\">\n\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\tv-if=\"column.name === 'status'\"\n\t\t\t\t\t\t\t\t\t\t:label=\"$siteStatus(row)\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"column.name === 'tags'\"\n\t\t\t\t\t\t\t\t\t\tclass=\"hidden space-x-1 lg:flex\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\t\tv-for=\"(tag, i) in row.tags.slice(0, 1)\"\n\t\t\t\t\t\t\t\t\t\t\ttheme=\"blue\"\n\t\t\t\t\t\t\t\t\t\t\t:label=\"tag\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<Tooltip\n\t\t\t\t\t\t\t\t\t\t\tv-if=\"row.tags.length > 1\"\n\t\t\t\t\t\t\t\t\t\t\t:text=\"row.tags.slice(1).join(', ')\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\t\t\tv-if=\"row.tags.length > 1\"\n\t\t\t\t\t\t\t\t\t\t\t\t:label=\"`+${row.tags.length - 1}`\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</Tooltip>\n\t\t\t\t\t\t\t\t\t\t<span v-if=\"row.tags.length == 0\">-</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"column.name === 'plan'\"\n\t\t\t\t\t\t\t\t\t\tclass=\"hidden md:block\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\t\trow.plan\n\t\t\t\t\t\t\t\t\t\t\t\t? `${$planTitle(row.plan)}${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\trow.plan.price_usd > 0 ? '/mo' : ''\n\t\t\t\t\t\t\t\t\t\t\t\t  }`\n\t\t\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"column.name === 'region'\"\n\t\t\t\t\t\t\t\t\t\tclass=\"hidden md:block\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\tv-if=\"row.server_region_info.image\"\n\t\t\t\t\t\t\t\t\t\t\tclass=\"h-4\"\n\t\t\t\t\t\t\t\t\t\t\t:src=\"row.server_region_info.image\"\n\t\t\t\t\t\t\t\t\t\t\t:alt=\"`Flag of ${row.server_region_info.title}`\"\n\t\t\t\t\t\t\t\t\t\t\t:title=\"row.server_region_info.title\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<span class=\"text-base text-gray-700\" v-else>\n\t\t\t\t\t\t\t\t\t\t\t{{ row.server_region_info.title }}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclass=\"w-full text-right\"\n\t\t\t\t\t\t\t\t\t\tv-else-if=\"column.name == 'actions'\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Dropdown\n\t\t\t\t\t\t\t\t\t\t\tv-if=\"['Active', 'Updating'].includes(row.status)\"\n\t\t\t\t\t\t\t\t\t\t\t@click.prevent\n\t\t\t\t\t\t\t\t\t\t\t:options=\"dropdownItems(row)\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<template v-slot=\"{ open }\">\n\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t:variant=\"open ? 'subtle' : 'ghost'\"\n\t\t\t\t\t\t\t\t\t\t\t\t\ticon=\"more-horizontal\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t\t\t</Dropdown>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<span v-else>{{ row[column.name] || '' }}</span>\n\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"mt-8 flex items-center justify-center\">\n\t\t\t\t\t\t\t<LoadingText\n\t\t\t\t\t\t\t\tv-if=\"$resources.allSites.loading && !$resources.allSites.data\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-else-if=\"$resources.allSites.fetched && rows.length === 0\"\n\t\t\t\t\t\t\t\tclass=\"text-base text-gray-700\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tNo Sites\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Table>\n\n\t\t\t\t\t<Dialog\n\t\t\t\t\t\t:options=\"{\n\t\t\t\t\t\t\ttitle: 'Login As Administrator',\n\t\t\t\t\t\t\tactions: [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlabel: 'Proceed',\n\t\t\t\t\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\t\t\t\t\tonClick: proceedWithLoginAsAdmin\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\"\n\t\t\t\t\t\tv-model=\"showReasonForAdminLoginDialog\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #body-content>\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\tlabel=\"Reason for logging in as Administrator\"\n\t\t\t\t\t\t\t\ttype=\"textarea\"\n\t\t\t\t\t\t\t\tv-model=\"reasonForAdminLogin\"\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<ErrorMessage class=\"mt-3\" :message=\"errorMessage\" />\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</Dialog>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport { defineAsyncComponent } from 'vue';\nimport Table from '@/components/Table/Table.vue';\nimport TableHeader from '@/components/Table/TableHeader.vue';\nimport TableRow from '@/components/Table/TableRow.vue';\nimport TableCell from '@/components/Table/TableCell.vue';\nimport { loginAsAdmin } from '@/controllers/loginAsAdmin';\nimport AlertBillingInformation from '@/components/AlertBillingInformation.vue';\nimport { notify } from '@/utils/toast';\n\nexport default {\n\tname: 'Sites',\n\tpageMeta() {\n\t\treturn {\n\t\t\ttitle: 'Sites - Easytouch Cloud'\n\t\t};\n\t},\n\tprops: ['bench'],\n\tcomponents: {\n\t\tTable,\n\t\tTableHeader,\n\t\tTableRow,\n\t\tTableCell,\n\t\tPrepaidCreditsDialog: defineAsyncComponent(() =>\n\t\t\timport('@/components/PrepaidCreditsDialog.vue')\n\t\t),\n\t\tStripeCard: defineAsyncComponent(() =>\n\t\t\timport('@/components/StripeCard.vue')\n\t\t),\n\t\tAlertBillingInformation,\n\t\tUpdateBillingDetails: defineAsyncComponent(() =>\n\t\t\timport('../../../src2/components/UpdateBillingDetails.vue')\n\t\t)\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowPrepaidCreditsDialog: false,\n\t\t\tshowAddCardDialog: false,\n\t\t\tsearchTerm: '',\n\t\t\treasonForAdminLogin: '',\n\t\t\terrorMessage: null,\n\t\t\tshowReasonForAdminLoginDialog: false,\n\t\t\tsiteForLogin: null,\n\t\t\tsite_status: 'All',\n\t\t\tsite_tag: '',\n\t\t\tshowAddressDialog: false\n\t\t};\n\t},\n\tresources: {\n\t\tallSites() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.site.all',\n\t\t\t\tparams: {\n\t\t\t\t\tsite_filter: { status: this.site_status, tag: this.site_tag }\n\t\t\t\t},\n\t\t\t\tauto: true,\n\t\t\t\tcache: [\n\t\t\t\t\t'SiteList',\n\t\t\t\t\tthis.site_status,\n\t\t\t\t\tthis.site_tag,\n\t\t\t\t\tthis.$account.team.name\n\t\t\t\t]\n\t\t\t};\n\t\t},\n\t\tsiteTags: { url: 'press.api.site.site_tags', auto: true, initialData: [] },\n\t\tlatestUnpaidInvoice: {\n\t\t\turl: 'press.api.billing.get_latest_unpaid_invoice',\n\t\t\tauto: true\n\t\t},\n\t\tloginAsAdmin() {\n\t\t\treturn loginAsAdmin('placeholderSite'); // So that RM does not yell at first load\n\t\t},\n\t\tbillingDetails: 'press.api.billing.details'\n\t},\n\tmounted() {\n\t\tthis.$socket.on('agent_job_update', this.onAgentJobUpdate);\n\t\tthis.$socket.on('list_update', this.onSiteUpdate);\n\t},\n\tunmounted() {\n\t\tthis.$socket.off('agent_job_update', this.onAgentJobUpdate);\n\t\tthis.$socket.off('list_update', this.onSiteUpdate);\n\t},\n\tmethods: {\n\t\tvalidateCreateSite() {\n\t\t\tif (!this.$account.hasBillingInfo) {\n\t\t\t\tthis.showAddCardDialog = true;\n\t\t\t} else if (\n\t\t\t\tthis.$account.billing_info.has_unpaid_invoices &&\n\t\t\t\t!this.$account.team.free_account\n\t\t\t) {\n\t\t\t\tnotify({\n\t\t\t\t\ttitle:\n\t\t\t\t\t\t'Please settle your unpaid invoices from the billing tab in order to create new sites',\n\t\t\t\t\ticon: 'info',\n\t\t\t\t\tcolor: 'yellow'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.$router.replace('/sites/new');\n\t\t\t}\n\t\t},\n\t\tonAgentJobUpdate(data) {\n\t\t\tif (!(data.name === 'New Site' || data.name === 'New Site from Backup'))\n\t\t\t\treturn;\n\t\t\tif (data.status === 'Success' && data.user === this.$account.user.name) {\n\t\t\t\tthis.reload();\n\t\t\t\tnotify({\n\t\t\t\t\ttitle: 'Site creation complete!',\n\t\t\t\t\tmessage: 'Login to your site and complete the setup wizard',\n\t\t\t\t\ticon: 'check',\n\t\t\t\t\tcolor: 'green'\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonSiteUpdate(event) {\n\t\t\t// Refresh if the event affects any of the sites in the list view\n\t\t\t// TODO: Listen to a more granular event than list_update\n\t\t\tif (event.doctype === 'Site') {\n\t\t\t\tlet sites = this.sites;\n\t\t\t\tif (\n\t\t\t\t\tevent.user === this.$account.user.name ||\n\t\t\t\t\tsites.includes(event.name)\n\t\t\t\t) {\n\t\t\t\t\tthis.reload();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\treload() {\n\t\t\t// refresh if currently not loading and have not reloaded in the last 5 seconds\n\t\t\tif (\n\t\t\t\t!this.$resources.allSites.loading &&\n\t\t\t\tnew Date() - this.$resources.allSites.lastLoaded > 5000\n\t\t\t) {\n\t\t\t\tthis.$resources.allSites.reload();\n\t\t\t}\n\t\t},\n\t\thandleAddPrepaidCreditsSuccess() {\n\t\t\tthis.$resources.latestUnpaidInvoice.reload();\n\t\t\tthis.showPrepaidCreditsDialog = false;\n\t\t},\n\t\tdropdownItems(site) {\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Visit Site',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\twindow.open(`https://${site.name}/apps`, '_blank');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Login As Admin',\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tif (this.$account.team.name === site.team) {\n\t\t\t\t\t\t\treturn this.$resources.loginAsAdmin.submit({\n\t\t\t\t\t\t\t\tname: site.name\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.siteForLogin = site.name;\n\t\t\t\t\t\tthis.showReasonForAdminLoginDialog = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t];\n\t\t},\n\t\tproceedWithLoginAsAdmin() {\n\t\t\tthis.errorMessage = '';\n\n\t\t\tif (!this.reasonForAdminLogin.trim()) {\n\t\t\t\tthis.errorMessage = 'Reason is required';\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$resources.loginAsAdmin.submit({\n\t\t\t\tname: this.siteForLogin,\n\t\t\t\treason: this.reasonForAdminLogin\n\t\t\t});\n\n\t\t\tthis.showReasonForAdminLoginDialog = false;\n\t\t}\n\t},\n\tcomputed: {\n\t\tsites() {\n\t\t\tif (!this.$resources.allSites.data) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tlet sites = this.$resources.allSites.data.filter(site =>\n\t\t\t\tthis.$account.hasPermission(site.name, '', true)\n\t\t\t);\n\t\t\tif (this.searchTerm) {\n\t\t\t\treturn sites.filter(site =>\n\t\t\t\t\tsite.name.toLowerCase().includes(this.searchTerm.toLowerCase())\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn sites;\n\t\t},\n\t\tsitesByGroup() {\n\t\t\tlet sitesByGroup = {};\n\n\t\t\tfor (let site of this.sites) {\n\t\t\t\tlet group = site.group;\n\t\t\t\tif (!sitesByGroup[group]) {\n\t\t\t\t\tsitesByGroup[group] = [];\n\t\t\t\t}\n\t\t\t\tsite.route = {\n\t\t\t\t\tname: 'SiteOverview',\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tsiteName: site.name\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tsitesByGroup[group].push(site);\n\t\t\t}\n\n\t\t\treturn sitesByGroup;\n\t\t},\n\t\tgroups() {\n\t\t\tlet seen = [];\n\t\t\tlet groups = [];\n\t\t\tfor (let site of this.sites) {\n\t\t\t\tif (site.public) {\n\t\t\t\t\tsite.title = 'Shared';\n\t\t\t\t\tsite.group = 'Shared';\n\t\t\t\t}\n\t\t\t\tif (!seen.includes(site.group)) {\n\t\t\t\t\tseen.push(site.group);\n\t\t\t\t\tif (site.public)\n\t\t\t\t\t\tgroups.unshift({\n\t\t\t\t\t\t\ttitle: site.title,\n\t\t\t\t\t\t\tgroup: site.group,\n\t\t\t\t\t\t\tpublic: site.public,\n\t\t\t\t\t\t\tversion: site.version\n\t\t\t\t\t\t});\n\t\t\t\t\telse\n\t\t\t\t\t\tgroups.push({\n\t\t\t\t\t\t\ttitle: site.title,\n\t\t\t\t\t\t\tgroup: site.group,\n\t\t\t\t\t\t\tpublic: site.public,\n\t\t\t\t\t\t\tversion: site.version\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn groups;\n\t\t},\n\t\tshowUnpaidInvoiceAlert() {\n\t\t\tif (!this.latestUnpaidInvoice) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\treturn !(\n\t\t\t\tthis.$account.team.erpnext_partner || this.$account.team.free_account\n\t\t\t);\n\t\t},\n\t\tlatestUnpaidInvoice() {\n\t\t\tif (this.$resources.latestUnpaidInvoice.data) {\n\t\t\t\treturn this.$resources.latestUnpaidInvoice.data;\n\t\t\t}\n\t\t},\n\t\tsiteStatusFilterOptions() {\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'All',\n\t\t\t\t\tvalue: 'All'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Active',\n\t\t\t\t\tvalue: 'Active'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Broken',\n\t\t\t\t\tvalue: 'Broken'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Inactive',\n\t\t\t\t\tvalue: 'Inactive'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Trial',\n\t\t\t\t\tvalue: 'Trial'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Update Available',\n\t\t\t\t\tvalue: 'Update Available'\n\t\t\t\t}\n\t\t\t];\n\t\t},\n\t\tsiteTagFilterOptions() {\n\t\t\tconst defaultOptions = [\n\t\t\t\t{\n\t\t\t\t\tlabel: '',\n\t\t\t\t\tvalue: ''\n\t\t\t\t}\n\t\t\t];\n\n\t\t\tif (!this.$resources.siteTags.data) return defaultOptions;\n\n\t\t\treturn [\n\t\t\t\t...defaultOptions,\n\t\t\t\t...this.$resources.siteTags.data.map(tag => ({\n\t\t\t\t\tlabel: tag,\n\t\t\t\t\tvalue: tag\n\t\t\t\t}))\n\t\t\t];\n\t\t}\n\t}\n};\n</script>\n"],"file":"assets/Sites-B9fK3Pc3.js"}