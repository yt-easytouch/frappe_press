import{_ as A}from"./Progress.vue_vue_type_script_setup_true_lang-DREy3z5o.js";import{x as H,r as J,q as X,o as u,A as c,j as e,aj as Q,h as d,a6 as g,w as n,t as f,X as Z,Y as p,a9 as G}from"./main-Dpl-JOF2.js";import{L as ee}from"./LoginBox-qd4moaUa.js";import"./YooltechLogo-DH5Linvn.js";import"./ETLogo-Ziye5dPH.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},s=new Error().stack;s&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[s]="88ddbef2-acbc-43f7-9cf3-60c0bf8c2b04",t._sentryDebugIdIdentifier="sentry-dbid-88ddbef2-acbc-43f7-9cf3-60c0bf8c2b04")}catch(Y){}})();{var a=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};a._sentryModuleMetadata=a._sentryModuleMetadata||{},a._sentryModuleMetadata[new Error().stack]=Object.assign({},a._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const te={name:"SignupLoginToSite",props:["productId"],components:{LoginBox:ee,Progress:A},data(){return{product_trial_request:this.$route.query.product_trial_request,progressCount:0,currentBuildStep:"Preparing for build"}},resources:{saasProduct(){return{type:"document",doctype:"Product Trial",name:this.productId,auto:!0}},siteRequest(){return{type:"document",doctype:"Product Trial Request",name:this.product_trial_request,realtime:!0,auto:!0,onSuccess(t){(t.status=="Wait for Site"||t.status=="Prefilling Setup Wizard")&&this.$resources.siteRequest.getProgress.reload()},whitelistedMethods:{getProgress:{method:"get_progress",makeParams(){var t;return{current_progress:((t=this.$resources.siteRequest.getProgress.data)==null?void 0:t.progress)||0}},onSuccess:t=>{const s={"Wait for Site":"Creating your site","New Site":"Creating your site","Prefilling Setup Wizard":"Setting up your site","Update Site Configuration":"Setting up your site","Enable Scheduler":"Setting up your site","Bench Setup NGINX":"Setting up your site","Reload NGINX":"Setting up your site"};this.currentBuildStep=s[t.current_step]||t.current_step||this.currentBuildStep,this.progressCount+=1,this.$resources.siteRequest.getProgress.error&&this.progressCount<=10||(this.progressCount=Math.round(t.progress*10)/10,setTimeout(()=>{this.$resources.siteRequest.getProgress.reload()},2e3))}},getLoginSid:{method:"get_login_sid",onSuccess(t){window.open(t,"_blank")}}}}}},computed:{saasProduct(){return this.$resources.saasProduct.doc}},methods:{loginToSite(){this.$resources.siteRequest.getLoginSid.submit()}}},se={key:0,class:"flex h-screen w-screen items-center justify-center"},re={key:1,class:"flex h-screen overflow-hidden sm:bg-gray-50"},oe={class:"w-full overflow-auto"},ie={class:"mx-auto flex items-center space-x-2"},ne=["src"],ue={class:"select-none text-xl font-semibold tracking-tight text-gray-900"},ae={class:"mb-4 mt-16 flex flex-col items-center justify-center space-y-4"},ce={class:"mx-auto flex items-center space-x-2"},le=["src"],de={class:"select-none text-xl font-semibold tracking-tight text-gray-900"},ge={class:"mx-auto flex items-center space-x-2"},fe=["src"],pe={class:"select-none text-xl font-semibold tracking-tight text-gray-900"},me={class:"flex h-40 items-center justify-center"};function _e(t,s,Y,ye,m,i){var _,y,h,x,b,S,w,P,k,q,v,R,C,$,B,L,I,j,E,N,T,M,D,W;const K=Q,O=Z,U=G,l=J("LoginBox"),F=A;return t.$resources.saasProduct.loading||t.$resources.siteRequest.loading?(u(),X("div",se,[c(K,{class:"mr-2 w-4"}),s[0]||(s[0]=e("p",{class:"text-gray-800"},"Loading",-1))])):(u(),X("div",re,[e("div",oe,[((h=(y=(_=t.$resources)==null?void 0:_.siteRequest)==null?void 0:y.doc)==null?void 0:h.status)==="Site Created"?(u(),d(l,{key:0,title:"Site created successfully",subtitle:`Your trial site is ready at
					${((S=(b=(x=t.$resources)==null?void 0:x.siteRequest)==null?void 0:b.doc)==null?void 0:S.domain)||((k=(P=(w=t.$resources)==null?void 0:w.siteRequest)==null?void 0:P.doc)==null?void 0:k.site)}`},g({footer:n(()=>[s[2]||(s[2]=e("div",{class:"mt-2 flex w-full items-center justify-center text-sm text-gray-600"}," Powered by Easytouch Cloud ",-1))]),default:n(()=>{var r,o,z,V;return[e("div",null,[e("div",ae,[c(O,{variant:"solid",class:"w-2/5","icon-right":"external-link",onClick:i.loginToSite,loading:(o=(r=this.$resources)==null?void 0:r.siteRequest)==null?void 0:o.getLoginSid.loading},{default:n(()=>s[1]||(s[1]=[p(" Log In ")])),_:1},8,["onClick","loading"])])]),c(U,{class:"w-full text-center",message:(V=(z=this.$resources)==null?void 0:z.siteRequest)==null?void 0:V.getLoginSid.error},null,8,["message"])]}),_:2},[i.saasProduct?{name:"logo",fn:n(()=>{var r,o;return[e("div",ie,[e("img",{class:"inline-block h-7 w-7 rounded-sm",src:(r=i.saasProduct)==null?void 0:r.logo},null,8,ne),e("span",ue,f((o=i.saasProduct)==null?void 0:o.title),1)])]}),key:"0"}:void 0]),1032,["subtitle"])):((R=(v=(q=this.$resources)==null?void 0:q.siteRequest)==null?void 0:v.doc)==null?void 0:R.status)==="Error"?(u(),d(l,{key:1,title:"Site creation failed",subtitle:((B=($=(C=this.$resources)==null?void 0:C.siteRequest)==null?void 0:$.doc)==null?void 0:B.domain)||((j=(I=(L=this.$resources)==null?void 0:L.siteRequest)==null?void 0:I.doc)==null?void 0:j.site)},g({default:n(()=>[s[3]||(s[3]=e("div",{class:"flex h-40 flex-col items-center justify-center px-10"},[e("div",{class:"text-center text-base leading-5 text-gray-800"},[e("p",null,"It looks like something went wrong"),e("p",null,[p(" Contact "),e("a",{href:"mailto:support@frappe.io",class:"underline"},"support@frappe.io"),e("br"),p(" to resolve the issue ")])])],-1))]),footer:n(()=>[s[4]||(s[4]=e("div",{class:"mt-2 flex w-full items-center justify-center text-sm text-gray-600"}," Powered by Easytouch Cloud ",-1))]),_:2},[i.saasProduct?{name:"logo",fn:n(()=>{var r,o;return[e("div",ce,[e("img",{class:"inline-block h-7 w-7 rounded-sm",src:(r=i.saasProduct)==null?void 0:r.logo},null,8,le),e("span",de,f((o=i.saasProduct)==null?void 0:o.title),1)])]}),key:"0"}:void 0]),1032,["subtitle"])):(u(),d(l,{key:2,title:"Creating your site",subtitle:((T=(N=(E=this.$resources)==null?void 0:E.siteRequest)==null?void 0:N.doc)==null?void 0:T.domain)||((W=(D=(M=this.$resources)==null?void 0:M.siteRequest)==null?void 0:D.doc)==null?void 0:W.site)},g({default:n(()=>[e("div",me,[c(F,{class:"px-10",size:"md",value:m.progressCount,label:m.currentBuildStep},null,8,["value","label"])])]),footer:n(()=>[s[5]||(s[5]=e("div",{class:"mt-2 flex w-full items-center justify-center text-sm text-gray-600"}," Powered by Easytouch Cloud ",-1))]),_:2},[i.saasProduct?{name:"logo",fn:n(()=>{var r,o;return[e("div",ge,[e("img",{class:"inline-block h-7 w-7 rounded-sm",src:(r=i.saasProduct)==null?void 0:r.logo},null,8,fe),e("span",pe,f((o=i.saasProduct)==null?void 0:o.title),1)])]}),key:"0"}:void 0]),1032,["subtitle"]))])]))}const Pe=H(te,[["render",_e]]);export{Pe as default};
//# sourceMappingURL=LoginToSite-DB9EI6rX.js.map
