{"version":3,"file":"SiteDeadlockReport-H1gSDomq.js","sources":["../../../../dashboard/src2/components/site/performance/SiteDeadlockReport.vue"],"sourcesContent":["<template>\n\t<PerformanceReport\n\t\ttitle=\"Query Deadlocks\"\n\t\t:site=\"name\"\n\t\t:reportOptions=\"deadlockReportOptions\"\n\t/>\n</template>\n\n<script>\nimport dayjs from '../../../utils/dayjs';\nimport PerformanceReport from './PerformanceReport.vue';\n\nexport default {\n\tname: 'SiteDeadlockReport',\n\tprops: ['name'],\n\tcomponents: {\n\t\tPerformanceReport\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tstart_datetime: dayjs().format('YYYY-MM-DD HH:mm:ss'),\n\t\t\tstop_datetime: dayjs().subtract(1, 'day').format('YYYY-MM-DD HH:mm:ss'),\n\t\t\tmax_log_size: 500\n\t\t};\n\t},\n\tcomputed: {\n\t\tdeadlockReportOptions() {\n\t\t\treturn {\n\t\t\t\tresource: () => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\turl: 'press.api.analytics.deadlock_report',\n\t\t\t\t\t\tmakeParams: params => {\n\t\t\t\t\t\t\t// for filterControls to work\n\t\t\t\t\t\t\tif (params) return params;\n\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\tstart_datetime: this.start_datetime,\n\t\t\t\t\t\t\t\tstop_datetime: this.stop_datetime,\n\t\t\t\t\t\t\t\tmax_log_size: parseInt(this.max_log_size ?? '')\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t},\n\t\t\t\t\t\tauto: true,\n\t\t\t\t\t\tinitialData: [],\n\t\t\t\t\t\ttransform: data => {\n\t\t\t\t\t\t\treturn data.map(record => {\n\t\t\t\t\t\t\t\t// Handle null values\n\t\t\t\t\t\t\t\t// because some records can be empty as well, to keep a blank line after two deadlock records\n\t\t\t\t\t\t\t\trecord.timestamp = record.timestamp\n\t\t\t\t\t\t\t\t\t? this.$format.date(record.timestamp, 'YYYY-MM-DD HH:mm:ss')\n\t\t\t\t\t\t\t\t\t: '';\n\t\t\t\t\t\t\t\trecord.transaction_id = record.transaction_id || '';\n\t\t\t\t\t\t\t\trecord.table = record.table || '';\n\t\t\t\t\t\t\t\trecord.query = record.query || '';\n\t\t\t\t\t\t\t\treturn record;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\temptyStateMessage: 'No query deadlock records found',\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Timestamp',\n\t\t\t\t\t\tfieldname: 'timestamp',\n\t\t\t\t\t\twidth: '12rem',\n\t\t\t\t\t\tformat: value => {\n\t\t\t\t\t\t\treturn this.$format.date(value, 'YYYY-MM-DD HH:mm:ss');\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Txn ID',\n\t\t\t\t\t\tfieldname: 'transaction_id',\n\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\twidth: '100px'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Table',\n\t\t\t\t\t\tfieldname: 'table',\n\t\t\t\t\t\tclass: 'text-gray-600',\n\t\t\t\t\t\talign: 'left',\n\t\t\t\t\t\twidth: '200px'\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Query',\n\t\t\t\t\t\tfieldname: 'query',\n\t\t\t\t\t\tclass: 'font-mono'\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tfilterControls: () => {\n\t\t\t\t\treturn [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'datetime-local',\n\t\t\t\t\t\t\tlabel: 'Start Time',\n\t\t\t\t\t\t\tfieldname: 'start_datetime',\n\t\t\t\t\t\t\tdefault: this.start_datetime\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttype: 'datetime-local',\n\t\t\t\t\t\t\tlabel: 'End Time',\n\t\t\t\t\t\t\tfieldname: 'stop_datetime',\n\t\t\t\t\t\t\tdefault: this.stop_datetime\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Max Log Lines',\n\t\t\t\t\t\t\tfieldname: 'max_log_size',\n\t\t\t\t\t\t\tdefault: this.max_log_size\n\t\t\t\t\t\t}\n\t\t\t\t\t];\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","PerformanceReport","dayjs","params","_a","data","record","value","$props","$options"],"mappings":"uwBAYA,MAAAA,EAAA,2BAEC,MAAA,CAAA,MAAA,cAEC,kBAAAC,GAED,MAAA,CACC,MAAA,kDAEC,cAAAC,EAAA,EAAA,SAAA,EAAA,KAAA,EAAA,OAAA,qBAAA,EACA,aAAA,MAGF,SAAA,yBAEE,MAAA,eAEE,CACC,IAAA,sCACA,WAAAC,GAAA,iBAIC,CACC,KAAA,KAAA,KACA,eAAA,KAAA,eACA,cAAA,KAAA,cACA,aAAA,UAAAC,EAAA,KAAA,eAAA,KAAAA,EAAA,EAAA,IAGF,KAAA,GACA,YAAA,CAAA,EACA,UAAAC,aAIEC,EAAA,UAAAA,EAAA,+DAEC,mFAKF,wDAKH,QAAA,CACC,CACC,MAAA,YACA,UAAA,0BAEA,OAAAC,+CAID,uEAMA,eAEC,UAAA,QACA,MAAA,4CAID,eAEC,UAAA,QACA,MAAA,WACD,GAED,eAAA,IACC,CACC,CACC,KAAA,iBACA,MAAA,qEAID,CACC,KAAA,iBACA,MAAA,iEAID,CACC,MAAA,kEAGD,GAIJ,CACD,CACD,yEA9GE,MAAA,kBACC,KAAAC,EAAA,KACA,cAAAC,EAAA"}