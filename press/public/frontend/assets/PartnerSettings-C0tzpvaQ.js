var v=(t,e,i)=>new Promise((_,r)=>{var f=l=>{try{a(i.next(l))}catch(d){r(d)}},p=l=>{try{a(i.throw(l))}catch(d){r(d)}},a=l=>l.done?_(l.value):Promise.resolve(l.value).then(f,p);a((i=i.apply(t,e)).next())});import{_ as D}from"./Card-BCzTSeNK.js";import{x as P,h,u as m,o as s,w as u,j as n,q as g,F as q,v as A,t as y,A as o,Y as C,aA as S,X as x,a8 as R,a9 as E,a5 as F,r as b}from"./main-Dpl-JOF2.js";import{_ as I}from"./ListItem-CkkFcC1t.js";import{n as M}from"./toast-Dk0nDfLL.js";import{_ as V}from"./ClickToCopyField-DpU9Eau5.js";import{D as B}from"./datetime-PXpIdgFA.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="860e8d7d-e9d3-47b5-a868-a068cacb0197",t._sentryDebugIdIdentifier="sentry-dbid-860e8d7d-e9d3-47b5-a868-a068cacb0197")}catch(i){}})();{var $=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};$._sentryModuleMetadata=$._sentryModuleMetadata||{},$._sentryModuleMetadata[new Error().stack]=Object.assign({},$._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const T={name:"PartnerCustomers",data(){return{partnerCustomers:[]}},resources:{getPartnerCustomers:{url:"press.api.partner.get_partner_customers",onSuccess(t){this.partnerCustomers=t.map(e=>({email:e.user,billing_name:e.billing_name||"",payment_mode:e.payment_mode||"",currency:e.currency}))},auto:!0}}},N={class:"max-h-96 divide-y"},U={class:"break-all"};function j(t,e,i,_,r,f){const p=D;return t.$account.team.erpnext_partner?(s(),h(p,{key:0,title:"Partner Customers",subtitle:"Customers associated with your account"},{default:u(()=>[n("div",N,[e[0]||(e[0]=n("div",{class:"grid grid-cols-4 items-center gap-x-8 py-4 text-base text-gray-600"},[n("span",null,"Name"),n("span",null,"Email"),n("span",null,"Currency"),n("span",null,"Payment Mode")],-1)),(s(!0),g(q,null,A(r.partnerCustomers,a=>(s(),g("div",{key:a.team,class:"grid grid-cols-4 items-center gap-x-8 py-4 text-base text-gray-900"},[n("span",null,y(a.billing_name),1),n("span",U,y(a.email),1),n("span",null,y(a.currency),1),n("span",null,y(a.payment_mode),1)]))),128))])]),_:1})):m("",!0)}const L=P(T,[["render",j]]),O={name:"AccountPartner",data(){return{showPartnerReferralDialog:!1,referralCode:null,partnerExists:!1,errorMessage:null,partner:null}},resources:{addPartner(){return{url:"press.api.partner.add_partner",params:{referral_code:this.referralCode},onSuccess(t){this.showPartnerReferralDialog=!1,M({title:"Email sent to Partner",icon:"check",color:"green"})}}}},methods:{referralCodeChange(t){return v(this,null,function*(){let e=t.target.value;this.partnerExists=!1;let i=yield this.$call("press.api.partner.validate_partner_code",{code:e}),[_,r]=i;_?(this.partnerExists=!0,this.referralCode=e,this.partner=r,this.partnerExists=!0):this.errorMessage=`${e} is Invalid Referral Code`})}}},Y={class:"py-4"},z={key:0,class:"text-base text-gray-700"},H={key:1,class:"text-base text-gray-700"},J={class:"mt-1"},K={key:0,class:"text-sm text-green-600",role:"alert"};function X(t,e,i,_,r,f){const p=I,a=x,l=R,d=E,w=S,k=D;return t.$account.team.erpnext_partner?m("",!0):(s(),h(k,{key:0,title:"Frappe Partner",subtitle:"Frappe Partner associated with your account"},{actions:u(()=>[t.$account.partner_email?m("",!0):(s(),h(a,{key:0,onClick:e[0]||(e[0]=c=>r.showPartnerReferralDialog=!0)},{default:u(()=>e[5]||(e[5]=[C(" Add Partner Code ")])),_:1}))]),default:u(()=>[n("div",null,[t.$account.partner_email?(s(),h(p,{key:0,title:t.$account.partner_billing_name,subtitle:t.$account.partner_email},null,8,["title","subtitle"])):m("",!0),n("div",Y,[t.$account.parent_team?(s(),g("h3",z," Only parent team can link with Frappe Partner. ")):m("",!0),!t.$account.partner_email&&!t.$account.parent_team?(s(),g("h3",H,e[4]||(e[4]=[C(" Have a Frappe Partner Referral Code? Click on "),n("strong",null,"Add Partner Code",-1),C(" to link with your Partner team. ")]))):m("",!0)])]),o(w,{options:{title:"Partner Referral Code"},modelValue:r.showPartnerReferralDialog,"onUpdate:modelValue":e[3]||(e[3]=c=>r.showPartnerReferralDialog=c)},{"body-content":u(()=>[o(l,{label:"Enter Partner Referral Code",type:"input",modelValue:r.referralCode,"onUpdate:modelValue":e[1]||(e[1]=c=>r.referralCode=c),placeholder:"e.g. rGjw3hJ81b",onInput:f.referralCodeChange},null,8,["modelValue","onInput"]),o(d,{class:"mt-2",message:t.$resources.addPartner.error},null,8,["message"]),n("div",J,[r.partnerExists?(s(),g("div",K," Referral Code "+y(r.referralCode)+" belongs to "+y(r.partner),1)):m("",!0),o(d,{message:r.errorMessage},null,8,["message"])])]),actions:u(()=>[o(a,{variant:"solid",loading:t.$resources.addPartner.loading,loadingText:"Saving...",onClick:e[2]||(e[2]=c=>t.$resources.addPartner.submit())},{default:u(()=>e[6]||(e[6]=[C(" Add partner ")])),_:1},8,["loading"])]),_:1},8,["modelValue"])]),_:1}))}const Q=P(O,[["render",X]]),W={name:"PartnerReferral",components:{ClickToCopyField:V},computed:{referralCode(){return this.$account.team.erpnext_partner&&this.$account.team.partner_referral_code?this.$account.team.partner_referral_code:""}}},Z={class:"space-y-4"};function G(t,e,i,_,r,f){const p=V,a=D;return t.$account.team.erpnext_partner?(s(),h(a,{key:0,title:"Partner Referral",subtitle:"Your unique partner referral code"},{default:u(()=>[n("div",Z,[o(p,{textContent:f.referralCode},null,8,["textContent"]),e[0]||(e[0]=n("h3",{class:"text-base text-gray-700"}," Partners can share this referral code with their customers to link their account with the partner. ",-1))])]),_:1})):m("",!0)}const ee=P(W,[["render",G]]),te={name:"PartnerRequestStatus",data(){return{partnerRequestStatus:null,partnershipDate:null,showDateEditDialog:!1,partnerDate:null}},resources:{getStatus:{url:"press.api.partner.get_partner_request_status",params:{team:$account.team.name},onSuccess(t){this.partnerRequestStatus=t},auto:!0},updatePartnershipDate(){return{url:"press.api.partner.update_partnership_date",params:{team:$account.team.name,partnership_date:this.partnerDate||this.today},onSuccess(){this.showDateEditDialog=!1},validate(){if(!$account.team.partner_email)return"Please link your account with Partner Code first."}}}},computed:{today(){return B.local().toISODate()}}},re={class:"flex items-center"},ne={key:0},ae={class:"text-base"},se={class:"font-semibold"},oe={key:1},le={class:"ml-auto"};function ie(t,e,i,_,r,f){const p=F,a=x,l=R,d=E,w=S,k=D;return t.$account.team.erpnext_partner?m("",!0):(s(),h(k,{key:0,title:"Partner Request Status"},{actions:u(()=>[this.partnerRequestStatus?(s(),h(p,{key:0,variant:"subtle",theme:this.partnerRequestStatus==="Pending"?"orange":"green",size:"lg",label:this.partnerRequestStatus},null,8,["theme","label"])):m("",!0)]),default:u(()=>[n("div",re,[t.$account.team.partnership_date?(s(),g("div",ne,[n("span",ae,[e[3]||(e[3]=C(" Customer Partnership Start Date: ")),n("span",se,y(t.$date(t.$account.team.partnership_date).toLocaleString({month:"long",day:"numeric",year:"numeric"})),1)])])):(s(),g("div",oe,e[4]||(e[4]=[n("span",{class:"text-base"}," To set Customer Partnership Start Date, click on Edit button",-1)]))),n("div",le,[o(a,{"icon-left":"edit",onClick:e[0]||(e[0]=c=>r.showDateEditDialog=!0)},{default:u(()=>e[5]||(e[5]=[C(" Edit ")])),_:1})])]),o(w,{options:{title:"Update Customer Partnership Start Date",actions:[{variant:"solid",label:"Save Changes",onClick:()=>t.$resources.updatePartnershipDate.submit()}]},modelValue:r.showDateEditDialog,"onUpdate:modelValue":e[2]||(e[2]=c=>r.showDateEditDialog=c)},{"body-content":u(()=>[o(l,{label:"Enter Partnership Start Date",type:"date",modelValue:r.partnerDate,"onUpdate:modelValue":e[1]||(e[1]=c=>r.partnerDate=c),description:"This date will be used to calculate your partner's target achievement."},null,8,["modelValue"]),o(d,{class:"mt-2",message:t.$resources.updatePartnershipDate.error},null,8,["message"])]),_:1},8,["options","modelValue"])]),_:1}))}const ue=P(te,[["render",ie]]),pe={name:"PartnerSettings",pageMeta(){return{title:"Settings - Partner"}},components:{AccountPartner:Q,PartnerCustomers:L,PartnerReferral:ee,PartnerRequestStatus:ue}},de={class:"mx-auto max-w-4xl space-y-5"};function ce(t,e,i,_,r,f){const p=b("AccountPartner"),a=b("PartnerReferral"),l=b("PartnerCustomers"),d=b("PartnerRequestStatus");return s(),g("div",de,[o(p),o(a),o(l,{class:"col-span-1 md:col-span-2"}),o(d)])}const Pe=P(pe,[["render",ce]]);export{Pe as default};
//# sourceMappingURL=PartnerSettings-C0tzpvaQ.js.map
