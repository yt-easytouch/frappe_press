{"version":3,"file":"InvoiceTable-D1HjWyXY.js","sources":["../../../../dashboard/src2/components/InvoiceTable.vue"],"sourcesContent":["<template>\n\t<div>\n\t\t<div class=\"flex justify-end mb-3\">\n\t\t\t<Button\n\t\t\t\ticon-left=\"download\"\n\t\t\t\tclass=\"shrink-0\"\n\t\t\t\t@click=\"$resources.downloadInvoiceAsCSV.submit\"\n\t\t\t>\n\t\t\t\t<span class=\"text-sm\">Download as CSV</span>\n\t\t\t</Button>\n\t\t</div>\n\t\t<div v-if=\"doc\" class=\"overflow-x-auto\">\n\t\t\t<table\n\t\t\t\tclass=\"text w-full border-separate border-spacing-y-2 text-base font-normal text-gray-900\"\n\t\t\t>\n\t\t\t\t<thead class=\"bg-gray-100\">\n\t\t\t\t\t<tr class=\"text-gray-600\">\n\t\t\t\t\t\t<th class=\"rounded-l p-2 text-left font-normal\">Description</th>\n\t\t\t\t\t\t<th class=\"whitespace-nowrap p-2 text-right font-normal\">Rate</th>\n\t\t\t\t\t\t<th class=\"whitespace-nowrap p-2 text-right font-normal\">\n\t\t\t\t\t\t\tQuantity\n\t\t\t\t\t\t</th>\n\t\t\t\t\t\t<th class=\"rounded-r p-2 text-right font-normal\">Amount</th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\t\t\t\t<tbody>\n\t\t\t\t\t<template v-for=\"(items, type) in groupedLineItems\" :key=\"type\">\n\t\t\t\t\t\t<tr class=\"mt-1 bg-gray-50\">\n\t\t\t\t\t\t\t<td colspan=\"100\" class=\"rounded p-2 text-base font-medium\">\n\t\t\t\t\t\t\t\t{{ type }}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr v-for=\"(row, i) in items\" :key=\"row.idx\">\n\t\t\t\t\t\t\t<td class=\"py-1 pl-2 pr-2\">\n\t\t\t\t\t\t\t\t{{ row.document_name }}\n\t\t\t\t\t\t\t\t<span v-if=\"row.plan\" class=\"text-gray-700\">\n\t\t\t\t\t\t\t\t\t({{ formatPlan(row.plan) }}/mo)\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class=\"py-1 pl-2 pr-2 text-right\">\n\t\t\t\t\t\t\t\t{{ formatCurrency(row.rate) }}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class=\"py-1 pl-2 pr-2 text-right\">\n\t\t\t\t\t\t\t\t{{ row.quantity }}\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t\t\t'Site',\n\t\t\t\t\t\t\t\t\t\t'Release Group',\n\t\t\t\t\t\t\t\t\t\t'Server',\n\t\t\t\t\t\t\t\t\t\t'Database Server',\n\t\t\t\t\t\t\t\t\t].includes(row.document_type)\n\t\t\t\t\t\t\t\t\t\t? $format.plural(row.quantity, 'day', 'days')\n\t\t\t\t\t\t\t\t\t\t: ''\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td class=\"py-1 pl-2 pr-2 text-right font-medium\">\n\t\t\t\t\t\t\t\t{{ formatCurrency(row.amount) }}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</template>\n\t\t\t\t</tbody>\n\t\t\t\t<tfoot>\n\t\t\t\t\t<tr v-if=\"doc.total_discount_amount > 0\">\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td class=\"pb-2 pr-2 pt-4 text-right font-medium\">\n\t\t\t\t\t\t\tTotal Without Discount\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"whitespace-nowrap pb-2 pr-2 pt-4 text-right font-medium\">\n\t\t\t\t\t\t\t{{ formatCurrency(doc.total_before_discount) }}\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr v-if=\"doc.total_discount_amount > 0\">\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td class=\"pb-2 pr-2 pt-4 text-right font-medium\">\n\t\t\t\t\t\t\tTotal Discount Amount\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"whitespace-nowrap pb-2 pr-2 pt-4 text-right font-medium\">\n\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t$team.doc.erpnext_partner\n\t\t\t\t\t\t\t\t\t? formatCurrency(doc.total_discount_amount)\n\t\t\t\t\t\t\t\t\t: formatCurrency(0)\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr v-if=\"doc.gst > 0\">\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td class=\"pb-2 pr-2 pt-4 text-right font-medium\">\n\t\t\t\t\t\t\tTotal (Without Tax)\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"whitespace-nowrap pb-2 pr-2 pt-4 text-right font-medium\">\n\t\t\t\t\t\t\t{{ formatCurrency(doc.total) }}\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr v-if=\"doc.gst > 0\">\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td class=\"pb-2 pr-2 pt-4 text-right font-medium\">\n\t\t\t\t\t\t\tIGST @ {{ Number(gstPercentage * 100) }}%\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td class=\"whitespace-nowrap pb-2 pr-2 pt-4 text-right font-medium\">\n\t\t\t\t\t\t\t{{ doc.gst }}\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t<td class=\"pb-2 pr-2 pt-4 text-right font-medium\">Grand Total</td>\n\t\t\t\t\t\t<td class=\"whitespace-nowrap pb-2 pr-2 pt-4 text-right font-medium\">\n\t\t\t\t\t\t\t{{ formatCurrency(doc.total + doc.gst) }}\n\t\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t<template\n\t\t\t\t\t\tv-if=\"\n\t\t\t\t\t\t\tdoc.total !== doc.amount_due &&\n\t\t\t\t\t\t\t['Paid', 'Unpaid'].includes(doc.status)\n\t\t\t\t\t\t\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t<td class=\"pr-2 text-right font-medium\">Applied Balance</td>\n\t\t\t\t\t\t\t<td class=\"whitespace-nowrap py-3 pr-2 text-right font-medium\">\n\t\t\t\t\t\t\t\t- {{ formatCurrency(doc.applied_credits) }}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t<td></td>\n\t\t\t\t\t\t\t<td class=\"pr-2 text-right font-medium\">Amount Due</td>\n\t\t\t\t\t\t\t<td class=\"whitespace-nowrap py-3 pr-2 text-right font-medium\">\n\t\t\t\t\t\t\t\t{{ formatCurrency(doc.amount_due) }}\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</template>\n\t\t\t\t</tfoot>\n\t\t\t</table>\n\t\t</div>\n\t\t<div class=\"py-20 text-center\" v-if=\"$resources.invoice.loading\">\n\t\t\t<Button :loading=\"true\">Loading</Button>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport { getPlans } from '../data/plans';\n\nexport default {\n\tname: 'InvoiceTable',\n\tprops: ['invoiceId'],\n\tresources: {\n\t\tinvoice() {\n\t\t\treturn {\n\t\t\t\ttype: 'document',\n\t\t\t\tdoctype: 'Invoice',\n\t\t\t\tname: this.invoiceId,\n\t\t\t};\n\t\t},\n\t\tdownloadInvoiceAsCSV() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.billing.fetch_invoice_items',\n\t\t\t\tmakeParams() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tinvoice: this.invoiceId,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tconst filename = `${this.invoiceId}.csv`;\n\t\t\t\t\tthis.downloadAsCSV(data, filename);\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tcomputed: {\n\t\tgroupedLineItems() {\n\t\t\tif (!this.doc) return {};\n\t\t\tconst groupedLineItems = {};\n\t\t\tfor (let item of this.doc.items) {\n\t\t\t\tgroupedLineItems[item.document_type] =\n\t\t\t\t\tgroupedLineItems[item.document_type] || [];\n\t\t\t\tgroupedLineItems[item.document_type].push(item);\n\t\t\t}\n\t\t\treturn groupedLineItems;\n\t\t},\n\t\tdoc() {\n\t\t\treturn this.$resources.invoice.doc;\n\t\t},\n\t\tgstPercentage() {\n\t\t\treturn this.$team.doc.billing_info.gst_percentage;\n\t\t},\n\t},\n\tmethods: {\n\t\tformatPlan(plan) {\n\t\t\tlet planDoc = getPlans().find((p) => p.name === plan);\n\t\t\tif (planDoc) {\n\t\t\t\tlet india = this.$team.doc.currency === 'INR';\n\t\t\t\treturn this.$format.userCurrency(\n\t\t\t\t\tindia ? planDoc.price_inr : planDoc.price_usd,\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn plan;\n\t\t},\n\t\tformatCurrency(value) {\n\t\t\tif (!this.doc) return;\n\t\t\tlet currency = this.doc.currency;\n\t\t\treturn this.$format.currency(value, currency);\n\t\t},\n\t\tdownloadAsCSV(data, filename) {\n\t\t\tif (!data || data.length === 0) return;\n\t\t\tlet result = [];\n\t\t\tresult[0] = Object.keys(data[0]);\n\t\t\tdata.forEach((row) => {\n\t\t\t\tresult.push(Object.values(row));\n\t\t\t});\n\t\t\tconst csv = result.map((row) => Object.values(row).join(',')).join('\\n');\n\t\t\tconst blob = new Blob([csv], { type: 'text/csv' });\n\t\t\tconst url = window.URL.createObjectURL(blob);\n\t\t\tconst a = document.createElement('a');\n\t\t\ta.href = url;\n\t\t\ta.download = filename;\n\t\t\ta.click();\n\t\t\twindow.URL.revokeObjectURL(url);\n\t\t},\n\t},\n};\n</script>\n"],"names":["_sfc_main","data","filename","groupedLineItems","item","plan","india","planDoc","value","currency","result","row","csv","blob","url","_hoisted_1","_hoisted_3","_hoisted_4","_hoisted_6","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_12","_hoisted_14","_hoisted_16","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_createElementVNode","_ctx","_withCtx","_cache","_openBlock","_createElementBlock","_hoisted_2","_Fragment","_renderList","$options","items","type","i","_createTextVNode","_toDisplayString","_createCommentVNode","_hoisted_11","_hoisted_13","_hoisted_15","_hoisted_17","_hoisted_23"],"mappings":"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"}