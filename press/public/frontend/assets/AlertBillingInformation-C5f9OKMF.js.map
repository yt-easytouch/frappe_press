{"version":3,"mappings":"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","names":["_sfc_main","StripeLogo","data","__async","publishable_key","client_secret","loadStripe","theme","style","event","payload","_hoisted_3","$data","_cache","$event","$props","_createCommentVNode","_createElementVNode","_hoisted_1","_openBlock","_createElementBlock","_hoisted_2","_ctx","_hoisted_4","_withCtx","_createTextVNode","_hoisted_5","$options","_imports_0","_imports_1","BuyPrepaidCredits","razorpayCheckoutJS","response","__vitePreload","defineAsyncComponent","PrepaidCreditsDialog","_toDisplayString"],"sources":["../../../../dashboard/src/components/BuyPrepaidCredits.vue","../../../../dashboard/src/assets/razorpay.svg","../../../../dashboard/src/assets/stripe.svg","../../../../dashboard/src/components/PrepaidCreditsDialog.vue","../../../../dashboard/src/components/AlertBillingInformation.vue"],"sourcesContent":["<template>\n\t<div>\n\t\t<FormControl\n\t\t\tv-if=\"step == 'Get Amount'\"\n\t\t\tclass=\"mb-2\"\n\t\t\tlabel=\"Credits\"\n\t\t\tv-model.number=\"creditsToBuy\"\n\t\t\tname=\"amount\"\n\t\t\tautocomplete=\"off\"\n\t\t\ttype=\"number\"\n\t\t\t:min=\"minimumAmount\"\n\t\t/>\n\t\t<label\n\t\t\tclass=\"block\"\n\t\t\t:class=\"{\n\t\t\t\t'h-0.5 opacity-0': step != 'Add Card Details',\n\t\t\t\t'mt-4': step == 'Add Card Details'\n\t\t\t}\"\n\t\t>\n\t\t\t<span class=\"text-sm leading-4 text-gray-700\">\n\t\t\t\tCredit or Debit Card\n\t\t\t</span>\n\t\t\t<div\n\t\t\t\tclass=\"form-input mt-2 block w-full py-2 pl-3\"\n\t\t\t\tref=\"card-element\"\n\t\t\t></div>\n\t\t\t<ErrorMessage class=\"mt-1\" :message=\"cardErrorMessage\" />\n\t\t</label>\n\n\t\t<FormControl\n\t\t\tv-if=\"step == 'Get Amount'\"\n\t\t\tlabel=\"Total Amount + GST(if applicable)\"\n\t\t\tdisabled\n\t\t\tv-model=\"total\"\n\t\t\tname=\"total\"\n\t\t\tautocomplete=\"off\"\n\t\t\ttype=\"number\"\n\t\t/>\n\n\t\t<div v-if=\"step == 'Setting up Stripe'\" class=\"mt-8 flex justify-center\">\n\t\t\t<Spinner class=\"h-4 w-4 text-gray-600\" />\n\t\t</div>\n\t\t<ErrorMessage\n\t\t\tclass=\"mt-2\"\n\t\t\t:message=\"$resources.createPaymentIntent.error || errorMessage\"\n\t\t/>\n\t\t<div class=\"mt-4 flex w-full justify-between\">\n\t\t\t<StripeLogo />\n\t\t\t<div v-if=\"step == 'Get Amount'\">\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t@click=\"$resources.createPaymentIntent.submit()\"\n\t\t\t\t\t:loading=\"$resources.createPaymentIntent.loading\"\n\t\t\t\t>\n\t\t\t\t\tNext\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t\t<div v-if=\"step == 'Add Card Details'\">\n\t\t\t\t<Button @click=\"$emit('cancel')\"> Cancel </Button>\n\t\t\t\t<Button\n\t\t\t\t\tclass=\"ml-2\"\n\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t@click=\"onBuyClick\"\n\t\t\t\t\t:loading=\"paymentInProgress\"\n\t\t\t\t>\n\t\t\t\t\tBuy Credits\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport StripeLogo from '@/components/StripeLogo.vue';\nimport { loadStripe } from '@stripe/stripe-js';\n\nexport default {\n\tname: 'BuyPrepaidCredits',\n\tcomponents: {\n\t\tStripeLogo\n\t},\n\tprops: {\n\t\tminimumAmount: {\n\t\t\tdefault: 0\n\t\t}\n\t},\n\tmounted() {\n\t\tthis.updateTotal();\n\t},\n\twatch: {\n\t\tcreditsToBuy() {\n\t\t\tthis.updateTotal();\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tstep: 'Get Amount', // Get Amount / Add Card Details\n\t\t\tclientSecret: null,\n\t\t\tcreditsToBuy: this.minimumAmount || null,\n\t\t\ttotal: this.minimumAmount,\n\t\t\tcardErrorMessage: null,\n\t\t\terrorMessage: null,\n\t\t\tpaymentInProgress: false\n\t\t};\n\t},\n\tresources: {\n\t\tcreatePaymentIntent() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.billing.create_payment_intent_for_buying_credits',\n\t\t\t\tparams: {\n\t\t\t\t\tamount: this.creditsToBuy\n\t\t\t\t},\n\t\t\t\tvalidate() {\n\t\t\t\t\tif (\n\t\t\t\t\t\tthis.creditsToBuy < this.minimumAmount &&\n\t\t\t\t\t\t!this.$account.team.erpnext_partner\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn `Amount must be greater than ${this.minimumAmount}`;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tasync onSuccess(data) {\n\t\t\t\t\tthis.step = 'Setting up Stripe';\n\t\t\t\t\tlet { publishable_key, client_secret } = data;\n\t\t\t\t\tthis.clientSecret = client_secret;\n\t\t\t\t\tthis.stripe = await loadStripe(publishable_key);\n\t\t\t\t\tthis.elements = this.stripe.elements();\n\t\t\t\t\tlet theme = this.$theme;\n\t\t\t\t\tlet style = {\n\t\t\t\t\t\tbase: {\n\t\t\t\t\t\t\tcolor: theme.colors.black,\n\t\t\t\t\t\t\tfontFamily: theme.fontFamily.sans.join(', '),\n\t\t\t\t\t\t\tfontSmoothing: 'antialiased',\n\t\t\t\t\t\t\tfontSize: '13px',\n\t\t\t\t\t\t\t'::placeholder': {\n\t\t\t\t\t\t\t\tcolor: theme.colors.gray['400']\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tinvalid: {\n\t\t\t\t\t\t\tcolor: theme.colors.red['600'],\n\t\t\t\t\t\t\ticonColor: theme.colors.red['600']\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\tthis.card = this.elements.create('card', {\n\t\t\t\t\t\thidePostalCode: true,\n\t\t\t\t\t\tstyle: style,\n\t\t\t\t\t\tclasses: {\n\t\t\t\t\t\t\tcomplete: '',\n\t\t\t\t\t\t\tfocus: 'bg-gray-100'\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.step = 'Add Card Details';\n\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\tthis.card.mount(this.$refs['card-element']);\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.card.addEventListener('change', event => {\n\t\t\t\t\t\tthis.cardErrorMessage = event.error?.message || null;\n\t\t\t\t\t});\n\t\t\t\t\tthis.card.addEventListener('ready', () => {\n\t\t\t\t\t\tthis.ready = true;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\tupdateTotal() {\n\t\t\tif (this.$account.team.currency === 'INR') {\n\t\t\t\tthis.total = Number(\n\t\t\t\t\t(\n\t\t\t\t\t\tthis.creditsToBuy +\n\t\t\t\t\t\tthis.creditsToBuy * this.$account.billing_info.gst_percentage\n\t\t\t\t\t).toFixed(2)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.total = this.creditsToBuy;\n\t\t\t}\n\t\t},\n\t\tsetupStripe() {\n\t\t\tthis.$resources.createPaymentIntent.submit();\n\t\t},\n\t\tasync onBuyClick() {\n\t\t\tthis.paymentInProgress = true;\n\t\t\tlet payload = await this.stripe.confirmCardPayment(this.clientSecret, {\n\t\t\t\tpayment_method: {\n\t\t\t\t\tcard: this.card\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.paymentInProgress = false;\n\t\t\tif (payload.error) {\n\t\t\t\tthis.errorMessage = payload.error.message;\n\t\t\t} else {\n\t\t\t\tthis.$emit('success');\n\t\t\t\tthis.errorMessage = null;\n\t\t\t\tthis.creditsToBuy = null;\n\t\t\t}\n\t\t}\n\t}\n};\n</script>\n","export default \"__VITE_ASSET__DYmsyvCS__\"","export default \"data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!--%20Generator:%20Adobe%20Illustrator%2024.0.3,%20SVG%20Export%20Plug-In%20.%20SVG%20Version:%206.00%20Build%200)%20--%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20viewBox='0%200%20468%20222.5'%20style='enable-background:new%200%200%20468%20222.5;'%20xml:space='preserve'%3e%3cstyle%20type='text/css'%3e%20.st0{fill-rule:evenodd;clip-rule:evenodd;fill:%23635BFF;}%20%3c/style%3e%3cg%3e%3cpath%20class='st0'%20d='M414,113.4c0-25.6-12.4-45.8-36.1-45.8c-23.8,0-38.2,20.2-38.2,45.6c0,30.1,17,45.3,41.4,45.3%20c11.9,0,20.9-2.7,27.7-6.5v-20c-6.8,3.4-14.6,5.5-24.5,5.5c-9.7,0-18.3-3.4-19.4-15.2h48.9C413.8,121,414,115.8,414,113.4z%20M364.6,103.9c0-11.3,6.9-16,13.2-16c6.1,0,12.6,4.7,12.6,16H364.6z'/%3e%3cpath%20class='st0'%20d='M301.1,67.6c-9.8,0-16.1,4.6-19.6,7.8l-1.3-6.2h-22v116.6l25-5.3l0.1-28.3c3.6,2.6,8.9,6.3,17.7,6.3%20c17.9,0,34.2-14.4,34.2-46.1C335.1,83.4,318.6,67.6,301.1,67.6z%20M295.1,136.5c-5.9,0-9.4-2.1-11.8-4.7l-0.1-37.1%20c2.6-2.9,6.2-4.9,11.9-4.9c9.1,0,15.4,10.2,15.4,23.3C310.5,126.5,304.3,136.5,295.1,136.5z'/%3e%3cpolygon%20class='st0'%20points='223.8,61.7%20248.9,56.3%20248.9,36%20223.8,41.3%20'/%3e%3crect%20x='223.8'%20y='69.3'%20class='st0'%20width='25.1'%20height='87.5'/%3e%3cpath%20class='st0'%20d='M196.9,76.7l-1.6-7.4h-21.6v87.5h25V97.5c5.9-7.7,15.9-6.3,19-5.2v-23C214.5,68.1,202.8,65.9,196.9,76.7z'/%3e%3cpath%20class='st0'%20d='M146.9,47.6l-24.4,5.2l-0.1,80.1c0,14.8,11.1,25.7,25.9,25.7c8.2,0,14.2-1.5,17.5-3.3V135%20c-3.2,1.3-19,5.9-19-8.9V90.6h19V69.3h-19L146.9,47.6z'/%3e%3cpath%20class='st0'%20d='M79.3,94.7c0-3.9,3.2-5.4,8.5-5.4c7.6,0,17.2,2.3,24.8,6.4V72.2c-8.3-3.3-16.5-4.6-24.8-4.6%20C67.5,67.6,54,78.2,54,95.9c0,27.6,38,23.2,38,35.1c0,4.6-4,6.1-9.6,6.1c-8.3,0-18.9-3.4-27.3-8v23.8c9.3,4,18.7,5.7,27.3,5.7%20c20.8,0,35.1-10.3,35.1-28.2C117.4,100.6,79.3,105.9,79.3,94.7z'/%3e%3c/g%3e%3c/svg%3e\"","<template>\n\t<Dialog\n\t\t:modelValue=\"modelValue\"\n\t\t@update:modelValue=\"$emit('update:show', $event)\"\n\t>\n\t\t<template #body-title>\n\t\t\t<h3 class=\"text-2xl font-semibold leading-6 text-gray-900\">\n\t\t\t\tAdd money to your account\n\t\t\t</h3>\n\t\t\t<p class=\"mt-1 text-base text-gray-600\">\n\t\t\t\t{{ paymentGateway ? '' : 'Choose your payment gateway' }}\n\t\t\t</p>\n\t\t</template>\n\t\t<template v-slot:body-content>\n\t\t\t<BuyPrepaidCredits\n\t\t\t\tv-if=\"paymentGateway === 'stripe'\"\n\t\t\t\t:minimumAmount=\"minimumAmount\"\n\t\t\t\t@success=\"$emit('success')\"\n\t\t\t\t@cancel=\"$emit('update:show', false)\"\n\t\t\t/>\n\n\t\t\t<div v-if=\"paymentGateway === 'razorpay'\">\n\t\t\t\t<FormControl\n\t\t\t\t\t:label=\"`Amount (Minimum Amount: ${minimumAmount})`\"\n\t\t\t\t\tclass=\"mb-2\"\n\t\t\t\t\tv-model.number=\"creditsToBuy\"\n\t\t\t\t\tname=\"amount\"\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t:min=\"minimumAmount\"\n\t\t\t\t/>\n\n\t\t\t\t<FormControl\n\t\t\t\t\tlabel=\"Total Amount + GST(if applicable)\"\n\t\t\t\t\tdisabled\n\t\t\t\t\tv-model=\"total\"\n\t\t\t\t\tname=\"total\"\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t/>\n\n\t\t\t\t<p class=\"mt-3 text-xs\">\n\t\t\t\t\t<span class=\"font-semibold\">Note</span>: If you are using Net Banking,\n\t\t\t\t\tit may take upto 5 days for balance to reflect.\n\t\t\t\t</p>\n\n\t\t\t\t<ErrorMessage\n\t\t\t\t\tclass=\"mt-3\"\n\t\t\t\t\t:message=\"$resources.createRazorpayOrder.error\"\n\t\t\t\t/>\n\n\t\t\t\t<div class=\"mt-4 flex w-full justify-between\">\n\t\t\t\t\t<Button @click=\"paymentGateway = null\">Go Back</Button>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\t:loading=\"$resources.createRazorpayOrder.loading\"\n\t\t\t\t\t\t\t@click=\"buyCreditsWithRazorpay\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tBuy\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!paymentGateway\"\n\t\t\t\t\tclass=\"grid grid-cols-1 gap-2 sm:grid-cols-2\"\n\t\t\t\t>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tv-if=\"\n\t\t\t\t\t\t\t$account.team.currency === 'INR' || $account.team.razorpay_enabled\n\t\t\t\t\t\t\"\n\t\t\t\t\t\t@click=\"paymentGateway = 'razorpay'\"\n\t\t\t\t\t\tclass=\"py-2\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclass=\"w-24\"\n\t\t\t\t\t\t\tsrc=\"../assets/razorpay.svg\"\n\t\t\t\t\t\t\talt=\"Razorpay Logo\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button @click=\"paymentGateway = 'stripe'\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclass=\"h-7 w-24\"\n\t\t\t\t\t\t\tsrc=\"../assets/stripe.svg\"\n\t\t\t\t\t\t\talt=\"Stripe Logo\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n<script>\nimport BuyPrepaidCredits from './BuyPrepaidCredits.vue';\n\nexport default {\n\tname: 'PrepaidCreditsDialog',\n\tcomponents: {\n\t\tBuyPrepaidCredits\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tpaymentGateway: null,\n\t\t\tcreditsToBuy: this.minimumAmount,\n\t\t\ttotal: this.minimumAmount\n\t\t};\n\t},\n\tmounted() {\n\t\tconst razorpayCheckoutJS = document.createElement('script');\n\t\trazorpayCheckoutJS.setAttribute(\n\t\t\t'src',\n\t\t\t'https://checkout.razorpay.com/v1/checkout.js'\n\t\t);\n\t\trazorpayCheckoutJS.async = true;\n\t\tdocument.head.appendChild(razorpayCheckoutJS);\n\n\t\tif (\n\t\t\tthis.$account.team.currency === 'USD' &&\n\t\t\t!this.$account.team.razorpay_enabled\n\t\t) {\n\t\t\tthis.paymentGateway = 'stripe';\n\t\t}\n\n\t\tthis.updateTotal();\n\t},\n\twatch: {\n\t\tcreditsToBuy() {\n\t\t\tthis.updateTotal();\n\t\t}\n\t},\n\tprops: {\n\t\tmodelValue: {\n\t\t\tdefault: true\n\t\t},\n\t\tminimumAmount: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t}\n\t},\n\temits: ['update:show', 'success'],\n\tresources: {\n\t\tcreateRazorpayOrder() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.billing.create_razorpay_order',\n\t\t\t\tparams: {\n\t\t\t\t\tamount: this.creditsToBuy\n\t\t\t\t},\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tthis.processOrder(data);\n\t\t\t\t},\n\t\t\t\tvalidate() {\n\t\t\t\t\tif (this.creditsToBuy < this.minimumAmount) {\n\t\t\t\t\t\treturn 'Amount less than minimum amount required';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\thandlePaymentSuccess() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.billing.handle_razorpay_payment_success',\n\t\t\t\tonSuccess() {\n\t\t\t\t\tthis.$emit('success');\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\thandlePaymentFailed() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.billing.handle_razorpay_payment_failed',\n\t\t\t\tonSuccess() {\n\t\t\t\t\tconsole.log('Payment Failed.');\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\tupdateTotal() {\n\t\t\tif (this.$account.team.currency === 'INR') {\n\t\t\t\tthis.total = Number(\n\t\t\t\t\t(\n\t\t\t\t\t\tthis.creditsToBuy +\n\t\t\t\t\t\tthis.creditsToBuy * this.$account.billing_info.gst_percentage\n\t\t\t\t\t).toFixed(2)\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.total = this.creditsToBuy;\n\t\t\t}\n\t\t},\n\t\tbuyCreditsWithRazorpay() {\n\t\t\tthis.$resources.createRazorpayOrder.submit();\n\t\t},\n\t\tprocessOrder(data) {\n\t\t\tconst options = {\n\t\t\t\tkey: data.key_id,\n\t\t\t\torder_id: data.order_id,\n\t\t\t\tname: 'Easytouch Cloud',\n\t\t\t\timage: '/assets/press/images/frappe-cloud-logo.png',\n\t\t\t\tprefill: {\n\t\t\t\t\temail: this.$account.team.user\n\t\t\t\t},\n\t\t\t\ttheme: { color: '#2490EF' },\n\t\t\t\thandler: this.handlePaymentSuccess\n\t\t\t};\n\n\t\t\tconst rzp = new Razorpay(options);\n\n\t\t\t// Opens the payment checkout frame\n\t\t\trzp.open();\n\n\t\t\t// Attach failure handler\n\t\t\trzp.on('payment.failed', this.handlePaymentFailed);\n\t\t},\n\n\t\thandlePaymentSuccess(response) {\n\t\t\tthis.$emit('success');\n\t\t},\n\n\t\thandlePaymentFailed(response) {\n\t\t\tthis.$resources.handlePaymentFailed.submit({ response });\n\t\t}\n\t}\n};\n</script>\n","<template>\n\t<Alert title=\"Account Setup\" v-if=\"!$account.hasBillingInfo\">\n\t\t{{ message }}\n\t\t<template #actions>\n\t\t\t<Button\n\t\t\t\tvariant=\"solid\"\n\t\t\t\t@click=\"\n\t\t\t\t\tisDefaultPaymentModeCard\n\t\t\t\t\t\t? (showPrepaidCreditsDialog = true)\n\t\t\t\t\t\t: (showCardDialog = true)\n\t\t\t\t\"\n\t\t\t\tclass=\"whitespace-nowrap\"\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\tisDefaultPaymentModeCard ? 'Add Balance' : 'Add Billing Information'\n\t\t\t\t}}\n\t\t\t</Button>\n\t\t</template>\n\t\t<BillingInformationDialog v-model=\"showCardDialog\" v-if=\"showCardDialog\" />\n\t\t<PrepaidCreditsDialog\n\t\t\tv-if=\"showPrepaidCreditsDialog\"\n\t\t\tv-model:show=\"showPrepaidCreditsDialog\"\n\t\t\t:minimum-amount=\"$account.team.currency === 'INR' ? 10 : 1\"\n\t\t\t@success=\"handleAddPrepaidCreditsSuccess\"\n\t\t/>\n\t</Alert>\n</template>\n<script>\nimport { defineAsyncComponent } from 'vue';\n\nexport default {\n\tname: 'AlertBillingInformation',\n\tcomponents: {\n\t\tBillingInformationDialog: defineAsyncComponent(() =>\n\t\t\timport('./BillingInformationDialog.vue')\n\t\t),\n\t\tPrepaidCreditsDialog: defineAsyncComponent(() =>\n\t\t\timport('./PrepaidCreditsDialog.vue')\n\t\t)\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshowCardDialog: false,\n\t\t\tshowPrepaidCreditsDialog: false\n\t\t};\n\t},\n\tmethods: {\n\t\thandleAddPrepaidCreditsSuccess() {\n\t\t\tthis.showPrepaidCreditsDialog = false;\n\t\t}\n\t},\n\tcomputed: {\n\t\tisDefaultPaymentModeCard() {\n\t\t\treturn this.$account.team.payment_mode == 'Card';\n\t\t},\n\t\tmessage() {\n\t\t\tif (this.isDefaultPaymentModeCard) {\n\t\t\t\treturn \"We couldn't verify your card with micro charge. Please add some balance to your account to start creating sites.\";\n\t\t\t} else {\n\t\t\t\treturn \"You haven't added your billing information yet. Add it to start creating sites.\";\n\t\t\t}\n\t\t}\n\t}\n};\n</script>\n"],"file":"assets/AlertBillingInformation-C5f9OKMF.js"}