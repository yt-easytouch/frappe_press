import{_ as w}from"./Card-BCzTSeNK.js";import{x as v,q as s,o as a,A as i,ae as T,w as p,u as c,h as x,X as L,Y as k,j as $}from"./main-Dpl-JOF2.js";import{_ as y}from"./Report-BW6SUxnb.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="f12f4c74-a320-45c7-9163-cf9d9a7371d0",e._sentryDebugIdIdentifier="sentry-dbid-f12f4c74-a320-45c7-9163-cf9d9a7371d0")}catch(r){}})();{var o=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};o._sentryModuleMetadata=o._sentryModuleMetadata||{},o._sentryModuleMetadata[new Error().stack]=Object.assign({},o._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const D={name:"SiteBinaryLogs",props:["site"],components:{Report:y},data(){return{filters:[{name:"pattern",label:"Search:",type:"text",value:this.pattern},{name:"start_datetime",label:"From:",type:"datetime-local",value:""},{name:"end_datetime",label:"To:",type:"datetime-local",value:""}],today:new Date().toISOString().slice(0,10),max_lines:100}},watch:{patternFilter(){this.reset()},startTime(){this.reset()},endTime(){this.reset()}},resources:{binaryLogs(){var e;return{url:"press.api.analytics.binary_logs",params:{name:(e=this.site)==null?void 0:e.name,start_time:this.startTime||this.today,end_time:this.endTime||this.today,pattern:this.patternFilter,max_lines:this.max_lines},auto:!0,pageLength:10,keepData:!0,initialData:[]}},getPlan(){var e;return{url:"press.api.site.current_plan",params:{name:(e=this.site)==null?void 0:e.name},auto:!0}}},methods:{reset(){this.$resources.binaryLogs.reset()}},computed:{startTime(){return this.filters[1].value},endTime(){return this.filters[2].value},patternFilter(){return this.filters[0].value},formatData(){let e=this.$resources.binaryLogs.data,t=[];return e.forEach(r=>{let n=[{name:"Timestamp",value:this.formatDate(r.timestamp,"TIME_24_WITH_SHORT_OFFSET"),class:"w-3/12"},{name:"Query",value:r.query,class:"w-9/12"}];t.push(n)}),t}}},B={key:0,class:"flex items-center justify-center"},I={key:1},E={key:0,class:"px-2 py-2 text-base text-gray-600"},S={key:1,class:"py-2 text-base text-gray-600"},F={key:2,class:"flex justify-center"};function N(e,t,r,_,n,f){var d,u,m;const l=T,g=y,h=L,b=w;return(d=e.$resources.getPlan)!=null&&d.loading?(a(),s("div",B,[i(l)])):(m=(u=e.$resources.getPlan)==null?void 0:u.data)!=null&&m.monitor_access?(a(),s("div",I,[i(b,null,{default:p(()=>[i(g,{filters:n.filters,columns:[{label:"Timestamp",name:"timestamp",class:"w-3/12"},{label:"Query",name:"query",class:"w-9/12"}],data:f.formatData,title:"MariaDB Binary Log Report"},null,8,["filters","data"]),e.$resources.binaryLogs.loading?(a(),s("div",E,[i(l)])):e.$resources.binaryLogs.data.length==0?(a(),s("div",S," No data ")):c("",!0),e.$resources.binaryLogs.data&&e.$resources.binaryLogs.data.length?(a(),x(h,{key:2,loading:e.$resources.binaryLogs.loading,loadingText:"Loading...",onClick:t[0]||(t[0]=P=>n.max_lines+=10)},{default:p(()=>t[1]||(t[1]=[k(" Load more ")])),_:1},8,["loading"])):c("",!0)]),_:1})])):(a(),s("div",F,t[2]||(t[2]=[$("span",{class:"mt-16 text-base text-gray-700"}," Your plan doesn't support this feature. Please upgrade your plan. ",-1)])))}const O=v(D,[["render",N]]);export{O as default};
//# sourceMappingURL=SiteBinaryLogs-BJ_J5rUd.js.map
