{"version":3,"file":"SetupAccount-CiKBAjvi.js","sources":["../../../../dashboard/src2/pages/SetupAccount.vue"],"sourcesContent":["<template>\n\t<div\n\t\tclass=\"flex h-screen overflow-hidden bg-gray-50\"\n\t\tv-if=\"!$resources.validateRequestKey.loading && email\"\n\t>\n\t\t<div class=\"w-full overflow-auto\">\n\t\t\t<LoginBox>\n\t\t\t\t<template v-slot:logo v-if=\"saasProduct\">\n\t\t\t\t\t<div class=\"mx-auto flex items-center space-x-2\">\n\t\t\t\t\t\t<img\n\t\t\t\t\t\t\tclass=\"inline-block h-7 w-7 rounded-sm\"\n\t\t\t\t\t\t\t:src=\"saasProduct?.logo\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"select-none text-xl font-semibold tracking-tight text-gray-900\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ saasProduct?.title }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"text-center text-lg font-medium leading-5 tracking-tight text-gray-900\"\n\t\t\t\t>\n\t\t\t\t\t{{\n\t\t\t\t\t\tinvitedBy\n\t\t\t\t\t\t\t? 'Invitation to join'\n\t\t\t\t\t\t\t: 'Set up your Easytouch Cloud account'\n\t\t\t\t\t}}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"mt-2 text-center text-sm text-gray-600\" v-if=\"invitedBy\">\n\t\t\t\t\tInvitation by {{ invitedBy }}\n\t\t\t\t</div>\n\t\t\t\t<form class=\"mt-6 flex flex-col\" @submit.prevent=\"submitForm\">\n\t\t\t\t\t<template v-if=\"is2FA\">\n\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\tlabel=\"2FA Code from your Authenticator App\"\n\t\t\t\t\t\t\tplaceholder=\"123456\"\n\t\t\t\t\t\t\tv-model=\"twoFactorCode\"\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclass=\"mt-4\"\n\t\t\t\t\t\t\t:loading=\"$resources.verify2FA.loading\"\n\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\t@click=\"\n\t\t\t\t\t\t\t\t$resources.verify2FA.submit({\n\t\t\t\t\t\t\t\t\tuser: email,\n\t\t\t\t\t\t\t\t\ttotp_code: twoFactorCode,\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tVerify\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<ErrorMessage class=\"mt-2\" :message=\"$resources.verify2FA.error\" />\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"space-y-4\">\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\tv-if=\"oauthSignup == 0\"\n\t\t\t\t\t\t\t\tlabel=\"Email\"\n\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t:modelValue=\"email\"\n\t\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<template v-if=\"oauthSignup == 0 && !userExists\">\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"First Name\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tv-model=\"firstName\"\n\t\t\t\t\t\t\t\t\tname=\"fname\"\n\t\t\t\t\t\t\t\t\tautocomplete=\"given-name\"\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\tlabel=\"Last Name\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tv-model=\"lastName\"\n\t\t\t\t\t\t\t\t\tname=\"lname\"\n\t\t\t\t\t\t\t\t\tautocomplete=\"family-name\"\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\ttype=\"select\"\n\t\t\t\t\t\t\t\t:options=\"countries\"\n\t\t\t\t\t\t\t\tv-if=\"!isInvitation\"\n\t\t\t\t\t\t\t\tlabel=\"Country\"\n\t\t\t\t\t\t\t\tv-model=\"country\"\n\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"!mt-6 flex gap-2\">\n\t\t\t\t\t\t\t\t<FormControl type=\"checkbox\" v-model=\"termsAccepted\" />\n\t\t\t\t\t\t\t\t<label class=\"text-base text-gray-700\">\n\t\t\t\t\t\t\t\t\tI accept the\n\t\t\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\t\t\tclass=\"!text-gray-700\"\n\t\t\t\t\t\t\t\t\t\thref=\"https://easytouch.cloud/policies\"\n\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tTerms and Policies\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ErrorMessage\n\t\t\t\t\t\t\tclass=\"mt-4\"\n\t\t\t\t\t\t\t:message=\"$resources.setupAccount.error\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclass=\"mt-6\"\n\t\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\t\t:loading=\"$resources.setupAccount.loading\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\tis2FA ? 'Verify' : isInvitation ? 'Accept' : 'Create account'\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</template>\n\t\t\t\t</form>\n\t\t\t\t<template #footer v-if=\"saasProduct\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"mt-2 flex w-full items-center justify-center text-sm text-gray-600\"\n\t\t\t\t\t>\n\t\t\t\t\t\tPowered by Easytouch Cloud\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</LoginBox>\n\t\t</div>\n\t</div>\n\t<div\n\t\tclass=\"mt-20 px-6 text-center\"\n\t\tv-else-if=\"!$resources.validateRequestKey.loading && !email\"\n\t>\n\t\tVerification link is invalid or expired.\n\t\t<Link to=\"/signup\">Sign up</Link>\n\t\tfor a new account.\n\t</div>\n\t<div v-else></div>\n</template>\n\n<script>\nimport LoginBox from '../components/auth/LoginBox.vue';\nimport Link from '@/components/Link.vue';\nimport Form from '@/components/Form.vue';\n\nexport default {\n\tname: 'SetupAccount',\n\tcomponents: {\n\t\tLoginBox,\n\t\tLink,\n\t\tForm,\n\t},\n\tprops: ['requestKey', 'joinRequest'],\n\tdata() {\n\t\treturn {\n\t\t\temail: null,\n\t\t\tfirstName: null,\n\t\t\tlastName: null,\n\t\t\terrorMessage: null,\n\t\t\tuserExists: null,\n\t\t\ttwoFactorCode: null,\n\t\t\tinvitationToTeam: null,\n\t\t\tisInvitation: null,\n\t\t\toauthSignup: 0,\n\t\t\toauthDomain: false,\n\t\t\tcountry: null,\n\t\t\ttermsAccepted: false,\n\t\t\tinvitedBy: null,\n\t\t\tinvitedByParentTeam: false,\n\t\t\tcountries: [],\n\t\t\tsaasProduct: null,\n\t\t\tsignupValues: {},\n\t\t};\n\t},\n\tresources: {\n\t\tvalidateRequestKey() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.account.validate_request_key',\n\t\t\t\tparams: {\n\t\t\t\t\tkey: this.requestKey,\n\t\t\t\t\ttimezone: window.Intl\n\t\t\t\t\t\t? Intl.DateTimeFormat().resolvedOptions().timeZone\n\t\t\t\t\t\t: null,\n\t\t\t\t},\n\t\t\t\tauto: true,\n\t\t\t\tonSuccess(res) {\n\t\t\t\t\tif (res && res.email) {\n\t\t\t\t\t\tthis.email = res.email;\n\t\t\t\t\t\tthis.firstName = res.first_name;\n\t\t\t\t\t\tthis.lastName = res.last_name;\n\t\t\t\t\t\tthis.country = res.country;\n\t\t\t\t\t\tthis.userExists = res.user_exists;\n\t\t\t\t\t\tthis.invitationToTeam = res.team;\n\t\t\t\t\t\tthis.invitedBy = res.invited_by;\n\t\t\t\t\t\tthis.isInvitation = res.is_invitation;\n\t\t\t\t\t\tthis.invitedByParentTeam = res.invited_by_parent_team;\n\t\t\t\t\t\tthis.oauthSignup = res.oauth_signup;\n\t\t\t\t\t\tthis.oauthDomain = res.oauth_domain;\n\t\t\t\t\t\tthis.countries = res.countries;\n\t\t\t\t\t\tthis.saasProduct = res.product_trial;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tsetupAccount() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.account.setup_account',\n\t\t\t\tparams: {\n\t\t\t\t\tkey: this.requestKey,\n\t\t\t\t\tfirst_name: this.firstName,\n\t\t\t\t\tlast_name: this.lastName,\n\t\t\t\t\tcountry: this.country,\n\t\t\t\t\tis_invitation: this.isInvitation,\n\t\t\t\t\tuser_exists: this.userExists,\n\t\t\t\t\tinvited_by_parent_team: this.invitedByParentTeam,\n\t\t\t\t\taccepted_user_terms: this.termsAccepted,\n\t\t\t\t\toauth_signup: this.oauthSignup,\n\t\t\t\t\toauth_domain: this.oauthDomain,\n\t\t\t\t},\n\t\t\t\tonSuccess() {\n\t\t\t\t\tlet path = '/dashboard/create-site/app-selector';\n\t\t\t\t\tif (this.saasProduct) {\n\t\t\t\t\t\tpath = `/dashboard/create-site/${this.saasProduct.name}/setup`;\n\t\t\t\t\t}\n\t\t\t\t\twindow.location.href = path;\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tis2FAEnabled() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.account.is_2fa_enabled',\n\t\t\t};\n\t\t},\n\t\tverify2FA() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.account.verify_2fa',\n\t\t\t\tonSuccess() {\n\t\t\t\t\tthis.$resources.setupAccount.submit();\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tcomputed: {\n\t\tis2FA() {\n\t\t\treturn (\n\t\t\t\tthis.$route.name === 'Setup Account' && this.$route.query.two_factor\n\t\t\t);\n\t\t},\n\t},\n\tmethods: {\n\t\tsubmitForm() {\n\t\t\tif (this.invitedBy) {\n\t\t\t\tthis.$resources.is2FAEnabled.submit(\n\t\t\t\t\t{\n\t\t\t\t\t\tuser: this.email,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess: (two_factor_enabled) => {\n\t\t\t\t\t\t\tif (two_factor_enabled) {\n\t\t\t\t\t\t\t\tthis.$router.push({\n\t\t\t\t\t\t\t\t\tname: 'Setup Account',\n\t\t\t\t\t\t\t\t\tquery: {\n\t\t\t\t\t\t\t\t\t\t...this.$route.query,\n\t\t\t\t\t\t\t\t\t\ttwo_factor: 1,\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.$resources.setupAccount.submit();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tthis.$resources.setupAccount.submit();\n\t\t\t}\n\t\t},\n\t},\n};\n</script>\n"],"names":["_sfc_main","LoginBox","res","path","two_factor_enabled","__spreadProps","__spreadValues","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_8","_hoisted_9","_hoisted_10","_ctx","$data","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_createVNode","_component_LoginBox","_createSlots","_withCtx","_hoisted_7","_toDisplayString","_createCommentVNode","_Fragment","_cache","$event","_createTextVNode","_b","_hoisted_11","_hoisted_12"],"mappings":"i3CAiJA,MAAAA,EAAA,CACC,KAAA,2BAEC,SAAAC,iBAID,MAAA,CAAA,aAAA,aAAA,EACA,MAAA,CACC,MAAA,YAEC,UAAA,mBAEA,aAAA,KACA,WAAA,KACA,cAAA,KACA,iBAAA,KACA,aAAA,mBAEA,YAAA,gBAEA,cAAA,GACA,UAAA,yCAGA,YAAA,KACA,aAAA,CAAA,eAID,oBAAA,CACC,MAAA,CACC,IAAA,yCACA,OAAA,CACC,IAAA,KAAA,WACA,SAAA,OAAA,4DAID,KAAA,GACA,UAAAC,EAAA,CACCA,GAAAA,EAAA,QACC,KAAA,MAAAA,EAAA,mFAIA,KAAA,WAAAA,EAAA,YACA,KAAA,iBAAAA,EAAA,iCAEA,KAAA,aAAAA,EAAA,gEAEA,KAAA,YAAAA,EAAA,aACA,KAAA,YAAAA,EAAA,wCAEA,KAAA,YAAAA,EAAA,kBAKJ,cAAA,CACC,MAAA,CACC,IAAA,kCACA,OAAA,CACC,IAAA,KAAA,6DAGA,QAAA,KAAA,QACA,cAAA,KAAA,yFAGA,oBAAA,KAAA,uFAKA,IAAAC,EAAA,sCACA,KAAA,mGAOH,cAAA,CACC,MAAA,CACC,IAAA,iDAID,MAAA,CACC,IAAA,2CAEC,KAAA,WAAA,aAAA,OAAA,MAKJ,SAAA,CACC,OAAA,CACC,OACC,KAAA,OAAA,OAAA,iBAAA,KAAA,OAAA,MAAA,aAIH,QAAA,cAEE,KAAA,UACC,KAAA,WAAA,aAAA,OACC,CACC,KAAA,KAAA,OAED,CACC,UAAAC,GAAA,GAEE,KAAA,QAAA,KAAA,CACC,KAAA,gBACA,MAAAC,EAAAC,EAAA,GACC,KAAA,OAAA,OADD,eAID,CAAA,EAEA,KAAA,WAAA,aAAA,OAAA,KAMJ,KAAA,WAAA,aAAA,OAAA,GAIJ,WAnRE,MAAA,4CAGKC,EAAA,CAAA,MAAA,sBAAA,EAGGC,EAAA,CAAA,MAAA,qCAAA,EARVC,EAAA,CAAA,KAAA,EAcOC,EAAA,CAAA,MAAA,gEAAA,EAOFC,EAAA,CAAA,MAAA,wEAAA,WAQI,MAAA,0CA2BEC,EAAA,CAAA,MAAA,WAAA,EAkCCC,EAAA,CAAA,MAAA,kBAAA,EAEGC,EAAA,CAAA,MAAA,yBAAA,WAsCb,MAAA,qGA/HO,MAAA,CAAAC,EAAA,WAAA,mBAAA,SAAAC,EAAA,OAFRC,IAAAC,EAAA,MAAAC,EAAA,CAICC,EAAA,MAAAb,EAAA,CACCc,EAAAC,EAAA,KAAAC,EAAA,CANH,QAAAC,EAAA,IAAA,qGA6BIP,EAAA,EAAAC,EAAA,MAAAO,EAAA,kBAAAC,EAAAV,EAAA,SAAA,EAAA,CAAA,GA7BJW,EAAA,GAAA,EAAA,YAgCU,MAAA,8GACLV,EAAA,EAAAC,EAAAU,EAAA,CAAA,IAAA,CAAA,EAAA,MAEE,MAAA,uCACA,YAAA,SApCP,WAAAZ,EAAA,cAAA,sBAAAa,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAd,EAAA,cAAAc,GAsCO,SAAA,gCAGA,MAAA,OACC,QAAAf,EAAA,WAAA,UAAA,QACD,QAAA,0GA3CP,QAAAS,EAAA,IAAAK,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAAE,EAAA,UAAA,8BAqDoB,MAAA,OAAc,QAAAhB,EAAA,WAAA,UAAA,kCAE7BE,EAAA,EAAAC,EAAAU,EAAA,CAAA,IAAA,CAAA,EAAA,CACCR,EAAA,MAAAR,EAAA,kCAGE,MAAA,QACA,KAAA,OACC,WAAAI,EAAA,MACD,SAAA,4BA9DRW,EAAA,GAAA,EAAA,EAgEuBX,EAAA,aAAA,GAAA,CAAAA,EAAA,YAAhBC,EAAA,EAAAC,EAAAU,EAAA,CAAA,IAAA,CAAA,EAAA,MAEE,MAAA,aACA,KAAA,OAnET,WAAAZ,EAAA,UAAA,sBAAAa,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAd,EAAA,UAAAc,GAqES,KAAA,QACA,aAAA,aACA,SAAA,gCAGA,MAAA,YACA,KAAA,OA3ET,WAAAd,EAAA,SAAA,sBAAAa,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAd,EAAA,SAAAc,GA6ES,KAAA,QACA,aAAA,cACA,SAAA,iCA/ETH,EAAA,GAAA,EAAA,iBAAAA,EAAA,GAAA,EAAA,kBAmFQ,KAAA,SACC,QAAAX,EAAA,UAED,MAAA,UAtFR,WAAAA,EAAA,QAAA,sBAAAa,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAd,EAAA,QAAAc,GAwFQ,SAAA,sCAEDV,EAAA,MAAAP,EAAA,MACc,KAAA,WA3FrB,WAAAG,EAAA,cAAA,sBAAAa,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAd,EAAA,cAAAc,2BA4FQV,EAAA,QAAAN,EAAA,CA5FRe,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAE,EAAA,gBAAA,QA+FU,MAAA,iBACA,KAAA,mCACA,OAAA,WAjGV,QAAAP,EAAA,IAAAK,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAAE,EAAA,sBAAA,sBAyGO,MAAA,OACC,QAAAhB,EAAA,WAAA,aAAA,gCAGD,MAAA,OACA,QAAA,QACC,QAAAA,EAAA,WAAA,aAAA,UA/GR,QAAAS,EAAA,IAAA,2HAAA,KAAA,OAAA,GAAAA,EAAA,IAAA,SAAA,OAQKJ,EAAA,MAAAZ,EAAA,UAEE,MAAA,2EAVP,EAAA,KAAA,EAAAC,CAAA,EAaMW,EAAA,OAAAV,EAAAgB,GAAAM,EAAAhB,EAAA,cAAA,YAAAgB,EAAA,KAAA,EAAA,CAAA,gBAbN,sBAAA,KAAA,SAAA,GAAAR,EAAA,IAAA,CAwHKK,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAT,EAAA,MAAA,CAAA,MAAA,oEAAA,EAAA,+BAAA,EAAA,cAxHL,oBAmIc,CAAAL,EAAA,WAAA,mBAAA,SAAA,CAAAC,EAAA,OAFbC,IAAAC,EAAA,MAAAe,EAAA,CAjIDJ,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAE,EAAA,4CAAA,uBAAA,QAAAP,EAAA,IAAAK,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,CAAAE,EAAA,SAAA,WAAAF,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAE,EAAA,sBAAA,OAyICd,IAAAC,EAAA,MAAAgB,EAAA"}