{"version":3,"file":"InstallMarketplaceApp-CXyDm_Bq.js","sources":["../../../../dashboard/src/views/marketplace/InstallMarketplaceApp.vue"],"sourcesContent":["<template>\n\t<div class=\"px-4 py-4 text-base sm:px-8\">\n\t\t<Button v-if=\"$resources.opionsForQuickInstall\" :loading=\"true\"\n\t\t\t>Loading</Button\n\t\t>\n\t\t<div v-else>\n\t\t\t<h1 class=\"mb-4 text-xl font-semibold\">\n\t\t\t\tInstall App: {{ options ? options.title : '' }}\n\t\t\t</h1>\n\n\t\t\t<ErrorMessage :message=\"$resources.optionsForQuickInstall.error\" />\n\n\t\t\t<div v-if=\"options\" class=\"mt-2 grid grid-cols-1 gap-2 md:grid-cols-2\">\n\t\t\t\t<Card\n\t\t\t\t\tv-if=\"options.approved\"\n\t\t\t\t\ttitle=\"Sites\"\n\t\t\t\t\tsubtitle=\"Select a site to install\"\n\t\t\t\t>\n\t\t\t\t\t<ul v-if=\"options.sites?.length\">\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tv-for=\"site in options.sites\"\n\t\t\t\t\t\t\tclass=\"flex w-full flex-row justify-between rounded-md px-1 py-2 text-left text-base hover:bg-gray-50\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{{ site }}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t@click=\"installAppOnSite(site)\"\n\t\t\t\t\t\t\t\t:loading=\"$resources.installAppOnSite.loading\"\n\t\t\t\t\t\t\t\t>Install</Button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<p class=\"text-sm text-gray-700\">No site available for install</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<template v-slot:actions>\n\t\t\t\t\t\t<Button variant=\"solid\" route=\"/sites/new\">New Site</Button>\n\t\t\t\t\t</template>\n\t\t\t\t</Card>\n\n\t\t\t\t<Card title=\"Private Benches\" subtitle=\"Select a bench to install\">\n\t\t\t\t\t<ul v-if=\"options.release_groups?.length\" class=\"space-y-3\">\n\t\t\t\t\t\t<li\n\t\t\t\t\t\t\tv-for=\"bench in options.release_groups\"\n\t\t\t\t\t\t\tclass=\"flex w-full flex-row justify-between rounded-md px-1 py-2 text-left text-base hover:bg-gray-50\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t{{ bench.title }}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t@click=\"addAppToBench(bench)\"\n\t\t\t\t\t\t\t\t:loading=\"$resources.addAppToBench.loading\"\n\t\t\t\t\t\t\t\t>Add</Button\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t</ul>\n\n\t\t\t\t\t<div v-else>\n\t\t\t\t\t\t<p class=\"text-sm text-gray-700\">\n\t\t\t\t\t\t\tNo benches available for install\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<template v-slot:actions>\n\t\t\t\t\t\t<Button variant=\"solid\" route=\"/groups/new\">New Bench</Button>\n\t\t\t\t\t</template>\n\t\t\t\t</Card>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<Dialog\n\t\t\tv-model=\"showPlanSelectionDialog\"\n\t\t\t:options=\"{\n\t\t\t\ttitle: 'Select app plan',\n\t\t\t\tsize: 'xl'\n\t\t\t}\"\n\t\t>\n\t\t\t<template v-slot:body-content>\n\t\t\t\t<ChangeAppPlanSelector\n\t\t\t\t\tv-if=\"marketplaceApp\"\n\t\t\t\t\t:app=\"marketplaceApp\"\n\t\t\t\t\tclass=\"mb-9\"\n\t\t\t\t\t@change=\"plan => (selectedPlan = plan.name)\"\n\t\t\t\t/>\n\t\t\t\t<ErrorMessage :message=\"$resources.installAppOnSite.error\" />\n\t\t\t</template>\n\t\t\t<template v-slot:actions>\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t:loading=\"$resources.installAppOnSite.loading\"\n\t\t\t\t\t@click=\"installAppOnSite(selectedSite)\"\n\t\t\t\t\t>Proceed</Button\n\t\t\t\t>\n\t\t\t</template>\n\t\t</Dialog>\n\t</div>\n</template>\n\n<script>\nimport ChangeAppPlanSelector from '@/components/ChangeAppPlanSelector.vue';\nimport { notify } from '@/utils/toast';\n\nexport default {\n\tname: 'InstallMarketplaceApp',\n\tprops: ['marketplaceApp'],\n\tdata() {\n\t\treturn {\n\t\t\tshowPlanSelectionDialog: false,\n\t\t\tselectedSite: null,\n\t\t\tselectedBench: null,\n\t\t\tselectedPlan: null\n\t\t};\n\t},\n\tcomponents: {\n\t\tChangeAppPlanSelector\n\t},\n\tresources: {\n\t\toptionsForQuickInstall() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.marketplace.options_for_quick_install',\n\t\t\t\tparams: {\n\t\t\t\t\tmarketplace_app: this.marketplaceApp\n\t\t\t\t},\n\t\t\t\tauto: true\n\t\t\t};\n\t\t},\n\t\taddAppToBench() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.bench.add_app',\n\t\t\t\tonSuccess() {\n\t\t\t\t\tnotify({\n\t\t\t\t\t\ttitle: 'App added successfully!',\n\t\t\t\t\t\ticon: 'check',\n\t\t\t\t\t\tcolor: 'green'\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.$router.push(`/groups/${this.selectedBench}/apps`);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\t\tinstallAppOnSite() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.site.install_app',\n\t\t\t\tvalidate() {\n\t\t\t\t\tif (this.showPlanSelectionDialog && !this.selectedPlan) {\n\t\t\t\t\t\treturn 'Please select a plan to continue';\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonSuccess() {\n\t\t\t\t\tnotify({\n\t\t\t\t\t\ttitle: 'App installed successfully!',\n\t\t\t\t\t\ticon: 'check',\n\t\t\t\t\t\tcolor: 'green'\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.selectedPlan = null;\n\t\t\t\t\tthis.selectedSite = null;\n\t\t\t\t\tthis.showPlanSelectionDialog = false;\n\t\t\t\t\tthis.$resources.optionsForQuickInstall.fetch();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t},\n\tmethods: {\n\t\taddAppToBench(group) {\n\t\t\tthis.selectedBench = group.name;\n\n\t\t\tthis.$resources.addAppToBench.submit({\n\t\t\t\tname: group.name,\n\t\t\t\tsource: group.source,\n\t\t\t\tapp: this.options.app_name\n\t\t\t});\n\t\t},\n\n\t\tinstallAppOnSite(site) {\n\t\t\tthis.selectedSite = site;\n\n\t\t\t// If paid app, show plan selection dialog\n\t\t\tif (this.options.has_plans_available && !this.showPlanSelectionDialog) {\n\t\t\t\tthis.showPlanSelectionDialog = true;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$resources.installAppOnSite.submit({\n\t\t\t\tname: site,\n\t\t\t\tapp: this.options.app_name,\n\t\t\t\tplan: this.selectedPlan\n\t\t\t});\n\t\t}\n\t},\n\tcomputed: {\n\t\toptions() {\n\t\t\tif (\n\t\t\t\tthis.$resources.optionsForQuickInstall.data &&\n\t\t\t\t!this.$resources.optionsForQuickInstall.loading\n\t\t\t) {\n\t\t\t\treturn this.$resources.optionsForQuickInstall.data;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","ChangeAppPlanSelector","notify","group","site","_hoisted_1","_hoisted_3","_hoisted_6","_hoisted_9","_openBlock","_createElementBlock","_ctx","_withCtx","_cache","_createTextVNode","_hoisted_2","_hoisted_4","$options","_hoisted_5","_Fragment","_renderList","_createElementVNode","_toDisplayString","_hoisted_7","_createCommentVNode","_hoisted_8","bench","_hoisted_10","$data","$event","$props","plan"],"mappings":"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"}