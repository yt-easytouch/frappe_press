var S=Object.defineProperty,q=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var x=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var w=(t,e,i)=>e in t?S(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,k=(t,e)=>{for(var i in e||(e={}))I.call(e,i)&&w(t,i,e[i]);if(x)for(var i of x(e))C.call(e,i)&&w(t,i,e[i]);return t},A=(t,e)=>q(t,N(e));import{x as E,af as F,r as P,q as u,o as a,j as r,A as n,a6 as T,w as l,t as f,u as y,a7 as D,F as _,a8 as K,X as L,Y as m,a9 as j,h as V}from"./main-Dpl-JOF2.js";import{L as M}from"./LoginBox-qd4moaUa.js";import{_ as U}from"./Form-CIPLpg2e.js";import"./YooltechLogo-DH5Linvn.js";import"./ETLogo-Ziye5dPH.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="c2db8738-f53e-4a11-b3b0-c7e4212cf675",t._sentryDebugIdIdentifier="sentry-dbid-c2db8738-f53e-4a11-b3b0-c7e4212cf675")}catch(i){}})();{var p=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};p._sentryModuleMetadata=p._sentryModuleMetadata||{},p._sentryModuleMetadata[new Error().stack]=Object.assign({},p._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const R={name:"SetupAccount",components:{LoginBox:M,Link:F,Form:U},props:["requestKey","joinRequest"],data(){return{email:null,firstName:null,lastName:null,errorMessage:null,userExists:null,twoFactorCode:null,invitationToTeam:null,isInvitation:null,oauthSignup:0,oauthDomain:!1,country:null,termsAccepted:!1,invitedBy:null,invitedByParentTeam:!1,countries:[],saasProduct:null,signupValues:{}}},resources:{validateRequestKey(){return{url:"press.api.account.validate_request_key",params:{key:this.requestKey,timezone:window.Intl?Intl.DateTimeFormat().resolvedOptions().timeZone:null},auto:!0,onSuccess(t){t&&t.email&&(this.email=t.email,this.firstName=t.first_name,this.lastName=t.last_name,this.country=t.country,this.userExists=t.user_exists,this.invitationToTeam=t.team,this.invitedBy=t.invited_by,this.isInvitation=t.is_invitation,this.invitedByParentTeam=t.invited_by_parent_team,this.oauthSignup=t.oauth_signup,this.oauthDomain=t.oauth_domain,this.countries=t.countries,this.saasProduct=t.product_trial)}}},setupAccount(){return{url:"press.api.account.setup_account",params:{key:this.requestKey,first_name:this.firstName,last_name:this.lastName,country:this.country,is_invitation:this.isInvitation,user_exists:this.userExists,invited_by_parent_team:this.invitedByParentTeam,accepted_user_terms:this.termsAccepted,oauth_signup:this.oauthSignup,oauth_domain:this.oauthDomain},onSuccess(){let t="/dashboard/create-site/app-selector";this.saasProduct&&(t=`/dashboard/create-site/${this.saasProduct.name}/setup`),window.location.href=t}}},is2FAEnabled(){return{url:"press.api.account.is_2fa_enabled"}},verify2FA(){return{url:"press.api.account.verify_2fa",onSuccess(){this.$resources.setupAccount.submit()}}}},computed:{is2FA(){return this.$route.name==="Setup Account"&&this.$route.query.two_factor}},methods:{submitForm(){this.invitedBy?this.$resources.is2FAEnabled.submit({user:this.email},{onSuccess:t=>{t?this.$router.push({name:"Setup Account",query:A(k({},this.$route.query),{two_factor:1})}):this.$resources.setupAccount.submit()}}):this.$resources.setupAccount.submit()}}},O={key:0,class:"flex h-screen overflow-hidden bg-gray-50"},z={class:"w-full overflow-auto"},X={class:"mx-auto flex items-center space-x-2"},Y=["src"],Z={class:"select-none text-xl font-semibold tracking-tight text-gray-900"},H={class:"text-center text-lg font-medium leading-5 tracking-tight text-gray-900"},J={key:0,class:"mt-2 text-center text-sm text-gray-600"},Q={class:"space-y-4"},W={class:"!mt-6 flex gap-2"},G={class:"text-base text-gray-700"},$={key:1,class:"mt-20 px-6 text-center"},ee={key:2};function te(t,e,i,se,s,d){const c=K,g=L,h=j,v=F,B=P("LoginBox");return!t.$resources.validateRequestKey.loading&&s.email?(a(),u("div",O,[r("div",z,[n(B,null,T({default:l(()=>[r("div",H,f(s.invitedBy?"Invitation to join":"Set up your Easytouch Cloud account"),1),s.invitedBy?(a(),u("div",J," Invitation by "+f(s.invitedBy),1)):y("",!0),r("form",{class:"mt-6 flex flex-col",onSubmit:e[6]||(e[6]=D((...o)=>d.submitForm&&d.submitForm(...o),["prevent"]))},[d.is2FA?(a(),u(_,{key:0},[n(c,{label:"2FA Code from your Authenticator App",placeholder:"123456",modelValue:s.twoFactorCode,"onUpdate:modelValue":e[0]||(e[0]=o=>s.twoFactorCode=o),required:""},null,8,["modelValue"]),n(g,{class:"mt-4",loading:t.$resources.verify2FA.loading,variant:"solid",onClick:e[1]||(e[1]=o=>t.$resources.verify2FA.submit({user:s.email,totp_code:s.twoFactorCode}))},{default:l(()=>e[7]||(e[7]=[m(" Verify ")])),_:1},8,["loading"]),n(h,{class:"mt-2",message:t.$resources.verify2FA.error},null,8,["message"])],64)):(a(),u(_,{key:1},[r("div",Q,[s.oauthSignup==0?(a(),V(c,{key:0,label:"Email",type:"text",modelValue:s.email,disabled:""},null,8,["modelValue"])):y("",!0),s.oauthSignup==0&&!s.userExists?(a(),u(_,{key:1},[n(c,{label:"First Name",type:"text",modelValue:s.firstName,"onUpdate:modelValue":e[2]||(e[2]=o=>s.firstName=o),name:"fname",autocomplete:"given-name",required:""},null,8,["modelValue"]),n(c,{label:"Last Name",type:"text",modelValue:s.lastName,"onUpdate:modelValue":e[3]||(e[3]=o=>s.lastName=o),name:"lname",autocomplete:"family-name",required:""},null,8,["modelValue"])],64)):y("",!0),s.isInvitation?y("",!0):(a(),V(c,{key:2,type:"select",options:s.countries,label:"Country",modelValue:s.country,"onUpdate:modelValue":e[4]||(e[4]=o=>s.country=o),required:""},null,8,["options","modelValue"])),r("div",W,[n(c,{type:"checkbox",modelValue:s.termsAccepted,"onUpdate:modelValue":e[5]||(e[5]=o=>s.termsAccepted=o)},null,8,["modelValue"]),r("label",G,[e[9]||(e[9]=m(" I accept the ")),n(v,{class:"!text-gray-700",href:"https://easytouch.cloud/policies",target:"_blank"},{default:l(()=>e[8]||(e[8]=[m(" Terms and Policies ")])),_:1})])])]),n(h,{class:"mt-4",message:t.$resources.setupAccount.error},null,8,["message"]),n(g,{class:"mt-6",variant:"solid",loading:t.$resources.setupAccount.loading},{default:l(()=>[m(f(d.is2FA?"Verify":s.isInvitation?"Accept":"Create account"),1)]),_:1},8,["loading"])],64))],32)]),_:2},[s.saasProduct?{name:"logo",fn:l(()=>{var o,b;return[r("div",X,[r("img",{class:"inline-block h-7 w-7 rounded-sm",src:(o=s.saasProduct)==null?void 0:o.logo},null,8,Y),r("span",Z,f((b=s.saasProduct)==null?void 0:b.title),1)])]}),key:"0"}:void 0,s.saasProduct?{name:"footer",fn:l(()=>[e[10]||(e[10]=r("div",{class:"mt-2 flex w-full items-center justify-center text-sm text-gray-600"}," Powered by Easytouch Cloud ",-1))]),key:"1"}:void 0]),1024)])])):!t.$resources.validateRequestKey.loading&&!s.email?(a(),u("div",$,[e[12]||(e[12]=m(" Verification link is invalid or expired. ")),n(v,{to:"/signup"},{default:l(()=>e[11]||(e[11]=[m("Sign up")])),_:1}),e[13]||(e[13]=m(" for a new account. "))])):(a(),u("div",ee))}const le=E(R,[["render",te]]);export{le as default};
//# sourceMappingURL=SetupAccount-CiKBAjvi.js.map
