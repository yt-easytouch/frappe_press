{"version":3,"file":"SiteLogs-hfO0U0mX.js","sources":["../../../../dashboard/src2/components/site/SiteLogs.vue"],"sourcesContent":["<template>\n\t<ObjectList class=\"p-5\" :options=\"logsOptions\" />\n</template>\n\n<script>\nimport { h } from 'vue';\nimport LucideSparkleIcon from '~icons/lucide/sparkle';\nimport { date } from '../../utils/format';\nimport ObjectList from '../ObjectList.vue';\n\nexport default {\n\tname: 'SiteLogs',\n\tprops: {\n\t\tname: {\n\t\t\ttype: String,\n\t\t\trequired: true\n\t\t},\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\trequired: false\n\t\t}\n\t},\n\tcomponents: {\n\t\tObjectList\n\t},\n\tresources: {\n\t\tlogs() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.site.logs',\n\t\t\t\tparams: {\n\t\t\t\t\tname: this.name\n\t\t\t\t},\n\t\t\t\tauto: true,\n\t\t\t\tinitialData: [],\n\t\t\t\tcache: ['ObjectList', 'press.api.site.logs', this.name]\n\t\t\t};\n\t\t}\n\t},\n\tcomputed: {\n\t\tlogs() {\n\t\t\tconst knownTypes = [\n\t\t\t\t'frappe',\n\t\t\t\t'scheduler',\n\t\t\t\t'database',\n\t\t\t\t'pdf',\n\t\t\t\t'wkhtmltopdf',\n\t\t\t\t'ipython'\n\t\t\t];\n\n\t\t\tif (this.type && !knownTypes.includes(this.type)) {\n\t\t\t\treturn this.$resources.logs.data.filter(\n\t\t\t\t\td => !knownTypes.includes(d.name.split('.')[0])\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// logs of a particular type\n\t\t\treturn this.$resources.logs.data.filter(\n\t\t\t\td => d.name.split('.')[0] === this.type\n\t\t\t);\n\t\t},\n\t\tlogsOptions() {\n\t\t\tif (this.type) {\n\t\t\t\treturn {\n\t\t\t\t\tdata: () => this.logs,\n\t\t\t\t\troute(row) {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tname: 'Site Log',\n\t\t\t\t\t\t\tparams: { logName: row.name }\n\t\t\t\t\t\t};\n\t\t\t\t\t},\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Name',\n\t\t\t\t\t\t\tfieldname: 'name'\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Size',\n\t\t\t\t\t\t\tfieldname: 'size',\n\t\t\t\t\t\t\tclass: 'text-gray-600',\n\t\t\t\t\t\t\tformat(value) {\n\t\t\t\t\t\t\t\treturn `${value} kB`;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Modified On',\n\t\t\t\t\t\t\tfieldname: 'modified',\n\t\t\t\t\t\t\tformat(value) {\n\t\t\t\t\t\t\t\treturn value ? date(value, 'lll') : '';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tactions: () => [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tslots: {\n\t\t\t\t\t\t\t\tprefix: () => h(LucideSparkleIcon)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tlabel: 'View in Log Browser',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tthis.$router.push({\n\t\t\t\t\t\t\t\t\tname: 'Log Browser',\n\t\t\t\t\t\t\t\t\tparams: { mode: 'site', docName: this.name }\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Refresh',\n\t\t\t\t\t\t\ticon: 'refresh-ccw',\n\t\t\t\t\t\t\tloading: this.$resources.logs.loading,\n\t\t\t\t\t\t\tonClick: () => this.$resources.logs.reload()\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tdata: () => [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Scheduler Logs',\n\t\t\t\t\t\t\troute: {\n\t\t\t\t\t\t\t\tname: 'Site Logs',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\t\ttype: 'scheduler'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Database Logs',\n\t\t\t\t\t\t\troute: {\n\t\t\t\t\t\t\t\tname: 'Site Logs',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\t\ttype: 'database'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Frappe Logs',\n\t\t\t\t\t\t\troute: {\n\t\t\t\t\t\t\t\tname: 'Site Logs',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\t\ttype: 'frappe'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'PDF Logs',\n\t\t\t\t\t\t\troute: {\n\t\t\t\t\t\t\t\tname: 'Site Logs',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\t\ttype: 'pdf'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'IPython Logs',\n\t\t\t\t\t\t\troute: {\n\t\t\t\t\t\t\t\tname: 'Site Logs',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\t\ttype: 'ipython'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Wkhtmltopdf Logs',\n\t\t\t\t\t\t\troute: {\n\t\t\t\t\t\t\t\tname: 'Site Logs',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\t\ttype: 'wkhtmltopdf'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttitle: 'Other Logs',\n\t\t\t\t\t\t\troute: {\n\t\t\t\t\t\t\t\tname: 'Site Logs',\n\t\t\t\t\t\t\t\tparams: {\n\t\t\t\t\t\t\t\t\tname: this.name,\n\t\t\t\t\t\t\t\t\ttype: 'other'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tcolumns: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: 'Title',\n\t\t\t\t\t\t\tfieldname: 'title',\n\t\t\t\t\t\t\twidth: 0.3\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlabel: '',\n\t\t\t\t\t\t\tfieldname: 'action',\n\t\t\t\t\t\t\ttype: 'Button',\n\t\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t\t\tButton: ({ row }) => {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tlabel: 'View',\n\t\t\t\t\t\t\t\t\ttype: 'primary',\n\t\t\t\t\t\t\t\t\ticonRight: 'arrow-right',\n\t\t\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\t\t\tthis.$router.push(row.route);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tactions: () => [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tslots: {\n\t\t\t\t\t\t\t\tprefix: () => h(LucideSparkleIcon)\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tlabel: 'View in Log Browser',\n\t\t\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\t\t\tthis.$router.push({\n\t\t\t\t\t\t\t\t\tname: 'Log Browser',\n\t\t\t\t\t\t\t\t\tparams: { mode: 'site', docName: this.name }\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","ObjectList","knownTypes","d","value","date","h","LucideSparkleIcon","row","$options"],"mappings":"6wBAUA,MAAAA,EAAA,CACC,KAAA,WACA,MAAA,6DAQC,eAGA,WAAAC,cAGA,MAAA,CACC,MAAA,2BAEC,OAAA,iBAGA,KAAA,GACA,YAAA,CAAA,uDAGF,GAED,SAAA,CACC,MAAA,CACC,MAAAC,EAAA,CACC,oDAKA,oDAIA,KAAA,WAAA,KAAA,KAAA,OACCC,GAAA,CAAAD,EAAA,SAAAC,EAAA,KAAA,MAAA,GAAA,EAAA,CAAA,CAAA,GAKF,KAAA,WAAA,KAAA,KAAA,OACCA,GAAAA,EAAA,KAAA,MAAA,GAAA,EAAA,CAAA,IAAA,KAAA,sCAKA,CACC,KAAA,IAAA,KAAA,cAEC,MAAA,CACC,KAAA,qCAIF,QAAA,CACC,cAEC,UAAA,QAED,cAEC,UAAA,OACA,MAAA,0BAEC,MAAA,GAAAC,CAAA,KACD,GAED,CACC,MAAA,cACA,UAAA,qBAEC,OAAAA,EAAAC,EAAAD,EAAA,KAAA,EAAA,EACD,CACD,gBAGA,CACC,MAAA,CACC,OAAA,IAAAE,EAAAC,CAAA,4CAIA,KAAA,QAAA,KAAA,CACC,KAAA,cACA,OAAA,CAAA,KAAA,OAAA,QAAA,KAAA,IAAA,CACD,CAAA,CACD,GAED,CACC,MAAA,UACA,KAAA,cACA,QAAA,KAAA,WAAA,KAAA,QACA,QAAA,IAAA,KAAA,WAAA,KAAA,OAAA,CACD,CACD,GAGD,CACC,KAAA,IAAA,CACC,CACC,MAAA,iBACA,MAAA,CACC,KAAA,YACA,OAAA,CACC,KAAA,KAAA,KACA,KAAA,WACD,CACD,GAED,CACC,MAAA,gBACA,MAAA,CACC,KAAA,YACA,OAAA,CACC,KAAA,KAAA,KACA,KAAA,UACD,CACD,GAED,CACC,MAAA,cACA,MAAA,CACC,KAAA,YACA,OAAA,CACC,KAAA,KAAA,kBAED,CACD,GAED,CACC,MAAA,WACA,MAAA,CACC,KAAA,YACA,OAAA,CACC,KAAA,KAAA,KACA,KAAA,KACD,CACD,GAED,CACC,MAAA,eACA,MAAA,CACC,KAAA,YACA,OAAA,CACC,KAAA,KAAA,mBAED,CACD,GAED,0BAEC,MAAA,CACC,KAAA,YACA,OAAA,CACC,KAAA,KAAA,KACA,KAAA,aACD,CACD,GAED,CACC,MAAA,aACA,MAAA,CACC,KAAA,YACA,OAAA,CACC,KAAA,KAAA,iBAED,CACD,CACD,GAED,QAAA,CACC,eAEC,UAAA,QACA,MAAA,IAED,CACC,MAAA,GACA,UAAA,qCAGA,OAAA,CAAA,CAAA,IAAAC,MACC,cAEC,KAAA,yEAIA,GAGH,gBAGA,CACC,MAAA,CACC,OAAA,IAAAF,EAAAC,CAAA,4CAIA,KAAA,QAAA,KAAA,CACC,KAAA,cACA,OAAA,CAAA,KAAA,OAAA,QAAA,KAAA,IAAA,CACD,CAAA,CACD,CACD,CACD,EAGH,CACD,CACD,kEAlOa,MAAA,MAAa,QAAAE,EAAA"}