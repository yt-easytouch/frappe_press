var p=(e,t,n)=>new Promise((w,a)=>{var c=o=>{try{i(n.next(o))}catch(s){a(s)}},l=o=>{try{i(n.throw(o))}catch(s){a(s)}},i=o=>o.done?w(o.value):Promise.resolve(o.value).then(c,l);i((n=n.apply(e,t)).next())});import{x as D,h as V,o as m,w as g,j as r,q as d,u as h,A as y,a8 as v,X as A,Y as P,F as k,v as E,t as _,aA as G,ai as b,V as f}from"./main-Dpl-JOF2.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},t=new Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="b76b411b-a55b-4ea6-85c1-6c1bfa22e329",e._sentryDebugIdIdentifier="sentry-dbid-b76b411b-a55b-4ea6-85c1-6c1bfa22e329")}catch(n){}})();{var u=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};u._sentryModuleMetadata=u._sentryModuleMetadata||{},u._sentryModuleMetadata[new Error().stack]=Object.assign({},u._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const I={name:"PartnerPaymentPayout",data(){return{paymentGateway:"",partner:"",fromDate:"",toDate:"",partnerList:[],payments:[],fetchAttempted:!1,paymentGatewayList:[]}},resources:{createPaymentPartnerPayout(){return{url:"press.api.regional_payments.mpesa.utils.create_payment_partner_payout",method:"POST",params:{payment_gateway:this.paymentGateway.value,payment_partner:this.partner.value,from_date:this.fromDate,to_date:this.toDate,payments:this.payments},onSuccess:()=>{f.success("Payments submitted successfully"),this.$emit("close")},onError:e=>{f.error(`Error submitting payments: ${e.message}`)}}}},methods:{createAndSubmitPayout(){return p(this,null,function*(){try{this.paymentInProgress=!0,yield this.$resources.createPaymentPartnerPayout.submit()}catch(e){f.error(`Error submitting payments: ${e.message}`)}finally{this.paymentInProgress=!1}})},fetchPayments(){return p(this,null,function*(){try{this.fetchAttempted=!0;const e=yield b({url:"press.api.regional_payments.mpesa.utils.fetch_payments",method:"GET",params:{payment_gateway:this.paymentGateway.value,partner:this.partner.value,from_date:this.fromDate,to_date:this.toDate}});Array.isArray(e)?this.payments=e:console.log("No Data")}catch(e){f.error(`Error fetching payments: ${e.message}`)}})},fetchPartners(){return p(this,null,function*(){try{const e=yield b({url:"/api/method/press.api.regional_payments.mpesa.utils.display_payment_partners",method:"GET"});Array.isArray(e)?this.partnerList=e:console.log("No Data")}catch(e){this.errorMessage=`Failed to fetch teams ${e.message}`}})},fetchPaymentGateway(){return p(this,null,function*(){try{const e=yield b({url:"/api/method/press.api.regional_payments.mpesa.utils.display_payment_gateway",method:"GET"});Array.isArray(e)?this.paymentGatewayList=e:console.log("No Data")}catch(e){this.errorMessage=`Failed to fetch payment gateway ${e.message}`}})}},mounted(){this.fetchPartners(),this.fetchPaymentGateway()}},S={class:"grid grid-cols-2 gap-4"},x={key:0,class:"mt-5"},N={class:"w-full border-collapse border border-gray-300"},C={class:"border border-gray-300 p-2"},F={class:"border border-gray-300 p-2"},L={class:"border border-gray-300 p-2"},T={key:1,class:"text-center mt-4 text-gray-500"},B={key:2,class:"mt-4 flex w-full justify-end"};function j(e,t,n,w,a,c){const l=v,i=A,o=G;return m(),V(o,{options:{title:"Partner Payments Payouts",size:"lg"}},{"body-content":g(()=>[r("div",S,[y(l,{label:"Payment Gateway",modelValue:a.paymentGateway,"onUpdate:modelValue":t[0]||(t[0]=s=>a.paymentGateway=s),name:"payment_gateway",type:"autocomplete",options:a.paymentGatewayList,size:"sm",variant:"subtle",class:"mb-5",placeholder:"Enter Payment Gateway"},null,8,["modelValue","options"]),y(l,{label:"Partner",modelValue:a.partner,"onUpdate:modelValue":t[1]||(t[1]=s=>a.partner=s),options:a.partnerList,size:"sm",variant:"subtle",type:"autocomplete",class:"mb-5",placeholder:"Enter Partner"},null,8,["modelValue","options"]),y(l,{label:"From Date",modelValue:a.fromDate,"onUpdate:modelValue":t[2]||(t[2]=s=>a.fromDate=s),name:"from_date",autocomplete:"off",class:"mb-5",type:"date",placeholder:"Select Start Date"},null,8,["modelValue"]),y(l,{label:"To Date",modelValue:a.toDate,"onUpdate:modelValue":t[3]||(t[3]=s=>a.toDate=s),name:"to_date",autocomplete:"off",class:"mb-5",type:"date",placeholder:"Select End Date"},null,8,["modelValue"]),y(i,{onClick:c.fetchPayments,variant:"solid",class:"justify-center col-span-2"},{default:g(()=>t[4]||(t[4]=[P(" Fetch Payments ")])),_:1},8,["onClick"])]),a.payments.length>0?(m(),d("div",x,[r("table",N,[t[5]||(t[5]=r("thead",null,[r("tr",null,[r("th",{class:"border border-gray-300 p-2"},"Transaction ID"),r("th",{class:"border border-gray-300 p-2"},"Amount"),r("th",{class:"border border-gray-300 p-2"},"Posting Date")])],-1)),r("tbody",null,[(m(!0),d(k,null,E(a.payments,s=>(m(),d("tr",{key:s.name},[r("td",C,_(s.name),1),r("td",F,_(s.amount),1),r("td",L,_(s.posting_date),1)]))),128))])])])):h("",!0),a.payments.length===0&&a.fetchAttempted?(m(),d("div",T," No payments found. ")):h("",!0),a.payments.length!=0?(m(),d("div",B,[y(i,{variant:"outline",onClick:c.createAndSubmitPayout,loading:e.paymentInProgress},{default:g(()=>t[6]||(t[6]=[P(" Submit Payments ")])),_:1},8,["onClick","loading"])])):h("",!0)]),_:1})}const z=D(I,[["render",j],["__scopeId","data-v-25a8e788"]]);export{z as default};
//# sourceMappingURL=PartnerPaymentPayout-BY4yK8Qc.js.map
