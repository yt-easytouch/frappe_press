var b=(e,n,s)=>new Promise((l,r)=>{var _=t=>{try{o(s.next(t))}catch(a){r(a)}},p=t=>{try{o(s.throw(t))}catch(a){r(a)}},o=t=>t.done?l(t.value):Promise.resolve(t.value).then(_,p);o((s=s.apply(e,n)).next())});import{_ as y,a as v}from"./SectionCard-DhC64oIK.js";import{x as g,h as d,u as w,o as c,w as h,A as k,q as f,F as J,v as $,j as m,aj as S,B as x,n as j,t as I}from"./main-Dpl-JOF2.js";(function(){try{var e=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},n=new Error().stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b77149e1-3132-4d5b-9129-c4e7eeb52ba5",e._sentryDebugIdIdentifier="sentry-dbid-b77149e1-3132-4d5b-9129-c4e7eeb52ba5")}catch(s){}})();{var u=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};u._sentryModuleMetadata=u._sentryModuleMetadata||{},u._sentryModuleMetadata[new Error().stack]=Object.assign({},u._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const P={name:"ServerInstall",props:["server"],data(){return{iconMap:{Running:"loader",Success:"check",Pending:"minus"},creationJob:null}},mounted(){this.$socket.on("press_job_update",this.onPressJobUpdate),this.fetchJob()},unmounted(){this.$socket.emit("doc_unsubscribe","Press Job",this.creationJob.name),this.$socket.off("press_job_update",this.onPressJobUpdate)},methods:{onPressJobUpdate(e){e.server===this.server.name&&e.job_type==="Create Server"&&(this.creationJob=e,e.status==="Success"&&this.$route.path.startsWith(`/servers/${this.server.name}`)&&(this.creationJob=null,this.$router.replace(`/servers/${this.server.name}/overview`)))},fetchJob(){return b(this,null,function*(){var n;(yield this.$call("press.api.server.press_jobs",{name:this.server.name})).forEach(s=>{s.job_type==="Create Server"&&(this.creationJob=s,this.$socket.emit("doc_subscribe","Press Job",s.name))}),((n=this.creationJob)==null?void 0:n.status)==="Success"&&this.$router.replace(`/servers/${this.server.name}/overview`)})}}},B={class:"h-4 w-4 text-gray-800"},C={class:"ml-2"};function D(e,n,s,l,r,_){const p=S,o=x,t=y,a=v;return r.creationJob?(c(),d(a,{key:0,title:"Your server is being setup ...",description:"Please wait while we set up your server for use"},{default:h(()=>[k(t,null,{default:h(()=>[(c(!0),f(J,null,$(r.creationJob.steps,i=>(c(),f("div",{class:"flex items-center px-6 py-2 text-base",key:i.name},[m("div",B,[i.status==="Running"?(c(),d(p,{key:0,class:"h-3 w-3 text-gray-500"})):(c(),d(o,{key:1,class:j(["h-4 w-4",{spin:i.status==="Running"}]),name:r.iconMap[i.status]},null,8,["class","name"]))]),m("span",C,I(i.step_name),1)]))),128))]),_:1})]),_:1})):w("",!0)}const N=g(P,[["render",D]]);export{N as default};
//# sourceMappingURL=ServerInstall-BFjF9OJE.js.map
