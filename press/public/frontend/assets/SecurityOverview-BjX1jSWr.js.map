{"version":3,"file":"SecurityOverview-BjX1jSWr.js","sources":["../../../../dashboard/src/views/security/SecurityUpdatesOverview.vue","../../../../dashboard/src/views/security/FirewallOverview.vue","../../../../dashboard/src/views/security/SSHSessionOverview.vue"],"sourcesContent":["<template>\n\t<Card\n\t\tclass=\"h-full max-h-96 min-h-full\"\n\t\ttitle=\"Security Updates\"\n\t\tsubtitle=\"Pedning security updates\"\n\t>\n\t\t<div class=\"divide-y\">\n\t\t\t<router-link\n\t\t\t\tv-for=\"sec_update in securityUpdates.data\"\n\t\t\t\tclass=\"block cursor-pointer rounded-md px-2.5\"\n\t\t\t\t:key=\"sec_update.name\"\n\t\t\t\t:to=\"updateRoute(sec_update.name)\"\n\t\t\t>\n\t\t\t\t<ListItem\n\t\t\t\t\t:title=\"`Package: ${sec_update.package}`\"\n\t\t\t\t\t:description=\"getDescription(sec_update)\"\n\t\t\t\t>\n\t\t\t\t\t<template v-slot:actions>\n\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t:label=\"sec_update.priority\"\n\t\t\t\t\t\t\t:theme=\"getColor(sec_update.priority)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</ListItem>\n\t\t\t</router-link>\n\t\t</div>\n\n\t\t<template #actions>\n\t\t\t<router-link\n\t\t\t\tclass=\"text-base text-gray-700 hover:text-gray-800\"\n\t\t\t\t:to=\"`/security/${server.name}/security_update`\"\n\t\t\t>\n\t\t\t\tView details →\n\t\t\t</router-link>\n\t\t</template>\n\t</Card>\n</template>\n<script>\nexport default {\n\tname: 'SecurityUpdatesOverview',\n\tprops: ['server'],\n\tinject: ['viewportWidth'],\n\tresources: {\n\t\tsecurityUpdates() {\n\t\t\treturn {\n\t\t\t\ttype: 'list',\n\t\t\t\tdoctype: 'Security Update',\n\t\t\t\turl: 'press.api.security.fetch_security_updates',\n\t\t\t\tfilters: { server: this.server?.name },\n\t\t\t\torderBy: 'priority_level asc',\n\t\t\t\tpageLength: 3,\n\t\t\t\tstart: 0,\n\t\t\t\tauto: true\n\t\t\t};\n\t\t}\n\t},\n\tcomputed: {\n\t\tsecurityUpdates() {\n\t\t\treturn this.$resources.securityUpdates;\n\t\t}\n\t},\n\tmethods: {\n\t\tgetDescription(a) {\n\t\t\treturn `Version: ${a.version} | ${this.formatDate(a.datetime)}`;\n\t\t},\n\t\tgetColor(priority) {\n\t\t\tswitch (priority) {\n\t\t\t\tcase 'High':\n\t\t\t\t\treturn 'red';\n\t\t\t\tcase 'Medium':\n\t\t\t\t\treturn 'orange';\n\t\t\t\tcase 'Low':\n\t\t\t\t\treturn 'green';\n\t\t\t\tdefault:\n\t\t\t\t\treturn 'gray';\n\t\t\t}\n\t\t},\n\t\tupdateRoute(sec_update) {\n\t\t\treturn `/security/${this.server.name}/security_update/${sec_update}`;\n\t\t}\n\t}\n};\n</script>\n","<template>\n\t<Card class=\"min-h-full h-full max-h-96\" title=\"Firewall\">\n\t\t<div class=\"divide-y\"></div>\n\t</Card>\n</template>\n\n<script>\nexport default {\n\tname: 'FirewallOverview',\n\tprops: ['server']\n};\n</script>\n","<template>\n\t<Card class=\"h-full max-h-96 min-h-full\" title=\"SSH Activity Log\">\n\t\t<div class=\"divide-y\">\n\t\t\t<router-link\n\t\t\t\tv-for=\"log in $resources.sshLogs.data\"\n\t\t\t\tclass=\"block cursor-pointer rounded-md px-2.5\"\n\t\t\t\t:key=\"log.name\"\n\t\t\t\t:to=\"updateRoute(log.name)\"\n\t\t\t>\n\t\t\t\t<ListItem :title=\"getTitle(log)\" :description=\"getDescription(log)\">\n\t\t\t\t\t<template v-slot:actions>\n\t\t\t\t\t\t<Badge :label=\"getLabel(log.user)\" :theme=\"getColor(log.user)\" />\n\t\t\t\t\t</template>\n\t\t\t\t</ListItem>\n\t\t\t</router-link>\n\t\t</div>\n\t\t<template #actions>\n\t\t\t<router-link\n\t\t\t\tclass=\"text-base text-gray-700 hover:text-gray-800\"\n\t\t\t\t:to=\"`/security/${server.name}/ssh_session_logs`\"\n\t\t\t>\n\t\t\t\tView details →\n\t\t\t</router-link>\n\t\t</template>\n\t</Card>\n</template>\n\n<script>\nimport { Card } from 'frappe-ui';\n\nexport default {\n\tname: 'SSHSessionsOverview',\n\tprops: ['server'],\n\tcomponents: { Card },\n\tresources: {\n\t\tsshLogs() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.security.fetch_ssh_session_logs',\n\t\t\t\tparams: {\n\t\t\t\t\tserver: this.server?.name\n\t\t\t\t},\n\t\t\t\tauto: true\n\t\t\t};\n\t\t}\n\t},\n\tcomputed: {\n\t\tsshLogs() {\n\t\t\treturn this.$resources.sshLogs.data;\n\t\t}\n\t},\n\tmethods: {\n\t\tgetTitle(log) {\n\t\t\treturn `SSH Session Id: ${log.session_id}`;\n\t\t},\n\t\tgetDescription(log) {\n\t\t\treturn `Created On: ${this.formatDate(log.created)} <br> Size: ${\n\t\t\t\tlog.size\n\t\t\t} Kb`;\n\t\t},\n\t\tupdateRoute(name) {\n\t\t\treturn `/security/${this.server.name}/ssh_session_logs/${name}`;\n\t\t},\n\t\tgetLabel(user) {\n\t\t\treturn `User: ${user}`;\n\t\t},\n\t\tgetColor(user) {\n\t\t\treturn user === 'root' ? 'red' : 'green';\n\t\t}\n\t}\n};\n</script>\n"],"names":["_sfc_main","_a","a","priority","sec_update","_hoisted_1","_withCtx","_cache","_createTextVNode","_createElementVNode","_openBlock","_createElementBlock","_Fragment","_renderList","$options","Card","log","name","user"],"mappings":"+3BAsCA,MAAAA,EAAA,CACC,KAAA,0BACA,MAAA,CAAA,QAAA,sCAGC,iBAAA,OACC,MAAA,uFAIC,QAAA,CAAA,QAAAC,EAAA,KAAA,SAAA,YAAAA,EAAA,IAAA,4CAGA,MAAA,EACA,KAAA,GAEF,GAED,SAAA,CACC,iBAAA,CACC,OAAA,KAAA,WAAA,eACD,GAED,QAAA,CACC,eAAAC,EAAA,iEAGA,SAAAC,EAAA,CACC,OAAAA,EAAA,qCAIE,MAAA,SACD,IAAA,oBAEA,oBAED,kBAGA,MAAA,aAAA,KAAA,OAAA,IAAA,oBAAAC,CAAA,EACD,CACD,CACD,EA3EOC,EAAA,CAAA,MAAA,UAAA,+EAJL,MAAA,6BACA,MAAA,mBACA,SAAA,6BAuBW,QAAAC,EAAA,IAAA,MAET,MAAA,gGA7BJ,QAAAA,EAAA,IAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAAC,EAAA,kBAAA,sBAAA,QAAAF,EAAA,IAAA,CAMEG,EAAA,MAAAJ,EAAA,EACCK,EAAA,EAAA,EAAAC,EAAAC,EAAA,KAAAC,EAAAC,EAAA,gBAAA,KAAAV,aAEC,MAAA,oDAEC,GAAAU,EAAA,YAAAV,EAAA,IAAA,IAXL,QAAAE,EAAA,IAAA,sEAiBsB,QAAAA,EAAA,IAAA,uBAGd,MAAAQ,EAAA,SAAAV,EAAA,QAAA,oICbRJ,EAAA,yBAEC,MAAA,CAAA,QAAA,CACD,oDATO,MAAA,6BAAmC,MAAA,aAD1C,QAAAM,EAAA,IAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,0EC8BAP,EAAA,4BAEC,MAAA,CAAA,QAAA,EACA,WAAA,CAAA,KAAAe,CAAA,aAEC,SAAA,OACC,MAAA,iDAEC,OAAA,6CAGA,KAAA,GAEF,GAED,SAAA,CACC,SAAA,CACC,OAAA,KAAA,WAAA,QAAA,IACD,GAED,QAAA,aAEE,MAAA,mBAAAC,EAAA,UAAA,IAED,eAAAA,EAAA,+DAEEA,EAAA,WAGF,YAAAC,EAAA,CACC,MAAA,aAAA,KAAA,OAAA,IAAA,qBAAAA,CAAA,IAED,SAAAC,EAAA,CACC,MAAA,SAAAA,CAAA,IAED,SAAAA,EAAA,CACC,OAAAA,IAAA,OAAA,MAAA,OACD,CACD,CACD,EAnEOb,EAAA,CAAA,MAAA,UAAA,+EADA,MAAA,6BAAmC,MAAA,qBAe7B,QAAAC,EAAA,IAAA,MAET,MAAA,iGAlBJ,QAAAA,EAAA,IAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAAC,EAAA,kBAAA,sBAAA,QAAAF,EAAA,IAAA,CAEEG,EAAA,MAAAJ,EAAA,0DAGE,MAAA,oDAEC,GAAAS,EAAA,YAAAE,EAAA,IAAA,IAPL,QAAAV,EAAA,IAAA,4DAUsB,QAAAA,EAAA,IAAA,MACR,MAAAQ,EAAA,SAAAE,EAAA,IAAA,EAA4B,MAAAF,EAAA,SAAAE,EAAA,IAAA"}