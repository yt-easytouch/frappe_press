import{_ as k}from"./Card-BCzTSeNK.js";import{x as I,q as p,o as s,A as a,w as i,X as w,Y as m,a6 as D,u,j as y,h as r,aA as S,a8 as E,a9 as V}from"./main-Dpl-JOF2.js";import{_ as T}from"./ListItem-CkkFcC1t.js";import{_ as O}from"./Alert-COV4XS8q.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="ed5caa31-7441-41ee-936f-78dbbebcce16",t._sentryDebugIdIdentifier="sentry-dbid-ed5caa31-7441-41ee-936f-78dbbebcce16")}catch(_){}})();{var c=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};c._sentryModuleMetadata=c._sentryModuleMetadata||{},c._sentryModuleMetadata[new Error().stack]=Object.assign({},c._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const q={name:"SiteAutoUpdate",props:["site"],data(){return{autoUpdateEnabled:null,lastTriggeredAt:null,updateFrequency:"",weekDay:"",monthDay:"",endOfMonth:!1,updateTime:"",showEditDialog:!1}},resources:{getSiteAutoUpdateInfo(){var t;return{url:"press.api.site.get_auto_update_info",params:{name:(t=this.site)==null?void 0:t.name},auto:!0,onSuccess(e){this.autoUpdateEnabled=e.auto_updates_scheduled,this.updateFrequency=e.update_trigger_frequency,this.weekDay=e.update_on_weekday,this.endOfMonth=e.update_end_of_month,this.monthDay=e.update_on_day_of_month,this.lastTriggeredAt=e.auto_update_last_triggered_on,this.updateTime=this.getFormattedTime(e.update_trigger_time)}}},enableAutoUpdate(){var t;return{url:"press.api.site.enable_auto_update",params:{name:(t=this.site)==null?void 0:t.name},onSuccess(){this.$resources.getSiteAutoUpdateInfo.fetch()}}},disableAutoUpdate(){var t;return{url:"press.api.site.disable_auto_update",params:{name:(t=this.site)==null?void 0:t.name},onSuccess(){this.showEditDialog=!1,this.$resources.getSiteAutoUpdateInfo.fetch()}}},updateAutoUpdateInfo(){var t;return{url:"press.api.site.update_auto_update_info",params:{name:(t=this.site)==null?void 0:t.name,info:{auto_updates_scheduled:this.autoUpdateEnabled,update_trigger_frequency:this.updateFrequency,update_on_weekday:this.weekDay,update_end_of_month:this.endOfMonth,update_on_day_of_month:this.monthDay,auto_update_last_triggered_on:this.lastTriggeredAt,update_trigger_time:this.updateTime}},onSuccess(){this.showEditDialog=!1,this.$resources.getSiteAutoUpdateInfo.fetch()}}}},methods:{enableAutoUpdate(){this.$resources.enableAutoUpdate.submit()},disableAutoUpdate(){this.$resources.disableAutoUpdate.submit()},getFormattedTime(t){if(!t)return;let e=t.split(":").slice(0,2);return e[0].padStart(2,"0")+":"+e[1]}},computed:{siteAutoUpdateInfo(){if(!this.$resources.getSiteAutoUpdateInfo.loading&&this.$resources.getSiteAutoUpdateInfo.data)return this.$resources.getSiteAutoUpdateInfo.data},frequencyOptions(){return["Daily","Weekly","Monthly"]},weekDayOptions(){return["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},monthDayOptions(){let t=[];for(let e=1;e<31;++e)t.push(e.toString());return t},timeOptions(){let t=[];for(let e=0;e<24;e++){const _=String(e).padStart(2,"0");t.push(`${_}:00`),t.push(`${_}:30`)}return t}}},v={key:0},M={key:1,class:"md:grid md:grid-cols-2"},C={key:0,class:"divide-y-2"},F={key:1},N={key:1,class:"py-10 text-center"},B={key:2,class:"py-10 text-center"},x={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"};function L(t,e,_,W,o,n){const g=w,U=O,l=T,f=E,h=V,b=S,A=k;return s(),p("div",null,[!t.$resources.getSiteAutoUpdateInfo.loading&&!o.autoUpdateEnabled?(s(),p("div",v,[a(U,{title:"Auto updates are disabled for this site."},{actions:i(()=>[a(g,{variant:"solid",onClick:n.enableAutoUpdate,loading:t.$resources.enableAutoUpdate.loading,loadingText:"Enabling"},{default:i(()=>e[7]||(e[7]=[m("Enable")])),_:1},8,["onClick","loading"])]),_:1})])):(s(),p("div",M,[a(A,{title:"Auto Update"},D({default:i(()=>[!t.$resources.getSiteAutoUpdateInfo.loading&&o.autoUpdateEnabled?(s(),p("div",C,[a(l,{title:"Update cycle",description:n.siteAutoUpdateInfo.update_trigger_frequency||"Not Set"},null,8,["description"]),n.siteAutoUpdateInfo.update_trigger_frequency==="Weekly"?(s(),r(l,{key:0,title:"On day of the week",description:n.siteAutoUpdateInfo.update_on_weekday},null,8,["description"])):u("",!0),a(l,{title:"Update time",description:n.getFormattedTime(n.siteAutoUpdateInfo.update_trigger_time)||"Not Set"},null,8,["description"]),n.siteAutoUpdateInfo.update_trigger_frequency==="Monthly"?(s(),p("div",F,[n.siteAutoUpdateInfo.update_end_of_month?(s(),r(l,{key:1,title:"On day of the month",description:"End of the month"})):(s(),r(l,{key:0,title:"On day of the month",description:n.siteAutoUpdateInfo.update_on_day_of_month.toString()},null,8,["description"]))])):u("",!0),n.siteAutoUpdateInfo.auto_update_last_triggered_on?(s(),r(l,{key:2,title:"Last updated on",description:n.siteAutoUpdateInfo.auto_update_last_triggered_on},null,8,["description"])):(s(),r(l,{key:3,title:"Last updated on",description:"Never triggered"}))])):u("",!0),!t.$resources.getSiteAutoUpdateInfo.loading&&!o.autoUpdateEnabled?(s(),p("div",N,[e[11]||(e[11]=y("h3",{class:"text-sm text-gray-800"}," Auto updates are disabled for this site. ",-1)),a(g,{class:"mt-3",variant:"solid",onClick:n.enableAutoUpdate,loading:this.$resources.enableAutoUpdate.loading,loadingText:"Enabling"},{default:i(()=>e[10]||(e[10]=[m("Enable Auto Updates")])),_:1},8,["onClick","loading"])])):u("",!0),t.$resources.getSiteAutoUpdateInfo.loading?(s(),p("div",B,[a(g,{loading:!0},{default:i(()=>e[12]||(e[12]=[m("Loading")])),_:1})])):u("",!0),a(b,{options:{title:"Schedule Auto Updates",actions:[{label:"Save Changes",variant:"solid",loading:t.$resources.updateAutoUpdateInfo.loading,onClick:()=>t.$resources.updateAutoUpdateInfo.submit()}]},modelValue:o.showEditDialog,"onUpdate:modelValue":e[6]||(e[6]=d=>o.showEditDialog=d)},{"body-content":i(()=>[y("div",x,[a(f,{type:"select",label:"Update Frequency",options:n.frequencyOptions,modelValue:o.updateFrequency,"onUpdate:modelValue":e[1]||(e[1]=d=>o.updateFrequency=d)},null,8,["options","modelValue"]),a(f,{type:"select",options:n.timeOptions,label:"Update time",modelValue:o.updateTime,"onUpdate:modelValue":e[2]||(e[2]=d=>o.updateTime=d)},null,8,["options","modelValue"]),o.updateFrequency==="Weekly"?(s(),r(f,{key:0,type:"select",label:"Day of the week",options:n.weekDayOptions,modelValue:o.weekDay,"onUpdate:modelValue":e[3]||(e[3]=d=>o.weekDay=d)},null,8,["options","modelValue"])):u("",!0),o.updateFrequency==="Monthly"?(s(),r(f,{key:1,type:"select",options:n.monthDayOptions,label:"Day of the month",modelValue:o.monthDay,"onUpdate:modelValue":e[4]||(e[4]=d=>o.monthDay=d),modelModifiers:{number:!0}},null,8,["options","modelValue"])):u("",!0),o.updateFrequency==="Monthly"?(s(),r(f,{key:2,type:"checkbox",label:"Update end of month",checked:o.endOfMonth,modelValue:o.endOfMonth,"onUpdate:modelValue":e[5]||(e[5]=d=>o.endOfMonth=d)},null,8,["checked","modelValue"])):u("",!0)]),a(h,{class:"mt-4",message:t.$resources.disableAutoUpdate.error},null,8,["message"]),a(h,{class:"mt-4",message:t.$resources.updateAutoUpdateInfo.error},null,8,["message"])]),_:1},8,["options","modelValue"]),e[13]||(e[13]=y("h4",{class:"mt-2 text-base text-gray-600"},[y("strong",null,"Note:"),m(" All times are in IST (UTC + 5:30 hours). ")],-1)),a(h,{class:"mt-4",message:t.$resources.enableAutoUpdate.error},null,8,["message"])]),_:2},[!t.$resources.getSiteAutoUpdateInfo.loading&&o.autoUpdateEnabled?{name:"actions",fn:i(()=>[a(g,{onClick:n.disableAutoUpdate,loading:t.$resources.disableAutoUpdate.loading,loadingText:"Disabling"},{default:i(()=>e[8]||(e[8]=[m("Disable Auto Updates")])),_:1},8,["onClick","loading"]),a(g,{"icon-left":"edit",onClick:e[0]||(e[0]=d=>o.showEditDialog=!0)},{default:i(()=>e[9]||(e[9]=[m("Edit")])),_:1})]),key:"0"}:void 0]),1024)]))])}const X=I(q,[["render",L]]);export{X as default};
//# sourceMappingURL=SiteAutoUpdate-DJm-m7XT.js.map
