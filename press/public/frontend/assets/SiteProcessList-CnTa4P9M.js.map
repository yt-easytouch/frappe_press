{"version":3,"file":"SiteProcessList-CnTa4P9M.js","sources":["../../../../dashboard/src2/components/site/performance/SiteDatabaseProcess.vue","../../../../dashboard/src2/components/site/performance/SiteProcessList.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\t:options=\"{\n\t\t\ttitle: 'Database Process',\n\t\t\tsize: 'xl',\n\t\t}\"\n\t\tv-model=\"show\"\n\t\t:modelValue=\"true\"\n\t>\n\t\t<template #body-content>\n\t\t\t<div class=\"flex flex-col gap-1\">\n\t\t\t\t<p class=\"ml-1 font-mono text-sm\">Host: {{ host }}</p>\n\t\t\t\t<p class=\"ml-1 font-mono text-sm\">User: {{ user }}</p>\n\t\t\t\t<p class=\"ml-1 font-mono text-sm\" v-if=\"state\">State: {{ state }}</p>\n\t\t\t\t<p class=\"ml-1 font-mono text-sm\" v-if=\"command\">\n\t\t\t\t\tCommand: {{ command }}\n\t\t\t\t</p>\n\n\t\t\t\t<div v-if=\"query\">\n\t\t\t\t\t<p class=\"ml-1 font-mono text-sm\">Query:</p>\n\t\t\t\t\t<pre\n\t\t\t\t\t\tclass=\"mt-1 whitespace-pre-wrap rounded-lg border-2 border-gray-200 bg-gray-100 p-3 text-sm text-gray-700\"\n\t\t\t\t\t\t>{{ query }}</pre\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<ErrorMessage\n\t\t\t\t\tclass=\"mt-2\"\n\t\t\t\t\t:message=\"$resources.killDatabaseProcess.error\"\n\t\t\t\t/>\n\t\t\t\t<div class=\"mt-2 flex text-sm\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tvariant=\"solid\"\n\t\t\t\t\t\ttheme=\"red\"\n\t\t\t\t\t\tclass=\"w-full\"\n\t\t\t\t\t\t@click=\"$resources.killDatabaseProcess.submit()\"\n\t\t\t\t\t\t:loading=\"$resources.killDatabaseProcess.loading\"\n\t\t\t\t\t\tloadingText=\"Killing Database Process\"\n\t\t\t\t\t>\n\t\t\t\t\t\tKill Database Process\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n\n<script>\nexport default {\n\tname: 'SiteDatabaseProcess',\n\tprops: ['id', 'query', 'user', 'host', 'state', 'command', 'site'],\n\temits: ['process-killed'],\n\tdata() {\n\t\treturn {\n\t\t\tshow: true,\n\t\t};\n\t},\n\tresources: {\n\t\tkillDatabaseProcess() {\n\t\t\treturn {\n\t\t\t\turl: 'press.api.client.run_doc_method',\n\t\t\t\tmakeParams() {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdt: 'Site',\n\t\t\t\t\t\tdn: this.site,\n\t\t\t\t\t\tmethod: 'kill_database_process',\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\tid: this.id,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tonSuccess: () => {\n\t\t\t\t\tthis.$emit('process-killed');\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n};\n</script>\n","<template>\n\t<div>\n\t\t<PerformanceReport\n\t\t\ttitle=\"Process List\"\n\t\t\t:site=\"name\"\n\t\t\t:reportOptions=\"processListOptions\"\n\t\t/>\n\t\t<SiteDatabaseProcess\n\t\t\tv-if=\"show\"\n\t\t\tv-model=\"show\"\n\t\t\t:id=\"selectedRow?.id ?? ''\"\n\t\t\t:query=\"selectedRow?.query ?? ''\"\n\t\t\t:host=\"selectedRow?.db_user_host ?? ''\"\n\t\t\t:user=\"selectedRow?.db_user ?? ''\"\n\t\t\t:state=\"selectedRow?.state ?? ''\"\n\t\t\t:command=\"selectedRow?.command ?? ''\"\n\t\t\t:site=\"name\"\n\t\t\t@process-killed=\"processKilledCallback\"\n\t\t/>\n\t</div>\n</template>\n<script>\nimport { toast } from 'vue-sonner';\nimport PerformanceReport from './PerformanceReport.vue';\nimport SiteDatabaseProcess from './SiteDatabaseProcess.vue';\n\nexport default {\n\tname: 'SiteMariaDBProcessList',\n\tprops: ['name'],\n\tcomponents: {\n\t\tPerformanceReport,\n\t\tSiteDatabaseProcess,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshow: false,\n\t\t\tselectedRow: null,\n\t\t};\n\t},\n\tresources: {\n\t\tprocessList() {\n\t\t\tif (!this.name) return;\n\t\t\treturn {\n\t\t\t\turl: 'press.api.analytics.mariadb_processlist',\n\t\t\t\tparams: {\n\t\t\t\t\tsite: this.name,\n\t\t\t\t},\n\t\t\t\tauto: true,\n\t\t\t\tinitialData: [],\n\t\t\t};\n\t\t},\n\t},\n\tcomputed: {\n\t\tprocessListOptions() {\n\t\t\treturn {\n\t\t\t\tdata: () => this.$resources.processList.data,\n\t\t\t\tcolumns: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'ID',\n\t\t\t\t\t\tfieldname: 'id',\n\t\t\t\t\t\twidth: '4rem',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Time',\n\t\t\t\t\t\tfieldname: 'time',\n\t\t\t\t\t\twidth: '6rem',\n\t\t\t\t\t\talign: 'right',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Command',\n\t\t\t\t\t\tfieldname: 'command',\n\t\t\t\t\t\twidth: '6rem',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'State',\n\t\t\t\t\t\tfieldname: 'state',\n\t\t\t\t\t\twidth: '8rem',\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: 'Query',\n\t\t\t\t\t\tfieldname: 'query',\n\t\t\t\t\t\tclass: 'font-mono',\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tonRowClick: (row) => {\n\t\t\t\t\tthis.selectedRow = row;\n\t\t\t\t\tthis.show = true;\n\t\t\t\t},\n\t\t\t\tsecondaryAction: () => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tlabel: 'Refresh',\n\t\t\t\t\t\ticon: 'refresh-ccw',\n\t\t\t\t\t\tloading: this.$resources.processList.loading,\n\t\t\t\t\t\tonClick: () => this.$resources.processList.reload(),\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tprocessKilledCallback() {\n\t\t\ttoast.success('Database Process Killed');\n\t\t\tthis.show = false;\n\t\t\tthis.$resources.processList.reload();\n\t\t},\n\t},\n};\n</script>\n"],"names":["_sfc_main","_hoisted_1","_hoisted_2","_hoisted_3","_hoisted_7","_hoisted_8","$data","_cache","$event","_withCtx","_createElementVNode","_toDisplayString","$props","_openBlock","_createElementBlock","_hoisted_4","_createCommentVNode","_hoisted_5","_hoisted_6","_ctx","_createTextVNode","PerformanceReport","SiteDatabaseProcess","row","toast","$options"],"mappings":"80BA+CA,MAAAA,EAAA,iHAIC,MAAA,CACC,MAAA,CACC,KAAA,gBAID,qBAAA,CACC,MAAA,CACC,IAAA,+CAEC,MAAA,CACC,GAAA,oBAEA,OAAA,4CAMF,UAAA,IAAA,iCAMJ,EAlEQC,EAAA,CAAA,MAAA,qBAAA,EACDC,EAAA,CAAA,MAAA,wBAAA,EACAC,EAAA,CAAA,MAAA,wBAAA,WACA,MAAA,mCACA,MAAA,oCAODC,EAAA,CAAA,MAAA,oGAAA,EAQGC,EAAA,CAAA,MAAA,mBAAA,4DA3BN,QAAA,mCAGA,EALH,WAAAC,EAAA,KAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,KAAAE,KASa,eAAAC,EAAA,IAAA,CACVC,EAAA,MAAAT,EAAA,CACCS,EAAA,IAAAR,EAAA,SAAAS,EAAAC,EAAA,IAAA,EAAA,CAAA,EACAF,EAAA,IAAAP,EAAA,SAAAQ,EAAAC,EAAA,IAAA,EAAA,CAAA,WACAC,EAAA,EAAAC,EAAA,IAAAC,EAAA,UAAAJ,EAAAC,EAAA,KAAA,EAAA,CAAA,GAbJI,EAAA,GAAA,EAAA,aAcIH,EAAA,EAAAC,EAAA,IAAAG,EAAA,aAAAN,EAAAC,EAAA,OAAA,EAAA,CAAA,GAdJI,EAAA,GAAA,EAAA,WAkBIH,IAAAC,EAAA,MAAAI,EAAA,CACCX,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAG,EAAA,IAAA,CAAA,MAAA,wBAAA,EAAA,SAAA,EAAA,8BAnBLM,EAAA,GAAA,EAAA,OA0BK,MAAA,OACC,QAAAG,EAAA,WAAA,oBAAA,2BAEFT,EAAA,MAAAL,EAAA,MAEE,QAAA,QACA,MAAA,MACA,MAAA,SACC,QAAAE,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAW,EAAA,WAAA,oBAAA,OAAA,GACA,QAAAA,EAAA,WAAA,oBAAA,QACD,YAAA,6BApCN,QAAAV,EAAA,IAAAF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CAAAa,EAAA,yBAAA,kFC0BApB,EAAA,+BAEC,MAAA,CAAA,MAAA,cAEC,kBAAAqB,EACA,oBAAAC,GAED,MAAA,CACC,MAAA,SAEC,YAAA,gCAKA,GAAA,KAAA,KACA,MAAA,CACC,IAAA,0CACA,OAAA,CACC,KAAA,KAAA,MAED,KAAA,GACA,YAAA,CAAA,KAIH,SAAA,CACC,oBAAA,CACC,MAAA,CACC,KAAA,IAAA,KAAA,WAAA,YAAA,KACA,QAAA,CACC,YAEC,UAAA,mBAGD,cAEC,UAAA,mCAID,CACC,MAAA,UACA,UAAA,wBAGD,eAEC,UAAA,sBAGD,eAEC,UAAA,QACA,MAAA,cAGF,WAAAC,GAAA,CACC,KAAA,YAAAA,EACA,KAAA,KAAA,IAED,gBAAA,KACC,CACC,MAAA,UACA,KAAA,cACA,QAAA,KAAA,WAAA,YAAA,8DAOL,QAAA,yBAEEC,EAAA,QAAA,yBAAA,EACA,KAAA,KAAA,GACA,KAAA,WAAA,YAAA,OAAA,GAGH,8IAvGG,MAAA,eACC,KAAAZ,EAAA,KACA,cAAAa,EAAA,4EALJ,WAAAnB,EAAA,KAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,KAAAE,gXAgBI,KAAAI,EAAA,KACA,gBAAAa,EAAA,qHAjBJT,EAAA,GAAA,EAAA"}