{"version":3,"file":"SiteScheduleBackup-DFl89G3e.js","sources":["../../../../dashboard/src2/components/site/SiteScheduleBackup.vue"],"sourcesContent":["<template>\n\t<Dialog\n\t\t:options=\"{\n\t\t\ttitle: 'Schedule Backup',\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\tlabel: 'Schedule Backup',\n\t\t\t\t\tloading: this.site?.backup?.loading,\n\t\t\t\t\tvariant: 'solid',\n\t\t\t\t\tonClick: scheduleBackup,\n\t\t\t\t},\n\t\t\t],\n\t\t}\"\n\t\tv-model=\"show\"\n\t\t@close=\"resetValues\"\n\t>\n\t\t<template #body-content>\n\t\t\t<div class=\"flex flex-col gap-3\">\n\t\t\t\t<p\n\t\t\t\t\tclass=\"text-md text-base text-gray-800\"\n\t\t\t\t\tv-if=\"!this.$site?.doc?.allow_physical_backup_by_user\"\n\t\t\t\t>\n\t\t\t\t\tAre you sure you want to backup your site ?\n\t\t\t\t</p>\n\t\t\t\t<AlertBanner\n\t\t\t\t\tv-if=\"this.$site?.doc?.allow_physical_backup_by_user\"\n\t\t\t\t\ttitle=\"Backup can cause some downtime on your site. It depends on the size of your database.\"\n\t\t\t\t\ttype=\"info\"\n\t\t\t\t\t:showIcon=\"false\"\n\t\t\t\t>\n\t\t\t\t</AlertBanner>\n\t\t\t\t<div v-if=\"this.$site?.doc?.allow_physical_backup_by_user\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tlabel=\"Physical Backup\"\n\t\t\t\t\t\tv-model=\"isPhysical\"\n\t\t\t\t\t>\n\t\t\t\t\t</FormControl>\n\t\t\t\t</div>\n\n\t\t\t\t<div v-if=\"this.$site?.doc?.allow_physical_backup_by_user\">\n\t\t\t\t\t<FormControl\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tlabel=\"Backup Public & Private Files\"\n\t\t\t\t\t\tv-model=\"includeFiles\"\n\t\t\t\t\t\t:disabled=\"isPhysical\"\n\t\t\t\t\t>\n\t\t\t\t\t</FormControl>\n\n\t\t\t\t\t<AlertBanner\n\t\t\t\t\t\tv-if=\"isPhysical\"\n\t\t\t\t\t\tclass=\"mt-2\"\n\t\t\t\t\t\ttitle=\"Physical Backup can't backup your site's private and public files currently.\"\n\t\t\t\t\t\ttype=\"warning\"\n\t\t\t\t\t\t:showIcon=\"false\"\n\t\t\t\t\t>\n\t\t\t\t\t</AlertBanner>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t</Dialog>\n</template>\n\n<script>\nimport { getCachedDocumentResource } from 'frappe-ui';\nimport { toast } from 'vue-sonner';\nimport { getToastErrorMessage } from '../../utils/toast';\nimport AlertBanner from '../AlertBanner.vue';\n\nexport default {\n\tprops: ['site', 'onScheduleBackupSuccess'],\n\tcomponents: {\n\t\tAlertBanner,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tshow: true,\n\t\t\tisPhysical: false,\n\t\t\tincludeFiles: true,\n\t\t};\n\t},\n\twatch: {\n\t\tisPhysical(newValue) {\n\t\t\tif (newValue == true) {\n\t\t\t\tthis.includeFiles = false;\n\t\t\t}\n\t\t},\n\t},\n\tresources: {\n\t\tscheduleBackup() {\n\t\t\treturn {};\n\t\t},\n\t},\n\tcomputed: {\n\t\t$site() {\n\t\t\treturn getCachedDocumentResource('Site', this.site);\n\t\t},\n\t},\n\tmethods: {\n\t\tresetValues() {},\n\t\tscheduleBackup() {\n\t\t\tthis.$router.push({\n\t\t\t\tname: 'Site Detail Backups',\n\t\t\t\tparams: { name: this.$site.doc.name },\n\t\t\t});\n\t\t\tlet site_backup_promise = this.$site.backup.submit({\n\t\t\t\twith_files: this.includeFiles,\n\t\t\t\tphysical: this.isPhysical,\n\t\t\t});\n\t\t\ttoast.promise(site_backup_promise, {\n\t\t\t\tloading: 'Scheduling backup...',\n\t\t\t\tsuccess: () => {\n\t\t\t\t\tthis.show = false;\n\t\t\t\t\tif (this.onScheduleBackupSuccess) {\n\t\t\t\t\t\tthis.onScheduleBackupSuccess();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.$router.push({\n\t\t\t\t\t\t\tname: 'Site Detail Backups',\n\t\t\t\t\t\t\tparams: { name: this.$site.doc.name },\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn 'Backup scheduled successfully.';\n\t\t\t\t},\n\t\t\t\terror: (e) => getToastErrorMessage(e),\n\t\t\t});\n\t\t},\n\t},\n};\n</script>\n"],"names":["_sfc_main","newValue","toast","site_backup_promise","getToastErrorMessage","_hoisted_1","$data","_cache","$event","$options","_withCtx","_createElementVNode","_createCommentVNode","_openBlock","_createElementBlock","_hoisted_3","_hoisted_4"],"mappings":"6xBAuEA,MAAAA,EAAA,CACC,MAAA,CAAA,OAAA,yBAAA,6BAIA,MAAA,CACC,MAAA,CACC,KAAA,GACA,WAAA,GACA,aAAA,KAGF,MAAA,CACC,WAAAC,EAAA,CACCA,GAAA,wCAMD,gBAAA,CACC,MAAA,CAAA,IAGF,SAAA,CACC,OAAA,8BAID,QAAA,CACC,aAAA,CAAA,EACA,gBAAA,CACC,KAAA,QAAA,KAAA,4BAEC,OAAA,CAAA,KAAA,KAAA,MAAA,IAAA,IAAA,CACD,CAAA,uFAIA,CAAA,EACAC,EAAA,QAAAC,EAAA,6CAGE,KAAA,KAAA,GACA,KAAA,wBACC,KAAA,wBAAA,EAEA,KAAA,QAAA,KAAA,4BAEC,OAAA,CAAA,KAAA,KAAA,MAAA,IAAA,IAAA,CACD,CAAA,EAED,kCAED,MAAA,GAAAC,EAAA,CAAA,CACD,CAAA,GAGH,EAhHQC,EAAA,CAAA,MAAA,qBAAA,WAEH,MAAA,8TAnBL,WAAAC,EAAA,KAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,KAAAE,GAcG,QAAAC,EAAA,cAEU,eAAAC,EAAA,IAAA,qBAAA,OACVC,EAAA,MAAAN,EAAA,8EAjBHO,EAAA,GAAA,EAAA,8JA0BK,MAAA,wFACA,KAAA,OACC,SAAA,MA5BNA,EAAA,GAAA,EAAA,gFA+BIC,IAAAC,EAAA,MAAAC,EAAA,MAEE,QAAA,UACA,KAAA,WACA,MAAA,kBAnCN,WAAAT,EAAA,WAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,WAAAE,8BAAAI,EAAA,GAAA,EAAA,gFAyCIC,IAAAC,EAAA,MAAAE,EAAA,MAEE,QAAA,UACA,KAAA,WACA,MAAA,gCA7CN,WAAAV,EAAA,aAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,aAAAE,GA+CO,SAAAF,EAAA,2EAMD,MAAA,OACA,MAAA,+EACA,KAAA,UACC,SAAA,MAxDPM,EAAA,GAAA,EAAA,KAAAA,EAAA,GAAA,EAAA"}