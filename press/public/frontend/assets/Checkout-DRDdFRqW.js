var k=(t,e,r)=>new Promise((a,s)=>{var p=l=>{try{i(r.next(l))}catch(n){s(n)}},u=l=>{try{i(r.throw(l))}catch(n){s(n)}},i=l=>l.done?a(l.value):Promise.resolve(l.value).then(p,u);i((r=r.apply(t,e)).next())});import{x as h,q as y,o as d,F as S,v as N,j as o,t as b,A as c,Y as f,w as C,n as $,X as V,a9 as A,ag as B,a8 as K,h as g,ah as U,u as _,ai as x,aj as E,ak as D,r as w}from"./main-Dpl-JOF2.js";import{_ as I}from"./FeatureList-DXsHFT_A.js";import{i as j,A as F}from"./AddressForm-Cz0XUJgF.js";import{S as M}from"./StripeLogo-BRF2qIyd.js";import{l as L}from"./stripe.esm-D4yu_pm0.js";import"./Form-CIPLpg2e.js";(function(){try{var t=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},e=new Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="11442780-9081-4491-97e0-f698bd385a2d",t._sentryDebugIdIdentifier="sentry-dbid-11442780-9081-4491-97e0-f698bd385a2d")}catch(r){}})();{var v=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};v._sentryModuleMetadata=v._sentryModuleMetadata||{},v._sentryModuleMetadata[new Error().stack]=Object.assign({},v._sentryModuleMetadata[new Error().stack],{"_sentryBundlerPluginAppKey:press-dashboard":!0})}const q={name:"Apps",emits:["update:selectedSubscription","update:step"],props:{data:{default:[]},step:{default:1},selectedSubscription:{default:""}},methods:{selectSubscription(t){this.$emit("update:selectedSubscription",t),this.$emit("update:step",2)}}},R={class:"flex flex-row flex-wrap w-full h-fit"},H=["onClick"],T=["src"],O={class:"text-sm mt-3 font-semibold"};function Y(t,e,r,a,s,p){return d(),y("div",R,[(d(!0),y(S,null,N(r.data.subscriptions,u=>(d(),y("div",{class:"flex flex-col items-center m-2 p-4 w-2/7 rounded cursor-pointer transition-all",onClick:i=>p.selectSubscription(u)},[o("img",{src:u.image,alt:"Logo",class:"rounded h-[68px] hover:scale-105 transition-all"},null,8,T),o("span",O,b(u.title),1)],8,H))),256))])}const z=h(q,[["render",Y]]),G={name:"Apps",components:{FeatureList:I},emits:["update:selectedPlan","update:step"],props:["selectedPlan","currency","step","secretKey","subscription","team"],resources:{changeSitePlan(){return{url:"press.api.developer.marketplace.change_site_plan"}}},methods:{selectPlan(t){this.$emit("update:selectedPlan",t),this.capturePosthogEvent(),Object.keys(this.subscription.address).length>0?this.subscription.has_billing_info?(this.$resources.changeSitePlan.submit({secret_key:this.secretKey,plan:t.name}),this.$emit("update:step",4)):this.$emit("update:step",3):this.$emit("update:step",2)},getPlanFeatures(t){let e=[`${t.cpu_time_per_day} `+this.$plural(t.cpu_time_per_day,"hour","hours")+" CPU per day",this.formatBytes(t.max_database_usage,0,2)+" Database",this.formatBytes(t.max_storage_usage,0,2)+" Storge"];return t.support_included&&e.push("Product warranty + Support"),e},capturePosthogEvent(){window.posthog&&window.posthog.capture("fc_subscribe_plan_selected",{distinct_id:this.team})}}},X={class:"grid grid-cols-2 gap-2 sm:grid-cols-3"},J={class:"m-2 flex flex-col justify-between rounded-2xl border border-gray-100 p-4 shadow"},Q={class:"flex justify-between text-xl font-semibold text-gray-900"},W={class:"text-base font-normal text-gray-600"};function Z(t,e,r,a,s,p){const u=I,i=V;return d(),y("div",X,[(d(!0),y(S,null,N(r.subscription.plans,l=>(d(),y("div",J,[o("div",null,[o("h4",Q,[o("div",null,[o("span",null,[f(b(r.subscription.currency==="INR"?"₹"+l.price_inr:"$"+l.price_usd)+" ",1),o("span",W,b(l.block_monthly===1?"/year":"/mo"),1)])])]),c(u,{class:"my-5",features:p.getPlanFeatures(l)},null,8,["features"])]),c(i,{variant:"subtle",disabled:r.subscription.current_plan===l.name,class:$({"hover:bg-gray-900 hover:text-white":r.subscription.current_plan!=l.name}),onClick:n=>p.selectPlan(l),loading:t.$resources.changeSitePlan.loading},{default:C(()=>[f(b(r.subscription.current_plan===l.name?"Current Plan":"Buy Now"),1)]),_:2},1032,["disabled","class","onClick","loading"])]))),256))])}const ee=h(G,[["render",Z]]),se={name:"CheckoutAddress",props:["currency","countries","secretKey","step"],data(){return{billingName:"",address:"",country:"",state:"",city:"",postalCode:null,gstin:"Not Applicable",gstApplicable:!1,indianStates:j}},resources:{updateBillingDetails(){return{url:"press.api.developer.marketplace.update_billing_info",params:{secret_key:this.secretKey,data:{billing_name:this.billingName,address:this.address,country:this.country,city:this.city,state:this.state,postal_code:this.postalCode,gstin:this.gstin}},onSuccess(t){this.$emit("update:newAddress",{address_line1:this.address,country:this.country,city:this.city,state:this.state,pincode:this.postalCode}),this.$emit("update:step",3)}}}}},te={class:"flex flex-col justify-between px-6"},re={class:"flex flex-col justify-between sm:flex-row"};function ne(t,e,r,a,s,p){const u=A,i=K,l=V;return d(),y(S,null,[o("div",{class:"mb-4 w-fit cursor-pointer text-sm",onClick:e[0]||(e[0]=n=>t.$emit("update:step",1))}," ← Back to Plans "),c(u,{class:"my-3 ml-6",message:t.$resources.updateBillingDetails.error},null,8,["message"]),o("div",te,[o("div",null,[c(i,{class:"mb-2",label:"Billing Name",modelValue:s.billingName,"onUpdate:modelValue":e[1]||(e[1]=n=>s.billingName=n),required:""},null,8,["modelValue"]),c(i,{class:"mb-2",label:"Address",modelValue:s.address,"onUpdate:modelValue":e[2]||(e[2]=n=>s.address=n)},null,8,["modelValue"]),c(i,{class:"mb-2",label:"Country",type:"select",modelValue:s.country,"onUpdate:modelValue":e[3]||(e[3]=n=>s.country=n),options:r.countries,required:""},null,8,["modelValue","options"]),o("div",re,[s.country==="India"?(d(),g(i,{key:0,class:"mb-2 w-1/3",label:"State/Province/Region",type:"select",modelValue:s.state,"onUpdate:modelValue":e[4]||(e[4]=n=>s.state=n),options:s.indianStates,required:""},null,8,["modelValue","options"])):(d(),g(i,{key:1,class:"mb-2",label:"State/Province/Region",modelValue:s.state,"onUpdate:modelValue":e[5]||(e[5]=n=>s.state=n),required:""},null,8,["modelValue"])),c(i,{class:"mb-2",label:"City",type:"text",modelValue:s.city,"onUpdate:modelValue":e[6]||(e[6]=n=>s.city=n)},null,8,["modelValue"]),c(i,{class:"mb-2",label:"Postal Code",modelValue:s.postalCode,"onUpdate:modelValue":e[7]||(e[7]=n=>s.postalCode=n),required:""},null,8,["modelValue"])]),B(o("div",null,[e[14]||(e[14]=o("span",{class:"mb-2 block text-sm leading-4 text-gray-700"}," GSTIN(only for Indian customers) ",-1)),s.gstApplicable?(d(),g(i,{key:0,modelValue:s.gstin,"onUpdate:modelValue":e[8]||(e[8]=n=>s.gstin=n),disabled:!s.gstApplicable},null,8,["modelValue","disabled"])):_("",!0),s.gstApplicable?(d(),g(l,{key:1,class:"mt-2",onClick:e[9]||(e[9]=n=>{s.gstApplicable=!1,s.gstin="Not Applicable"})},{default:C(()=>e[12]||(e[12]=[f(" I don't have a GSTIN ")])),_:1})):(d(),g(l,{key:2,class:"mt-2",onClick:e[10]||(e[10]=n=>{s.gstApplicable=!0,s.gstin=""})},{default:C(()=>e[13]||(e[13]=[f(" Add a GSTIN ")])),_:1}))],512),[[U,r.currency==="INR"]])]),c(l,{variant:"solid",class:"mt-8 self-end",loading:t.$resources.updateBillingDetails.loading,onClick:e[11]||(e[11]=n=>t.$resources.updateBillingDetails.submit())},{default:C(()=>e[15]||(e[15]=[f(" Update Billing Details ")])),_:1},8,["loading"])])],64)}const le=h(se,[["render",ne]]),oe={name:"StripeCard",props:["secretKey","address","currency","selectedPlan"],emits:["complete"],components:{AddressForm:F,StripeLogo:M},data(){return{errorMessage:null,cardErrorMessage:null,ready:!1,setupIntent:null,cardHolderName:"",gstNotApplicable:!1,addingCard:!1}},mounted(){return k(this,null,function*(){this.setupCard()})},resources:{countryList(){return{url:"press.api.account.country_list",auto:!0}}},methods:{setupCard(){return k(this,null,function*(){let t=yield x({url:"press.api.developer.marketplace.get_publishable_key_and_setup_intent",params:{secret_key:this.secretKey}}),{publishable_key:e,setup_intent:r}=t;this.setupIntent=r,this.stripe=yield L(e),this.elements=this.stripe.elements();let a=this.$theme,s={base:{color:a.colors.black,fontFamily:a.fontFamily.sans.join(", "),fontSmoothing:"antialiased",fontSize:"13px","::placeholder":{color:a.colors.gray[400]}},invalid:{color:a.colors.red[600],iconColor:a.colors.red[600]}};this.card=this.elements.create("card",{hidePostalCode:!0,style:s,classes:{complete:"",focus:"bg-gray-100"}}),this.card.mount(this.$refs["card-element"]),this.card.addEventListener("change",p=>{var u;this.cardErrorMessage=((u=p.error)==null?void 0:u.message)||null}),this.card.addEventListener("ready",()=>{this.ready=!0})})},submit(){return k(this,null,function*(){this.addingCard=!0;let t;if(this.address||(t=yield this.$refs["address-form"].validateValues()),t){this.errorMessage=t,this.addingCard=!1;return}else this.errorMessage=null;const{setupIntent:e,error:r}=yield this.stripe.confirmCardSetup(this.setupIntent.client_secret,{payment_method:{card:this.card,billing_details:{name:this.cardHolderName,address:{line1:this.address.address_line1,city:this.address.city,state:this.address.state,postal_code:this.address.postal_code,country:this.getCountryCode(this.address.country)}}}});if(r){this.addingCard=!1;let a=r.message;a!="Your card number is incomplete."&&(this.errorMessage=a)}else if(e.status==="succeeded")try{const{payment_method_name:a}=yield x({url:"press.api.developer.marketplace.setup_intent_success",params:{secret_key:this.secretKey,setup_intent:e}});this.addingCard=!1,yield x({url:"press.api.developer.marketplace.change_site_plan",params:{secret_key:this.secretKey,plan:this.selectedPlan.name}}),this.$emit("update:step",4)}catch(a){console.error(a),this.addingCard=!1,this.errorMessage=a.messages.join(`
`)}})},getCountryCode(t){return t="India",this.$resources.countryList.data.find(r=>r.name===t).code.toUpperCase()}}},ae={class:"relative"},ie={key:0,class:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-8 transform"},de={class:"block"},ue={class:"form-input mt-2 block h-[unset] w-full py-2 pl-3",ref:"card-element"},ce={class:"mt-6 flex items-center justify-between"};function pe(t,e,r,a,s,p){const u=E,i=A,l=K,n=M,P=V;return d(),y("div",ae,[s.ready?_("",!0):(d(),y("div",ie,[c(u,{class:"h-5 w-5 text-gray-600"})])),o("div",{class:$({"opacity-0":!s.ready})},[o("div",null,[o("label",de,[e[1]||(e[1]=o("span",{class:"block text-xs text-gray-600"}," Credit or Debit Card ",-1)),o("div",ue,null,512),c(i,{class:"mt-1",message:s.cardErrorMessage},null,8,["message"])]),c(l,{class:"mt-4",label:"Name on Card",type:"text",modelValue:s.cardHolderName,"onUpdate:modelValue":e[0]||(e[0]=m=>s.cardHolderName=m)},null,8,["modelValue"])]),c(i,{class:"mt-2",message:s.errorMessage},null,8,["message"]),o("div",ce,[c(n),c(P,{variant:"solid",onClick:p.submit,loading:s.addingCard},{default:C(()=>e[2]||(e[2]=[f(" Save Card ")])),_:1},8,["onClick","loading"])])],2)])}const me=h(oe,[["render",pe]]),ye={name:"PlanChangeSuccessful",props:["currentPlan","selectedPlan","step"],emits:["update:step"]},ge={class:"text-center text-center flex flex-col"},fe={class:"text-base"},_e={class:"font-semibold"},be={class:"font-semibold"};function he(t,e,r,a,s,p){const u=D;return d(),y("div",ge,[c(u,{class:"mx-auto h-10 w-10 mb-4"}),e[2]||(e[2]=o("span",{class:"text-2xl font-semibold mb-2"}," Plan Changed Successfully ",-1)),o("span",fe,[e[0]||(e[0]=f(" Your site plan has been changed from ")),o("span",_e,b(r.currentPlan),1),e[1]||(e[1]=f(" to ")),o("span",be,b(r.selectedPlan),1)])])}const Ce=h(ye,[["render",he]]),ke={name:"Checkout",components:{Apps:z,Plans:ee,Address:le,Payment:me,PlanChangeSuccessful:Ce},props:["secretKey"],data(){return{selectedSubscription:"",selectedPlan:"",step:1,newAddress:{},errorMessage:null}},resources:{subscription(){return{url:"press.api.developer.marketplace.get_subscription",params:{secret_key:this.secretKey},auto:!0,onSuccess(t){this.errorMessage=null},onError(t){this.errorMessage=t}}}}},ve={key:0,class:"p-0"};function we(t,e,r,a,s,p){const u=A,i=w("Plans"),l=w("Address"),n=w("Payment"),P=w("PlanChangeSuccessful");return t.$resources.subscription.data?(d(),y("div",ve,[c(u,{message:s.errorMessage},null,8,["message"]),s.step===1?(d(),g(i,{key:0,secretKey:r.secretKey,subscription:t.$resources.subscription.data,team:t.$resources.subscription.data.team,step:s.step,"onUpdate:step":e[0]||(e[0]=m=>s.step=m),selectedPlan:s.selectedPlan,"onUpdate:selectedPlan":e[1]||(e[1]=m=>s.selectedPlan=m)},null,8,["secretKey","subscription","team","step","selectedPlan"])):_("",!0),s.step===2?(d(),g(l,{key:1,secretKey:r.secretKey,currency:t.$resources.subscription.data.currency,countries:t.$resources.subscription.data.countries,step:s.step,"onUpdate:step":e[2]||(e[2]=m=>s.step=m),newAddress:s.newAddress,"onUpdate:newAddress":e[3]||(e[3]=m=>s.newAddress=m)},null,8,["secretKey","currency","countries","step","newAddress"])):_("",!0),s.step===3?(d(),g(n,{key:2,selectedPlan:s.selectedPlan,currency:t.$resources.subscription.data.currency,withoutAddress:!0,address:Object.keys(t.$resources.subscription.data.address).length>0?t.$resources.subscription.data.address:s.newAddress,secretKey:r.secretKey,step:s.step,"onUpdate:step":e[4]||(e[4]=m=>s.step=m)},null,8,["selectedPlan","currency","address","secretKey","step"])):_("",!0),s.step===4?(d(),g(P,{key:3,selectedPlan:s.selectedPlan.name,currentPlan:t.$resources.subscription.data.current_plan,step:s.step,"onUpdate:step":e[5]||(e[5]=m=>s.step=m)},null,8,["selectedPlan","currentPlan","step"])):_("",!0)])):_("",!0)}const Ke=h(ke,[["render",we]]);export{Ke as default};
//# sourceMappingURL=Checkout-DRDdFRqW.js.map
