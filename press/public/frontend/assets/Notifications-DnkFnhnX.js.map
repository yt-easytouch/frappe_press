{"version":3,"file":"Notifications-DnkFnhnX.js","sources":["../../../../dashboard/src/data/notifications.js","../../../../dashboard/src/views/notifications/Notifications.vue"],"sourcesContent":["import { createResource } from 'frappe-ui';\n\nexport const unreadNotificationsCount = createResource({\n\tcache: 'Unread Notifications Count',\n\turl: 'press.api.notifications.get_unread_count',\n\tinitialData: 0\n});\n","<template>\n\t<div>\n\t\t<header\n\t\t\tclass=\"sticky top-0 z-10 flex items-center justify-between border-b bg-white px-5 py-2.5\"\n\t\t>\n\t\t\t<Breadcrumbs\n\t\t\t\t:items=\"[{ label: 'Notifications', route: { name: 'Notifications' } }]\"\n\t\t\t>\n\t\t\t\t<template #actions>\n\t\t\t\t\t<TabButtons\n\t\t\t\t\t\t:buttons=\"[{ label: 'Unread', active: true }, { label: 'Read' }]\"\n\t\t\t\t\t\tv-model=\"activeTab\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</Breadcrumbs>\n\t\t</header>\n\n\t\t<div class=\"mx-20 mt-5\">\n\t\t\t<div class=\"flex flex-col divide-y\">\n\t\t\t\t<ListItem\n\t\t\t\t\tv-for=\"notification in notifications\"\n\t\t\t\t\t:title=\"notification.type\"\n\t\t\t\t\t:description=\"`${notification.message} â€¢ ${formatDate(\n\t\t\t\t\t\tnotification.creation,\n\t\t\t\t\t\t'relative'\n\t\t\t\t\t)}`\"\n\t\t\t\t>\n\t\t\t\t\t<template #actions>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tv-if=\"notification.route\"\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\tlabel=\"View\"\n\t\t\t\t\t\t\t@click=\"openNotification(notification)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</ListItem>\n\t\t\t\t<div v-if=\"!notifications?.length\" class=\"text-base text-gray-600\">\n\t\t\t\t\tNo Notifications\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { TabButtons } from 'frappe-ui';\nimport { unreadNotificationsCount } from '@/data/notifications';\n\nexport default {\n\tname: 'Notifications',\n\tpageMeta() {\n\t\treturn {\n\t\t\ttitle: 'Notifications'\n\t\t};\n\t},\n\tcomponents: {\n\t\tTabButtons\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tactiveTab: 'Unread'\n\t\t};\n\t},\n\tresources: {\n\t\tunreadNotifications() {\n\t\t\tif (this.activeTab !== 'Unread') return;\n\t\t\treturn {\n\t\t\t\turl: 'press.api.notifications.get_notifications',\n\t\t\t\tparams: {\n\t\t\t\t\tfilters: { team: this.$account.team.name, read: false }\n\t\t\t\t},\n\t\t\t\tcache: ['unreadNotifications', this.$account?.team],\n\t\t\t\tauto: true\n\t\t\t};\n\t\t},\n\t\treadNotifications() {\n\t\t\tif (this.activeTab !== 'Read') return;\n\t\t\treturn {\n\t\t\t\turl: 'press.api.notifications.get_notifications',\n\t\t\t\tparams: {\n\t\t\t\t\tfilters: {\n\t\t\t\t\t\tteam: this.$account.team.name,\n\t\t\t\t\t\tread: true\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcache: ['readNotifications', this.$account?.team],\n\t\t\t\tauto: true\n\t\t\t};\n\t\t},\n\t\tmarkNotificationAsRead: {\n\t\t\turl: 'press.api.notifications.mark_notification_as_read'\n\t\t}\n\t},\n\tmethods: {\n\t\topenNotification(notification) {\n\t\t\tif (!notification.read) {\n\t\t\t\tthis.$resources.markNotificationAsRead.submit({\n\t\t\t\t\tname: notification.name\n\t\t\t\t});\n\n\t\t\t\tunreadNotificationsCount.setData(data => data - 1);\n\t\t\t}\n\t\t\tthis.$router.push(notification.route);\n\t\t}\n\t},\n\tcomputed: {\n\t\tnotifications() {\n\t\t\treturn this.activeTab === 'Unread'\n\t\t\t\t? this.$resources.unreadNotifications.data\n\t\t\t\t: this.$resources.readNotifications.data;\n\t\t}\n\t}\n};\n</script>\n"],"names":["unreadNotificationsCount","createResource","_sfc_main","TabButtons","notification","_hoisted_1","_hoisted_2","_hoisted_3","_createElementVNode","_withCtx","$data","_cache","$event","_openBlock","_createElementBlock","_Fragment","_renderList","$options","_ctx","_createCommentVNode","_a"],"mappings":"q2BAEO,MAAMA,EAA2BC,EAAe,CACtD,MAAO,6BACP,IAAK,2CACL,YAAa,CACd,CAAC,EC0CDC,EAAA,CACC,KAAA,2BAEC,MAAA,CACC,MAAA,8BAIDC,WAAAA,GAED,MAAA,CACC,MAAA,CACC,UAAA,sBAID,qBAAA,OACC,GAAA,KAAA,YAAA,SACA,MAAA,iDAEC,OAAA,qHAIA,KAAA,KAGF,mBAAA,OACC,GAAA,KAAA,YAAA,OACA,MAAA,iDAEC,OAAA,CACC,QAAA,8BAEC,KAAA,EACD,qEAGD,KAAA,oFAKF,GAED,QAAA,CACC,iBAAAC,EAAA,yDAGG,KAAAA,EAAA,IACD,CAAA,qBAID,KAAA,QAAA,KAAAA,EAAA,KAAA,CACD,GAED,SAAA,CACC,eAAA,CACC,OAAA,KAAA,YAAA,SACC,KAAA,WAAA,oBAAA,KACA,KAAA,WAAA,kBAAA,IACF,CACD,CACD,EA7GGC,EAAA,CAAA,MAAA,mFAAA,EAcIC,EAAA,CAAA,MAAA,YAAA,EACCC,EAAA,CAAA,MAAA,wBAAA,WAkB+B,MAAA,wGAlCrCC,EAAA,SAAAH,EAAA,qEAMa,QAAAI,EAAA,IAAA,MAER,QAAA,CAAA,CAAA,MAAA,SAAA,OAAA,IAAA,CAAA,MAAA,OAAA,EAVP,WAAAC,EAAA,UAAA,sBAAAC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAC,GAAAF,EAAA,UAAAE,qCAiBEJ,EAAA,MAAAF,EAAA,CACCE,EAAA,MAAAD,EAAA,EACCM,EAAA,EAAA,EAAAC,EAAAC,EAAA,KAAAC,EAAAC,EAAA,cAAAb,0BAGE,YAAA,GAAAA,EAAA,OAAA,MAAAc,EAAA,WAA4Dd,EAAA,yBAKlD,QAAAK,EAAA,IAAA,CAEHL,EAAA,sBACN,QAAA,QACA,MAAA,8DA/BPe,EAAA,GAAA,EAAA,gDAoCgBC,EAAAH,EAAA,gBAAA,MAAAG,EAAA,OApChBD,EAAA,GAAA,EAAA"}